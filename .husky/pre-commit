#!/bin/sh

echo "ğŸ” Running pre-commit checks..."

# Initial lint check
echo "Running initial lint check..."
pnpm lint || (
  echo "âš ï¸ Initial lint check failed. Attempting to fix automatically..."
  pnpm lint:fix && (
    echo "Running final lint check..."
    pnpm lint || (
      echo "âŒ Linting issues remain after auto-fix. Please fix them manually and try committing again."
      exit 1
    )
  ) || (
    echo "âŒ Auto-fix failed. Please fix the issues manually and try committing again."
    exit 1
  )
)

# Run tests with coverage
echo "Running tests with coverage..."
pnpm test:coverage || (echo "âŒ Tests failed. Please fix the failing tests and try committing again." && exit 1)

echo "âœ… All checks passed!" 