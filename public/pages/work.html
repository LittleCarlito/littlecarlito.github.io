<!DOCTYPE html>
<html>
<head>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: black;
            height: 100vh;
            font-family: 'Courier New', monospace;
            color: #00ff00;
        }

        .terminal-text {
            position: relative;
            white-space: nowrap;
            overflow: hidden;
            opacity: 0;
            margin: 20px;
        }

        .terminal-text.revealed {
            opacity: 1;
            width: 4ch;
        }

        .terminal-text.typing {
            opacity: 1;
            animation: typing var(--typing-duration) steps(var(--text-length));
            animation-fill-mode: forwards;
        }

        @keyframes typing {
            from { width: 0 }
            to { width: var(--final-width) }
        }

        .cursor {
            border-right: 2px solid #00ff00;
            animation: blink-caret 0.75s step-end infinite;
        }

        @keyframes blink-caret {
            from, to { border-color: transparent }
            50% { border-color: #00ff00 }
        }

        h3.terminal-text {
            color: #00cc00;  /* Slightly different shade of green */
            margin-top: 5px;
            margin-bottom: 5px;
            font-size: 1.1em;
        }
    </style>
</head>
<body>
    <div id="content">
        <h1 class="terminal-text">--------------------------------</h1>
        <h1 class="terminal-text">WORK EXPERIENCE</h1>
        <h1 class="terminal-text">--------------------------------</h1>
        
        <h2 class="terminal-text">Apex Systems</h2>
        <h3 class="terminal-text">Java Engineer</h3>
        <p class="terminal-text">Remote | June 2024 - Present</p>
        <p class="terminal-text">• Architects and implements enterprise-scale Java solutions for Fortune 500 healthcare clients</p>
        <p class="terminal-text">• Established comprehensive development standards improving code quality by 40%</p>
        <p class="terminal-text">• Spearheads client integration with SailPoint identity management platform</p>
        <p class="terminal-text">• Mentors engineering teams on test-driven development, achieving 95% code coverage</p>
        
        <h2 class="terminal-text">Northwestern Mutual</h2>
        <h3 class="terminal-text">Software Engineer II</h3>
        <p class="terminal-text">Franklin, WI | 2023 - June 2024</p>
        <p class="terminal-text">• Pioneered AI-driven healthcare payment matching system processing $50M+ annually</p>
        <p class="terminal-text">• Led development of mission-critical document processing service handling 100K+ transactions daily</p>
        <p class="terminal-text">• Architected scalable microservices ecosystem with NoSQL backend supporting 1M+ users</p>
        <p class="terminal-text">• Achieved 99.99% uptime across critical systems with zero production incidents</p>
        
        <h3 class="terminal-text">Software Engineer</h3>
        <p class="terminal-text">2021 - 2023</p>
        <p class="terminal-text">• Modernized legacy mainframe systems reducing processing time by 70%</p>
        <p class="terminal-text">• Earned AWS certification and led cloud migration initiatives</p>
        <p class="terminal-text">• Implemented comprehensive testing framework achieving 90% coverage across 50K+ lines of code</p>
        
        <h2 class="terminal-text">Quad Graphics</h2>
        <h3 class="terminal-text">Business Analyst</h3>
        <p class="terminal-text">Sussex, WI | 2014 - 2018</p>
        <p class="terminal-text">• Orchestrated Agile transformation across 5 development teams</p>
        <p class="terminal-text">• Revolutionized healthcare mailing system reducing client onboarding from 6 weeks to 5 days</p>
        <p class="terminal-text">• Managed sensitive healthcare data for 10M+ patients with perfect compliance record</p>
    </div>
    <script type="module">
        import { FLAGS } from '../../common';
        
        const CHARS_PER_SECOND = 200; // Adjust this number to control typing speed

        localStorage.removeItem('work_has_played');
        const textElements = document.querySelectorAll('.terminal-text');
        
        if(FLAGS.HTML_LOGS){
            console.log('Page Load - localStorage state:', localStorage.getItem('work_has_played'));
        }

        let animationInProgress = false;
        let shouldStopAnimation = false;

        async function animateText(element) {
            if(FLAGS.HTML_LOGS){
                console.log('Starting animation for element:', element.textContent.substring(0, 20) + '...');
            }
            return new Promise(resolve => {
                if (!element.textContent.trim() || shouldStopAnimation) {
                    if(FLAGS.HTML_LOGS){
                        console.log('Skipping animation - empty or stopped');
                    }
                    element.style.opacity = '1';
                    resolve();
                    return;
                }

                const textLength = element.textContent.trim().length;
                const duration = textLength / CHARS_PER_SECOND;
                if(FLAGS.HTML_LOGS){
                    console.log(`Animation setup - Length: ${textLength}, Duration: ${duration}s`);
                }
                
                element.style.setProperty('--text-length', textLength);
                element.style.setProperty('--typing-duration', `${duration}s`);
                element.style.setProperty('--final-width', `${textLength}ch`);
                
                element.animationEndHandler = () => {
                    if(FLAGS.HTML_LOGS){
                        console.log('Animation ended for:', element.textContent.substring(0, 20) + '...');
                    }
                    element.classList.remove('typing', 'cursor');
                    element.style.opacity = '1';
                    element.style.width = `${textLength}ch`;
                    element.removeEventListener('animationend', element.animationEndHandler);
                    delete element.animationEndHandler;
                    resolve();
                };
                if(FLAGS.HTML_LOGS){
                    console.log('Adding animation classes and listener');
                }
                element.classList.add('typing', 'cursor');
                element.addEventListener('animationend', element.animationEndHandler, { once: true });
            });
        }

        function stopAllAnimations() {
            if(FLAGS.HTML_LOGS){
                console.log('Stopping all animations');
            }
            shouldStopAnimation = true;
            textElements.forEach(element => {
                if(FLAGS.HTML_LOGS){
                    console.log('Cleaning up element:', element.textContent.substring(0, 20) + '...');
                }
                if (element.animationEndHandler) {
                    element.removeEventListener('animationend', element.animationEndHandler);
                    delete element.animationEndHandler;
                }
                const textLength = element.textContent.length;
                element.classList.remove('typing', 'cursor');
                element.style.opacity = '1';
                element.style.width = `${textLength}ch`;
            });
        }

        window.trigger_frame_animation = async function() {
            if(FLAGS.HTML_LOGS){
                console.log('Animation triggered, localStorage state:', localStorage.getItem('work_has_played'));
            }
            
            // Stop any existing animations
            stopAllAnimations();
            
            // Reset the stop flag
            shouldStopAnimation = false;
            
            if(!localStorage.getItem('work_has_played') && !animationInProgress){
                if(FLAGS.HTML_LOGS){
                    console.log('First time - playing animation');
                }
                animationInProgress = true;
                
                // Reset all elements to initial state
                textElements.forEach(element => {
                    element.style.opacity = '0';
                    element.style.width = '0';
                });
                
                try {
                    for (const element of textElements) {
                        if (shouldStopAnimation) {
                            if(FLAGS.HTML_LOGS){
                                console.log('Animation sequence stopped');
                            }
                            break;
                        }
                        if(FLAGS.HTML_LOGS){
                            console.log('Starting animation for next element');
                        }
                        await animateText(element);
                    }
                } finally {
                    animationInProgress = false;
                    localStorage.setItem('work_has_played', true);
                }
            } else {
                if(FLAGS.HTML_LOGS){
                    console.log('Already played or animation in progress - showing text immediately');
                }
                textElements.forEach(element => {
                    const textLength = element.textContent.length;
                    element.classList.remove('typing', 'cursor');
                    element.style.opacity = '1';
                    element.style.width = `${textLength}ch`;
                });
            }
        };

        // Add cleanup when page is hidden/unloaded
        document.addEventListener('visibilitychange', () => {
            if (document.hidden) {
                stopAllAnimations();
            }
        });
    </script>
</body>
</html>
