<!DOCTYPE html>
<html>
<head>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: black;
            height: 100vh;
            font-family: 'Courier New', monospace;
            color: #00ff00;
        }

        .terminal-text {
            position: relative;
            white-space: nowrap;
            overflow: hidden;
            opacity: 0;
            margin: 20px;
        }

        .terminal-text.revealed {
            opacity: 1;
            width: 4ch;
        }

        .terminal-text.typing {
            opacity: 1;
            animation: typing 2s steps(4);
            animation-fill-mode: forwards;
        }

        @keyframes typing {
            from { width: 0 }
            to { width: 4ch }
        }

        .cursor {
            border-right: 2px solid #00ff00;
            animation: blink-caret 0.75s step-end infinite;
        }

        @keyframes blink-caret {
            from, to { border-color: transparent }
            50% { border-color: #00ff00 }
        }
    </style>
</head>
<body>
    <h1 class="terminal-text">WORK</h1>
    <script type="module">
        import { FLAGS } from '../../common';
        localStorage.removeItem('work_has_played');
        const text = document.querySelector('.terminal-text');
        if(FLAGS.HTML_LOGS){
            console.log('Page Load - localStorage state:', localStorage.getItem('work_has_played'));
        }
        window.trigger_frame_animation = function() {
            if(FLAGS.HTML_LOGS){
                console.log('Animation triggered - localStorage state:', localStorage.getItem('work_has_played'));
            }
            if(!localStorage.getItem('work_has_played')){
                if(FLAGS.HTML_LOGS){
                    console.log('First time - playing animation');
                }
                text.classList.add('typing', 'cursor');
                text.addEventListener('animationend', () => {
                    text.classList.remove('typing');
                    text.style.opacity = '1';
                    text.style.width = '4ch';
                }, { once: true });
                localStorage.setItem('work_has_played', true);
            } else {
                if(FLAGS.HTML_LOGS){
                    console.log('Already played - showing text');
                }
                text.classList.remove('typing');
                text.style.opacity = '1';
                text.style.width = '4ch';
                text.classList.add('cursor');
            }
        };
    </script>
</body>
</html>
