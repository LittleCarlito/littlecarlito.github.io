{"version":3,"file":"index-BsMT1xiX.js","sources":["../../node_modules/three/examples/jsm/libs/tween.module.js","../../common/flags.js","../../node_modules/three/examples/jsm/postprocessing/Pass.js","../../node_modules/three/examples/jsm/utils/BufferGeometryUtils.js","../../node_modules/three/examples/jsm/loaders/GLTFLoader.js","../../node_modules/three/examples/jsm/shaders/CopyShader.js","../../node_modules/three/examples/jsm/postprocessing/ShaderPass.js","../../node_modules/three/examples/jsm/postprocessing/MaskPass.js","../../node_modules/three/examples/jsm/postprocessing/EffectComposer.js","../../node_modules/three/examples/jsm/shaders/OutputShader.js","../../node_modules/three/examples/jsm/postprocessing/OutputPass.js","../../node_modules/three/examples/jsm/postprocessing/RenderPass.js","../../node_modules/three/examples/jsm/shaders/LuminosityHighPassShader.js","../../node_modules/three/examples/jsm/postprocessing/UnrealBloomPass.js","../../node_modules/three/examples/jsm/renderers/CSS2DRenderer.js","../../common/app_renderer.js","../../common/types.js","../../common/names.js","../../common/asset_manager.js","../../viewport/overlay/overlay_common/ui_util.js","../../viewport/overlay/overlay_common/screen.js","../../viewport/overlay/overlay_common/categories.js","../../viewport/overlay/overlay_common/links.js","../../background/background_floor.js","../../node_modules/three/src/math/MathUtils.js","../../viewport/overlay/title_block.js","../../viewport/overlay/text_frame.js","../../viewport/overlay/text_container.js","../../viewport/overlay/label_container.js","../../viewport/overlay/link_container.js","../../viewport/overlay/hide_button.js","../../viewport/overlay/artist_block.js","../../viewport/overlay/overlay_container.js","../../viewport/camera_manager.js","../../viewport/viewable_container.js","../../background/background_lighting.js","../../background/background_common/physics_util.js","../../background/menus/control_menu.js","../../background/menus/scroll_menu.js","../../background/background_container.js","../../main.js"],"sourcesContent":["/**\n * The Ease class provides a collection of easing functions for use with tween.js.\n */\nvar Easing = Object.freeze({\n    Linear: Object.freeze({\n        None: function (amount) {\n            return amount;\n        },\n        In: function (amount) {\n            return this.None(amount);\n        },\n        Out: function (amount) {\n            return this.None(amount);\n        },\n        InOut: function (amount) {\n            return this.None(amount);\n        },\n    }),\n    Quadratic: Object.freeze({\n        In: function (amount) {\n            return amount * amount;\n        },\n        Out: function (amount) {\n            return amount * (2 - amount);\n        },\n        InOut: function (amount) {\n            if ((amount *= 2) < 1) {\n                return 0.5 * amount * amount;\n            }\n            return -0.5 * (--amount * (amount - 2) - 1);\n        },\n    }),\n    Cubic: Object.freeze({\n        In: function (amount) {\n            return amount * amount * amount;\n        },\n        Out: function (amount) {\n            return --amount * amount * amount + 1;\n        },\n        InOut: function (amount) {\n            if ((amount *= 2) < 1) {\n                return 0.5 * amount * amount * amount;\n            }\n            return 0.5 * ((amount -= 2) * amount * amount + 2);\n        },\n    }),\n    Quartic: Object.freeze({\n        In: function (amount) {\n            return amount * amount * amount * amount;\n        },\n        Out: function (amount) {\n            return 1 - --amount * amount * amount * amount;\n        },\n        InOut: function (amount) {\n            if ((amount *= 2) < 1) {\n                return 0.5 * amount * amount * amount * amount;\n            }\n            return -0.5 * ((amount -= 2) * amount * amount * amount - 2);\n        },\n    }),\n    Quintic: Object.freeze({\n        In: function (amount) {\n            return amount * amount * amount * amount * amount;\n        },\n        Out: function (amount) {\n            return --amount * amount * amount * amount * amount + 1;\n        },\n        InOut: function (amount) {\n            if ((amount *= 2) < 1) {\n                return 0.5 * amount * amount * amount * amount * amount;\n            }\n            return 0.5 * ((amount -= 2) * amount * amount * amount * amount + 2);\n        },\n    }),\n    Sinusoidal: Object.freeze({\n        In: function (amount) {\n            return 1 - Math.sin(((1.0 - amount) * Math.PI) / 2);\n        },\n        Out: function (amount) {\n            return Math.sin((amount * Math.PI) / 2);\n        },\n        InOut: function (amount) {\n            return 0.5 * (1 - Math.sin(Math.PI * (0.5 - amount)));\n        },\n    }),\n    Exponential: Object.freeze({\n        In: function (amount) {\n            return amount === 0 ? 0 : Math.pow(1024, amount - 1);\n        },\n        Out: function (amount) {\n            return amount === 1 ? 1 : 1 - Math.pow(2, -10 * amount);\n        },\n        InOut: function (amount) {\n            if (amount === 0) {\n                return 0;\n            }\n            if (amount === 1) {\n                return 1;\n            }\n            if ((amount *= 2) < 1) {\n                return 0.5 * Math.pow(1024, amount - 1);\n            }\n            return 0.5 * (-Math.pow(2, -10 * (amount - 1)) + 2);\n        },\n    }),\n    Circular: Object.freeze({\n        In: function (amount) {\n            return 1 - Math.sqrt(1 - amount * amount);\n        },\n        Out: function (amount) {\n            return Math.sqrt(1 - --amount * amount);\n        },\n        InOut: function (amount) {\n            if ((amount *= 2) < 1) {\n                return -0.5 * (Math.sqrt(1 - amount * amount) - 1);\n            }\n            return 0.5 * (Math.sqrt(1 - (amount -= 2) * amount) + 1);\n        },\n    }),\n    Elastic: Object.freeze({\n        In: function (amount) {\n            if (amount === 0) {\n                return 0;\n            }\n            if (amount === 1) {\n                return 1;\n            }\n            return -Math.pow(2, 10 * (amount - 1)) * Math.sin((amount - 1.1) * 5 * Math.PI);\n        },\n        Out: function (amount) {\n            if (amount === 0) {\n                return 0;\n            }\n            if (amount === 1) {\n                return 1;\n            }\n            return Math.pow(2, -10 * amount) * Math.sin((amount - 0.1) * 5 * Math.PI) + 1;\n        },\n        InOut: function (amount) {\n            if (amount === 0) {\n                return 0;\n            }\n            if (amount === 1) {\n                return 1;\n            }\n            amount *= 2;\n            if (amount < 1) {\n                return -0.5 * Math.pow(2, 10 * (amount - 1)) * Math.sin((amount - 1.1) * 5 * Math.PI);\n            }\n            return 0.5 * Math.pow(2, -10 * (amount - 1)) * Math.sin((amount - 1.1) * 5 * Math.PI) + 1;\n        },\n    }),\n    Back: Object.freeze({\n        In: function (amount) {\n            var s = 1.70158;\n            return amount === 1 ? 1 : amount * amount * ((s + 1) * amount - s);\n        },\n        Out: function (amount) {\n            var s = 1.70158;\n            return amount === 0 ? 0 : --amount * amount * ((s + 1) * amount + s) + 1;\n        },\n        InOut: function (amount) {\n            var s = 1.70158 * 1.525;\n            if ((amount *= 2) < 1) {\n                return 0.5 * (amount * amount * ((s + 1) * amount - s));\n            }\n            return 0.5 * ((amount -= 2) * amount * ((s + 1) * amount + s) + 2);\n        },\n    }),\n    Bounce: Object.freeze({\n        In: function (amount) {\n            return 1 - Easing.Bounce.Out(1 - amount);\n        },\n        Out: function (amount) {\n            if (amount < 1 / 2.75) {\n                return 7.5625 * amount * amount;\n            }\n            else if (amount < 2 / 2.75) {\n                return 7.5625 * (amount -= 1.5 / 2.75) * amount + 0.75;\n            }\n            else if (amount < 2.5 / 2.75) {\n                return 7.5625 * (amount -= 2.25 / 2.75) * amount + 0.9375;\n            }\n            else {\n                return 7.5625 * (amount -= 2.625 / 2.75) * amount + 0.984375;\n            }\n        },\n        InOut: function (amount) {\n            if (amount < 0.5) {\n                return Easing.Bounce.In(amount * 2) * 0.5;\n            }\n            return Easing.Bounce.Out(amount * 2 - 1) * 0.5 + 0.5;\n        },\n    }),\n    generatePow: function (power) {\n        if (power === void 0) { power = 4; }\n        power = power < Number.EPSILON ? Number.EPSILON : power;\n        power = power > 10000 ? 10000 : power;\n        return {\n            In: function (amount) {\n                return Math.pow(amount, power);\n            },\n            Out: function (amount) {\n                return 1 - Math.pow((1 - amount), power);\n            },\n            InOut: function (amount) {\n                if (amount < 0.5) {\n                    return Math.pow((amount * 2), power) / 2;\n                }\n                return (1 - Math.pow((2 - amount * 2), power)) / 2 + 0.5;\n            },\n        };\n    },\n});\n\nvar now = function () { return performance.now(); };\n\n/**\n * Controlling groups of tweens\n *\n * Using the TWEEN singleton to manage your tweens can cause issues in large apps with many components.\n * In these cases, you may want to create your own smaller groups of tween\n */\nvar Group = /** @class */ (function () {\n    function Group() {\n        this._tweens = {};\n        this._tweensAddedDuringUpdate = {};\n    }\n    Group.prototype.getAll = function () {\n        var _this = this;\n        return Object.keys(this._tweens).map(function (tweenId) {\n            return _this._tweens[tweenId];\n        });\n    };\n    Group.prototype.removeAll = function () {\n        this._tweens = {};\n    };\n    Group.prototype.add = function (tween) {\n        this._tweens[tween.getId()] = tween;\n        this._tweensAddedDuringUpdate[tween.getId()] = tween;\n    };\n    Group.prototype.remove = function (tween) {\n        delete this._tweens[tween.getId()];\n        delete this._tweensAddedDuringUpdate[tween.getId()];\n    };\n    Group.prototype.update = function (time, preserve) {\n        if (time === void 0) { time = now(); }\n        if (preserve === void 0) { preserve = false; }\n        var tweenIds = Object.keys(this._tweens);\n        if (tweenIds.length === 0) {\n            return false;\n        }\n        // Tweens are updated in \"batches\". If you add a new tween during an\n        // update, then the new tween will be updated in the next batch.\n        // If you remove a tween during an update, it may or may not be updated.\n        // However, if the removed tween was added during the current batch,\n        // then it will not be updated.\n        while (tweenIds.length > 0) {\n            this._tweensAddedDuringUpdate = {};\n            for (var i = 0; i < tweenIds.length; i++) {\n                var tween = this._tweens[tweenIds[i]];\n                var autoStart = !preserve;\n                if (tween && tween.update(time, autoStart) === false && !preserve) {\n                    delete this._tweens[tweenIds[i]];\n                }\n            }\n            tweenIds = Object.keys(this._tweensAddedDuringUpdate);\n        }\n        return true;\n    };\n    return Group;\n}());\n\n/**\n *\n */\nvar Interpolation = {\n    Linear: function (v, k) {\n        var m = v.length - 1;\n        var f = m * k;\n        var i = Math.floor(f);\n        var fn = Interpolation.Utils.Linear;\n        if (k < 0) {\n            return fn(v[0], v[1], f);\n        }\n        if (k > 1) {\n            return fn(v[m], v[m - 1], m - f);\n        }\n        return fn(v[i], v[i + 1 > m ? m : i + 1], f - i);\n    },\n    Bezier: function (v, k) {\n        var b = 0;\n        var n = v.length - 1;\n        var pw = Math.pow;\n        var bn = Interpolation.Utils.Bernstein;\n        for (var i = 0; i <= n; i++) {\n            b += pw(1 - k, n - i) * pw(k, i) * v[i] * bn(n, i);\n        }\n        return b;\n    },\n    CatmullRom: function (v, k) {\n        var m = v.length - 1;\n        var f = m * k;\n        var i = Math.floor(f);\n        var fn = Interpolation.Utils.CatmullRom;\n        if (v[0] === v[m]) {\n            if (k < 0) {\n                i = Math.floor((f = m * (1 + k)));\n            }\n            return fn(v[(i - 1 + m) % m], v[i], v[(i + 1) % m], v[(i + 2) % m], f - i);\n        }\n        else {\n            if (k < 0) {\n                return v[0] - (fn(v[0], v[0], v[1], v[1], -f) - v[0]);\n            }\n            if (k > 1) {\n                return v[m] - (fn(v[m], v[m], v[m - 1], v[m - 1], f - m) - v[m]);\n            }\n            return fn(v[i ? i - 1 : 0], v[i], v[m < i + 1 ? m : i + 1], v[m < i + 2 ? m : i + 2], f - i);\n        }\n    },\n    Utils: {\n        Linear: function (p0, p1, t) {\n            return (p1 - p0) * t + p0;\n        },\n        Bernstein: function (n, i) {\n            var fc = Interpolation.Utils.Factorial;\n            return fc(n) / fc(i) / fc(n - i);\n        },\n        Factorial: (function () {\n            var a = [1];\n            return function (n) {\n                var s = 1;\n                if (a[n]) {\n                    return a[n];\n                }\n                for (var i = n; i > 1; i--) {\n                    s *= i;\n                }\n                a[n] = s;\n                return s;\n            };\n        })(),\n        CatmullRom: function (p0, p1, p2, p3, t) {\n            var v0 = (p2 - p0) * 0.5;\n            var v1 = (p3 - p1) * 0.5;\n            var t2 = t * t;\n            var t3 = t * t2;\n            return (2 * p1 - 2 * p2 + v0 + v1) * t3 + (-3 * p1 + 3 * p2 - 2 * v0 - v1) * t2 + v0 * t + p1;\n        },\n    },\n};\n\n/**\n * Utils\n */\nvar Sequence = /** @class */ (function () {\n    function Sequence() {\n    }\n    Sequence.nextId = function () {\n        return Sequence._nextId++;\n    };\n    Sequence._nextId = 0;\n    return Sequence;\n}());\n\nvar mainGroup = new Group();\n\n/**\n * Tween.js - Licensed under the MIT license\n * https://github.com/tweenjs/tween.js\n * ----------------------------------------------\n *\n * See https://github.com/tweenjs/tween.js/graphs/contributors for the full list of contributors.\n * Thank you all, you're awesome!\n */\nvar Tween = /** @class */ (function () {\n    function Tween(_object, _group) {\n        if (_group === void 0) { _group = mainGroup; }\n        this._object = _object;\n        this._group = _group;\n        this._isPaused = false;\n        this._pauseStart = 0;\n        this._valuesStart = {};\n        this._valuesEnd = {};\n        this._valuesStartRepeat = {};\n        this._duration = 1000;\n        this._isDynamic = false;\n        this._initialRepeat = 0;\n        this._repeat = 0;\n        this._yoyo = false;\n        this._isPlaying = false;\n        this._reversed = false;\n        this._delayTime = 0;\n        this._startTime = 0;\n        this._easingFunction = Easing.Linear.None;\n        this._interpolationFunction = Interpolation.Linear;\n        // eslint-disable-next-line\n        this._chainedTweens = [];\n        this._onStartCallbackFired = false;\n        this._onEveryStartCallbackFired = false;\n        this._id = Sequence.nextId();\n        this._isChainStopped = false;\n        this._propertiesAreSetUp = false;\n        this._goToEnd = false;\n    }\n    Tween.prototype.getId = function () {\n        return this._id;\n    };\n    Tween.prototype.isPlaying = function () {\n        return this._isPlaying;\n    };\n    Tween.prototype.isPaused = function () {\n        return this._isPaused;\n    };\n    Tween.prototype.getDuration = function () {\n        return this._duration;\n    };\n    Tween.prototype.to = function (target, duration) {\n        if (duration === void 0) { duration = 1000; }\n        if (this._isPlaying)\n            throw new Error('Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.');\n        this._valuesEnd = target;\n        this._propertiesAreSetUp = false;\n        this._duration = duration < 0 ? 0 : duration;\n        return this;\n    };\n    Tween.prototype.duration = function (duration) {\n        if (duration === void 0) { duration = 1000; }\n        this._duration = duration < 0 ? 0 : duration;\n        return this;\n    };\n    Tween.prototype.dynamic = function (dynamic) {\n        if (dynamic === void 0) { dynamic = false; }\n        this._isDynamic = dynamic;\n        return this;\n    };\n    Tween.prototype.start = function (time, overrideStartingValues) {\n        if (time === void 0) { time = now(); }\n        if (overrideStartingValues === void 0) { overrideStartingValues = false; }\n        if (this._isPlaying) {\n            return this;\n        }\n        // eslint-disable-next-line\n        this._group && this._group.add(this);\n        this._repeat = this._initialRepeat;\n        if (this._reversed) {\n            // If we were reversed (f.e. using the yoyo feature) then we need to\n            // flip the tween direction back to forward.\n            this._reversed = false;\n            for (var property in this._valuesStartRepeat) {\n                this._swapEndStartRepeatValues(property);\n                this._valuesStart[property] = this._valuesStartRepeat[property];\n            }\n        }\n        this._isPlaying = true;\n        this._isPaused = false;\n        this._onStartCallbackFired = false;\n        this._onEveryStartCallbackFired = false;\n        this._isChainStopped = false;\n        this._startTime = time;\n        this._startTime += this._delayTime;\n        if (!this._propertiesAreSetUp || overrideStartingValues) {\n            this._propertiesAreSetUp = true;\n            // If dynamic is not enabled, clone the end values instead of using the passed-in end values.\n            if (!this._isDynamic) {\n                var tmp = {};\n                for (var prop in this._valuesEnd)\n                    tmp[prop] = this._valuesEnd[prop];\n                this._valuesEnd = tmp;\n            }\n            this._setupProperties(this._object, this._valuesStart, this._valuesEnd, this._valuesStartRepeat, overrideStartingValues);\n        }\n        return this;\n    };\n    Tween.prototype.startFromCurrentValues = function (time) {\n        return this.start(time, true);\n    };\n    Tween.prototype._setupProperties = function (_object, _valuesStart, _valuesEnd, _valuesStartRepeat, overrideStartingValues) {\n        for (var property in _valuesEnd) {\n            var startValue = _object[property];\n            var startValueIsArray = Array.isArray(startValue);\n            var propType = startValueIsArray ? 'array' : typeof startValue;\n            var isInterpolationList = !startValueIsArray && Array.isArray(_valuesEnd[property]);\n            // If `to()` specifies a property that doesn't exist in the source object,\n            // we should not set that property in the object\n            if (propType === 'undefined' || propType === 'function') {\n                continue;\n            }\n            // Check if an Array was provided as property value\n            if (isInterpolationList) {\n                var endValues = _valuesEnd[property];\n                if (endValues.length === 0) {\n                    continue;\n                }\n                // Handle an array of relative values.\n                // Creates a local copy of the Array with the start value at the front\n                var temp = [startValue];\n                for (var i = 0, l = endValues.length; i < l; i += 1) {\n                    var value = this._handleRelativeValue(startValue, endValues[i]);\n                    if (isNaN(value)) {\n                        isInterpolationList = false;\n                        console.warn('Found invalid interpolation list. Skipping.');\n                        break;\n                    }\n                    temp.push(value);\n                }\n                if (isInterpolationList) {\n                    // if (_valuesStart[property] === undefined) { // handle end values only the first time. NOT NEEDED? setupProperties is now guarded by _propertiesAreSetUp.\n                    _valuesEnd[property] = temp;\n                    // }\n                }\n            }\n            // handle the deepness of the values\n            if ((propType === 'object' || startValueIsArray) && startValue && !isInterpolationList) {\n                _valuesStart[property] = startValueIsArray ? [] : {};\n                var nestedObject = startValue;\n                for (var prop in nestedObject) {\n                    _valuesStart[property][prop] = nestedObject[prop];\n                }\n                // TODO? repeat nested values? And yoyo? And array values?\n                _valuesStartRepeat[property] = startValueIsArray ? [] : {};\n                var endValues = _valuesEnd[property];\n                // If dynamic is not enabled, clone the end values instead of using the passed-in end values.\n                if (!this._isDynamic) {\n                    var tmp = {};\n                    for (var prop in endValues)\n                        tmp[prop] = endValues[prop];\n                    _valuesEnd[property] = endValues = tmp;\n                }\n                this._setupProperties(nestedObject, _valuesStart[property], endValues, _valuesStartRepeat[property], overrideStartingValues);\n            }\n            else {\n                // Save the starting value, but only once unless override is requested.\n                if (typeof _valuesStart[property] === 'undefined' || overrideStartingValues) {\n                    _valuesStart[property] = startValue;\n                }\n                if (!startValueIsArray) {\n                    // eslint-disable-next-line\n                    // @ts-ignore FIXME?\n                    _valuesStart[property] *= 1.0; // Ensures we're using numbers, not strings\n                }\n                if (isInterpolationList) {\n                    // eslint-disable-next-line\n                    // @ts-ignore FIXME?\n                    _valuesStartRepeat[property] = _valuesEnd[property].slice().reverse();\n                }\n                else {\n                    _valuesStartRepeat[property] = _valuesStart[property] || 0;\n                }\n            }\n        }\n    };\n    Tween.prototype.stop = function () {\n        if (!this._isChainStopped) {\n            this._isChainStopped = true;\n            this.stopChainedTweens();\n        }\n        if (!this._isPlaying) {\n            return this;\n        }\n        // eslint-disable-next-line\n        this._group && this._group.remove(this);\n        this._isPlaying = false;\n        this._isPaused = false;\n        if (this._onStopCallback) {\n            this._onStopCallback(this._object);\n        }\n        return this;\n    };\n    Tween.prototype.end = function () {\n        this._goToEnd = true;\n        this.update(Infinity);\n        return this;\n    };\n    Tween.prototype.pause = function (time) {\n        if (time === void 0) { time = now(); }\n        if (this._isPaused || !this._isPlaying) {\n            return this;\n        }\n        this._isPaused = true;\n        this._pauseStart = time;\n        // eslint-disable-next-line\n        this._group && this._group.remove(this);\n        return this;\n    };\n    Tween.prototype.resume = function (time) {\n        if (time === void 0) { time = now(); }\n        if (!this._isPaused || !this._isPlaying) {\n            return this;\n        }\n        this._isPaused = false;\n        this._startTime += time - this._pauseStart;\n        this._pauseStart = 0;\n        // eslint-disable-next-line\n        this._group && this._group.add(this);\n        return this;\n    };\n    Tween.prototype.stopChainedTweens = function () {\n        for (var i = 0, numChainedTweens = this._chainedTweens.length; i < numChainedTweens; i++) {\n            this._chainedTweens[i].stop();\n        }\n        return this;\n    };\n    Tween.prototype.group = function (group) {\n        if (group === void 0) { group = mainGroup; }\n        this._group = group;\n        return this;\n    };\n    Tween.prototype.delay = function (amount) {\n        if (amount === void 0) { amount = 0; }\n        this._delayTime = amount;\n        return this;\n    };\n    Tween.prototype.repeat = function (times) {\n        if (times === void 0) { times = 0; }\n        this._initialRepeat = times;\n        this._repeat = times;\n        return this;\n    };\n    Tween.prototype.repeatDelay = function (amount) {\n        this._repeatDelayTime = amount;\n        return this;\n    };\n    Tween.prototype.yoyo = function (yoyo) {\n        if (yoyo === void 0) { yoyo = false; }\n        this._yoyo = yoyo;\n        return this;\n    };\n    Tween.prototype.easing = function (easingFunction) {\n        if (easingFunction === void 0) { easingFunction = Easing.Linear.None; }\n        this._easingFunction = easingFunction;\n        return this;\n    };\n    Tween.prototype.interpolation = function (interpolationFunction) {\n        if (interpolationFunction === void 0) { interpolationFunction = Interpolation.Linear; }\n        this._interpolationFunction = interpolationFunction;\n        return this;\n    };\n    // eslint-disable-next-line\n    Tween.prototype.chain = function () {\n        var tweens = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            tweens[_i] = arguments[_i];\n        }\n        this._chainedTweens = tweens;\n        return this;\n    };\n    Tween.prototype.onStart = function (callback) {\n        this._onStartCallback = callback;\n        return this;\n    };\n    Tween.prototype.onEveryStart = function (callback) {\n        this._onEveryStartCallback = callback;\n        return this;\n    };\n    Tween.prototype.onUpdate = function (callback) {\n        this._onUpdateCallback = callback;\n        return this;\n    };\n    Tween.prototype.onRepeat = function (callback) {\n        this._onRepeatCallback = callback;\n        return this;\n    };\n    Tween.prototype.onComplete = function (callback) {\n        this._onCompleteCallback = callback;\n        return this;\n    };\n    Tween.prototype.onStop = function (callback) {\n        this._onStopCallback = callback;\n        return this;\n    };\n    /**\n     * @returns true if the tween is still playing after the update, false\n     * otherwise (calling update on a paused tween still returns true because\n     * it is still playing, just paused).\n     */\n    Tween.prototype.update = function (time, autoStart) {\n        var _this = this;\n        var _a;\n        if (time === void 0) { time = now(); }\n        if (autoStart === void 0) { autoStart = true; }\n        if (this._isPaused)\n            return true;\n        var property;\n        var endTime = this._startTime + this._duration;\n        if (!this._goToEnd && !this._isPlaying) {\n            if (time > endTime)\n                return false;\n            if (autoStart)\n                this.start(time, true);\n        }\n        this._goToEnd = false;\n        if (time < this._startTime) {\n            return true;\n        }\n        if (this._onStartCallbackFired === false) {\n            if (this._onStartCallback) {\n                this._onStartCallback(this._object);\n            }\n            this._onStartCallbackFired = true;\n        }\n        if (this._onEveryStartCallbackFired === false) {\n            if (this._onEveryStartCallback) {\n                this._onEveryStartCallback(this._object);\n            }\n            this._onEveryStartCallbackFired = true;\n        }\n        var elapsedTime = time - this._startTime;\n        var durationAndDelay = this._duration + ((_a = this._repeatDelayTime) !== null && _a !== void 0 ? _a : this._delayTime);\n        var totalTime = this._duration + this._repeat * durationAndDelay;\n        var calculateElapsedPortion = function () {\n            if (_this._duration === 0)\n                return 1;\n            if (elapsedTime > totalTime) {\n                return 1;\n            }\n            var timesRepeated = Math.trunc(elapsedTime / durationAndDelay);\n            var timeIntoCurrentRepeat = elapsedTime - timesRepeated * durationAndDelay;\n            // TODO use %?\n            // const timeIntoCurrentRepeat = elapsedTime % durationAndDelay\n            var portion = Math.min(timeIntoCurrentRepeat / _this._duration, 1);\n            if (portion === 0 && elapsedTime === _this._duration) {\n                return 1;\n            }\n            return portion;\n        };\n        var elapsed = calculateElapsedPortion();\n        var value = this._easingFunction(elapsed);\n        // properties transformations\n        this._updateProperties(this._object, this._valuesStart, this._valuesEnd, value);\n        if (this._onUpdateCallback) {\n            this._onUpdateCallback(this._object, elapsed);\n        }\n        if (this._duration === 0 || elapsedTime >= this._duration) {\n            if (this._repeat > 0) {\n                var completeCount = Math.min(Math.trunc((elapsedTime - this._duration) / durationAndDelay) + 1, this._repeat);\n                if (isFinite(this._repeat)) {\n                    this._repeat -= completeCount;\n                }\n                // Reassign starting values, restart by making startTime = now\n                for (property in this._valuesStartRepeat) {\n                    if (!this._yoyo && typeof this._valuesEnd[property] === 'string') {\n                        this._valuesStartRepeat[property] =\n                            // eslint-disable-next-line\n                            // @ts-ignore FIXME?\n                            this._valuesStartRepeat[property] + parseFloat(this._valuesEnd[property]);\n                    }\n                    if (this._yoyo) {\n                        this._swapEndStartRepeatValues(property);\n                    }\n                    this._valuesStart[property] = this._valuesStartRepeat[property];\n                }\n                if (this._yoyo) {\n                    this._reversed = !this._reversed;\n                }\n                this._startTime += durationAndDelay * completeCount;\n                if (this._onRepeatCallback) {\n                    this._onRepeatCallback(this._object);\n                }\n                this._onEveryStartCallbackFired = false;\n                return true;\n            }\n            else {\n                if (this._onCompleteCallback) {\n                    this._onCompleteCallback(this._object);\n                }\n                for (var i = 0, numChainedTweens = this._chainedTweens.length; i < numChainedTweens; i++) {\n                    // Make the chained tweens start exactly at the time they should,\n                    // even if the `update()` method was called way past the duration of the tween\n                    this._chainedTweens[i].start(this._startTime + this._duration, false);\n                }\n                this._isPlaying = false;\n                return false;\n            }\n        }\n        return true;\n    };\n    Tween.prototype._updateProperties = function (_object, _valuesStart, _valuesEnd, value) {\n        for (var property in _valuesEnd) {\n            // Don't update properties that do not exist in the source object\n            if (_valuesStart[property] === undefined) {\n                continue;\n            }\n            var start = _valuesStart[property] || 0;\n            var end = _valuesEnd[property];\n            var startIsArray = Array.isArray(_object[property]);\n            var endIsArray = Array.isArray(end);\n            var isInterpolationList = !startIsArray && endIsArray;\n            if (isInterpolationList) {\n                _object[property] = this._interpolationFunction(end, value);\n            }\n            else if (typeof end === 'object' && end) {\n                // eslint-disable-next-line\n                // @ts-ignore FIXME?\n                this._updateProperties(_object[property], start, end, value);\n            }\n            else {\n                // Parses relative end values with start as base (e.g.: +10, -3)\n                end = this._handleRelativeValue(start, end);\n                // Protect against non numeric properties.\n                if (typeof end === 'number') {\n                    // eslint-disable-next-line\n                    // @ts-ignore FIXME?\n                    _object[property] = start + (end - start) * value;\n                }\n            }\n        }\n    };\n    Tween.prototype._handleRelativeValue = function (start, end) {\n        if (typeof end !== 'string') {\n            return end;\n        }\n        if (end.charAt(0) === '+' || end.charAt(0) === '-') {\n            return start + parseFloat(end);\n        }\n        return parseFloat(end);\n    };\n    Tween.prototype._swapEndStartRepeatValues = function (property) {\n        var tmp = this._valuesStartRepeat[property];\n        var endValue = this._valuesEnd[property];\n        if (typeof endValue === 'string') {\n            this._valuesStartRepeat[property] = this._valuesStartRepeat[property] + parseFloat(endValue);\n        }\n        else {\n            this._valuesStartRepeat[property] = this._valuesEnd[property];\n        }\n        this._valuesEnd[property] = tmp;\n    };\n    return Tween;\n}());\n\nvar VERSION = '23.1.1';\n\n/**\n * Tween.js - Licensed under the MIT license\n * https://github.com/tweenjs/tween.js\n * ----------------------------------------------\n *\n * See https://github.com/tweenjs/tween.js/graphs/contributors for the full list of contributors.\n * Thank you all, you're awesome!\n */\nvar nextId = Sequence.nextId;\n/**\n * Controlling groups of tweens\n *\n * Using the TWEEN singleton to manage your tweens can cause issues in large apps with many components.\n * In these cases, you may want to create your own smaller groups of tweens.\n */\nvar TWEEN = mainGroup;\n// This is the best way to export things in a way that's compatible with both ES\n// Modules and CommonJS, without build hacks, and so as not to break the\n// existing API.\n// https://github.com/rollup/rollup/issues/1961#issuecomment-423037881\nvar getAll = TWEEN.getAll.bind(TWEEN);\nvar removeAll = TWEEN.removeAll.bind(TWEEN);\nvar add = TWEEN.add.bind(TWEEN);\nvar remove = TWEEN.remove.bind(TWEEN);\nvar update = TWEEN.update.bind(TWEEN);\nvar exports = {\n    Easing: Easing,\n    Group: Group,\n    Interpolation: Interpolation,\n    now: now,\n    Sequence: Sequence,\n    nextId: nextId,\n    Tween: Tween,\n    VERSION: VERSION,\n    getAll: getAll,\n    removeAll: removeAll,\n    add: add,\n    remove: remove,\n    update: update,\n};\n\nexport { Easing, Group, Interpolation, Sequence, Tween, VERSION, add, exports as default, getAll, nextId, now, remove, removeAll, update };\n","export const FLAGS = {\n    // Functionality flags\n    CONSTRUCTION_GREETING: true,\n    LAYER: true,\n    // Log flags\n    SELECT_LOGS: false,\n    TWEEN_LOGS: false,\n    HTML_LOGS: false,\n    PHYSICS_LOGS: false,\n    ASSET_LOGS: false,\n    ACTIVATE_LOGS: true,\n    EFFECT_LOGS: false\n};\n\nObject.freeze(FLAGS);","import {\n\tBufferGeometry,\n\tFloat32BufferAttribute,\n\tOrthographicCamera,\n\tMesh\n} from 'three';\n\nclass Pass {\n\n\tconstructor() {\n\n\t\tthis.isPass = true;\n\n\t\t// if set to true, the pass is processed by the composer\n\t\tthis.enabled = true;\n\n\t\t// if set to true, the pass indicates to swap read and write buffer after rendering\n\t\tthis.needsSwap = true;\n\n\t\t// if set to true, the pass clears its buffer before rendering\n\t\tthis.clear = false;\n\n\t\t// if set to true, the result of the pass is rendered to screen. This is set automatically by EffectComposer.\n\t\tthis.renderToScreen = false;\n\n\t}\n\n\tsetSize( /* width, height */ ) {}\n\n\trender( /* renderer, writeBuffer, readBuffer, deltaTime, maskActive */ ) {\n\n\t\tconsole.error( 'THREE.Pass: .render() must be implemented in derived pass.' );\n\n\t}\n\n\tdispose() {}\n\n}\n\n// Helper for passes that need to fill the viewport with a single quad.\n\nconst _camera = new OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\n\n// https://github.com/mrdoob/three.js/pull/21358\n\nclass FullscreenTriangleGeometry extends BufferGeometry {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( [ - 1, 3, 0, - 1, - 1, 0, 3, - 1, 0 ], 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( [ 0, 2, 0, 0, 2, 0 ], 2 ) );\n\n\t}\n\n}\n\nconst _geometry = new FullscreenTriangleGeometry();\n\nclass FullScreenQuad {\n\n\tconstructor( material ) {\n\n\t\tthis._mesh = new Mesh( _geometry, material );\n\n\t}\n\n\tdispose() {\n\n\t\tthis._mesh.geometry.dispose();\n\n\t}\n\n\trender( renderer ) {\n\n\t\trenderer.render( this._mesh, _camera );\n\n\t}\n\n\tget material() {\n\n\t\treturn this._mesh.material;\n\n\t}\n\n\tset material( value ) {\n\n\t\tthis._mesh.material = value;\n\n\t}\n\n}\n\nexport { Pass, FullScreenQuad };\n","import {\n\tBufferAttribute,\n\tBufferGeometry,\n\tFloat32BufferAttribute,\n\tInstancedBufferAttribute,\n\tInterleavedBuffer,\n\tInterleavedBufferAttribute,\n\tTriangleFanDrawMode,\n\tTriangleStripDrawMode,\n\tTrianglesDrawMode,\n\tVector3,\n} from 'three';\n\nfunction computeMikkTSpaceTangents( geometry, MikkTSpace, negateSign = true ) {\n\n\tif ( ! MikkTSpace || ! MikkTSpace.isReady ) {\n\n\t\tthrow new Error( 'BufferGeometryUtils: Initialized MikkTSpace library required.' );\n\n\t}\n\n\tif ( ! geometry.hasAttribute( 'position' ) || ! geometry.hasAttribute( 'normal' ) || ! geometry.hasAttribute( 'uv' ) ) {\n\n\t\tthrow new Error( 'BufferGeometryUtils: Tangents require \"position\", \"normal\", and \"uv\" attributes.' );\n\n\t}\n\n\tfunction getAttributeArray( attribute ) {\n\n\t\tif ( attribute.normalized || attribute.isInterleavedBufferAttribute ) {\n\n\t\t\tconst dstArray = new Float32Array( attribute.count * attribute.itemSize );\n\n\t\t\tfor ( let i = 0, j = 0; i < attribute.count; i ++ ) {\n\n\t\t\t\tdstArray[ j ++ ] = attribute.getX( i );\n\t\t\t\tdstArray[ j ++ ] = attribute.getY( i );\n\n\t\t\t\tif ( attribute.itemSize > 2 ) {\n\n\t\t\t\t\tdstArray[ j ++ ] = attribute.getZ( i );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn dstArray;\n\n\t\t}\n\n\t\tif ( attribute.array instanceof Float32Array ) {\n\n\t\t\treturn attribute.array;\n\n\t\t}\n\n\t\treturn new Float32Array( attribute.array );\n\n\t}\n\n\t// MikkTSpace algorithm requires non-indexed input.\n\n\tconst _geometry = geometry.index ? geometry.toNonIndexed() : geometry;\n\n\t// Compute vertex tangents.\n\n\tconst tangents = MikkTSpace.generateTangents(\n\n\t\tgetAttributeArray( _geometry.attributes.position ),\n\t\tgetAttributeArray( _geometry.attributes.normal ),\n\t\tgetAttributeArray( _geometry.attributes.uv )\n\n\t);\n\n\t// Texture coordinate convention of glTF differs from the apparent\n\t// default of the MikkTSpace library; .w component must be flipped.\n\n\tif ( negateSign ) {\n\n\t\tfor ( let i = 3; i < tangents.length; i += 4 ) {\n\n\t\t\ttangents[ i ] *= - 1;\n\n\t\t}\n\n\t}\n\n\t//\n\n\t_geometry.setAttribute( 'tangent', new BufferAttribute( tangents, 4 ) );\n\n\tif ( geometry !== _geometry ) {\n\n\t\tgeometry.copy( _geometry );\n\n\t}\n\n\treturn geometry;\n\n}\n\n/**\n * @param  {Array<BufferGeometry>} geometries\n * @param  {Boolean} useGroups\n * @return {BufferGeometry}\n */\nfunction mergeGeometries( geometries, useGroups = false ) {\n\n\tconst isIndexed = geometries[ 0 ].index !== null;\n\n\tconst attributesUsed = new Set( Object.keys( geometries[ 0 ].attributes ) );\n\tconst morphAttributesUsed = new Set( Object.keys( geometries[ 0 ].morphAttributes ) );\n\n\tconst attributes = {};\n\tconst morphAttributes = {};\n\n\tconst morphTargetsRelative = geometries[ 0 ].morphTargetsRelative;\n\n\tconst mergedGeometry = new BufferGeometry();\n\n\tlet offset = 0;\n\n\tfor ( let i = 0; i < geometries.length; ++ i ) {\n\n\t\tconst geometry = geometries[ i ];\n\t\tlet attributesCount = 0;\n\n\t\t// ensure that all geometries are indexed, or none\n\n\t\tif ( isIndexed !== ( geometry.index !== null ) ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// gather attributes, exit early if they're different\n\n\t\tfor ( const name in geometry.attributes ) {\n\n\t\t\tif ( ! attributesUsed.has( name ) ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. All geometries must have compatible attributes; make sure \"' + name + '\" attribute exists among all geometries, or in none of them.' );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tif ( attributes[ name ] === undefined ) attributes[ name ] = [];\n\n\t\t\tattributes[ name ].push( geometry.attributes[ name ] );\n\n\t\t\tattributesCount ++;\n\n\t\t}\n\n\t\t// ensure geometries have the same number of attributes\n\n\t\tif ( attributesCount !== attributesUsed.size ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. Make sure all geometries have the same number of attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// gather morph attributes, exit early if they're different\n\n\t\tif ( morphTargetsRelative !== geometry.morphTargetsRelative ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. .morphTargetsRelative must be consistent throughout all geometries.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tfor ( const name in geometry.morphAttributes ) {\n\n\t\t\tif ( ! morphAttributesUsed.has( name ) ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '.  .morphAttributes must be consistent throughout all geometries.' );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tif ( morphAttributes[ name ] === undefined ) morphAttributes[ name ] = [];\n\n\t\t\tmorphAttributes[ name ].push( geometry.morphAttributes[ name ] );\n\n\t\t}\n\n\t\tif ( useGroups ) {\n\n\t\t\tlet count;\n\n\t\t\tif ( isIndexed ) {\n\n\t\t\t\tcount = geometry.index.count;\n\n\t\t\t} else if ( geometry.attributes.position !== undefined ) {\n\n\t\t\t\tcount = geometry.attributes.position.count;\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. The geometry must have either an index or a position attribute' );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tmergedGeometry.addGroup( offset, count, i );\n\n\t\t\toffset += count;\n\n\t\t}\n\n\t}\n\n\t// merge indices\n\n\tif ( isIndexed ) {\n\n\t\tlet indexOffset = 0;\n\t\tconst mergedIndex = [];\n\n\t\tfor ( let i = 0; i < geometries.length; ++ i ) {\n\n\t\t\tconst index = geometries[ i ].index;\n\n\t\t\tfor ( let j = 0; j < index.count; ++ j ) {\n\n\t\t\t\tmergedIndex.push( index.getX( j ) + indexOffset );\n\n\t\t\t}\n\n\t\t\tindexOffset += geometries[ i ].attributes.position.count;\n\n\t\t}\n\n\t\tmergedGeometry.setIndex( mergedIndex );\n\n\t}\n\n\t// merge attributes\n\n\tfor ( const name in attributes ) {\n\n\t\tconst mergedAttribute = mergeAttributes( attributes[ name ] );\n\n\t\tif ( ! mergedAttribute ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the ' + name + ' attribute.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tmergedGeometry.setAttribute( name, mergedAttribute );\n\n\t}\n\n\t// merge morph attributes\n\n\tfor ( const name in morphAttributes ) {\n\n\t\tconst numMorphTargets = morphAttributes[ name ][ 0 ].length;\n\n\t\tif ( numMorphTargets === 0 ) break;\n\n\t\tmergedGeometry.morphAttributes = mergedGeometry.morphAttributes || {};\n\t\tmergedGeometry.morphAttributes[ name ] = [];\n\n\t\tfor ( let i = 0; i < numMorphTargets; ++ i ) {\n\n\t\t\tconst morphAttributesToMerge = [];\n\n\t\t\tfor ( let j = 0; j < morphAttributes[ name ].length; ++ j ) {\n\n\t\t\t\tmorphAttributesToMerge.push( morphAttributes[ name ][ j ][ i ] );\n\n\t\t\t}\n\n\t\t\tconst mergedMorphAttribute = mergeAttributes( morphAttributesToMerge );\n\n\t\t\tif ( ! mergedMorphAttribute ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the ' + name + ' morphAttribute.' );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tmergedGeometry.morphAttributes[ name ].push( mergedMorphAttribute );\n\n\t\t}\n\n\t}\n\n\treturn mergedGeometry;\n\n}\n\n/**\n * @param {Array<BufferAttribute>} attributes\n * @return {BufferAttribute}\n */\nfunction mergeAttributes( attributes ) {\n\n\tlet TypedArray;\n\tlet itemSize;\n\tlet normalized;\n\tlet gpuType = - 1;\n\tlet arrayLength = 0;\n\n\tfor ( let i = 0; i < attributes.length; ++ i ) {\n\n\t\tconst attribute = attributes[ i ];\n\n\t\tif ( TypedArray === undefined ) TypedArray = attribute.array.constructor;\n\t\tif ( TypedArray !== attribute.array.constructor ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tif ( itemSize === undefined ) itemSize = attribute.itemSize;\n\t\tif ( itemSize !== attribute.itemSize ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tif ( normalized === undefined ) normalized = attribute.normalized;\n\t\tif ( normalized !== attribute.normalized ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tif ( gpuType === - 1 ) gpuType = attribute.gpuType;\n\t\tif ( gpuType !== attribute.gpuType ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tarrayLength += attribute.count * itemSize;\n\n\t}\n\n\tconst array = new TypedArray( arrayLength );\n\tconst result = new BufferAttribute( array, itemSize, normalized );\n\tlet offset = 0;\n\n\tfor ( let i = 0; i < attributes.length; ++ i ) {\n\n\t\tconst attribute = attributes[ i ];\n\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\tconst tupleOffset = offset / itemSize;\n\t\t\tfor ( let j = 0, l = attribute.count; j < l; j ++ ) {\n\n\t\t\t\tfor ( let c = 0; c < itemSize; c ++ ) {\n\n\t\t\t\t\tconst value = attribute.getComponent( j, c );\n\t\t\t\t\tresult.setComponent( j + tupleOffset, c, value );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tarray.set( attribute.array, offset );\n\n\t\t}\n\n\t\toffset += attribute.count * itemSize;\n\n\t}\n\n\tif ( gpuType !== undefined ) {\n\n\t\tresult.gpuType = gpuType;\n\n\t}\n\n\treturn result;\n\n}\n\n/**\n * @param {BufferAttribute} attribute\n * @return {BufferAttribute}\n */\nexport function deepCloneAttribute( attribute ) {\n\n\tif ( attribute.isInstancedInterleavedBufferAttribute || attribute.isInterleavedBufferAttribute ) {\n\n\t\treturn deinterleaveAttribute( attribute );\n\n\t}\n\n\tif ( attribute.isInstancedBufferAttribute ) {\n\n\t\treturn new InstancedBufferAttribute().copy( attribute );\n\n\t}\n\n\treturn new BufferAttribute().copy( attribute );\n\n}\n\n/**\n * @param {Array<BufferAttribute>} attributes\n * @return {Array<InterleavedBufferAttribute>}\n */\nfunction interleaveAttributes( attributes ) {\n\n\t// Interleaves the provided attributes into an InterleavedBuffer and returns\n\t// a set of InterleavedBufferAttributes for each attribute\n\tlet TypedArray;\n\tlet arrayLength = 0;\n\tlet stride = 0;\n\n\t// calculate the length and type of the interleavedBuffer\n\tfor ( let i = 0, l = attributes.length; i < l; ++ i ) {\n\n\t\tconst attribute = attributes[ i ];\n\n\t\tif ( TypedArray === undefined ) TypedArray = attribute.array.constructor;\n\t\tif ( TypedArray !== attribute.array.constructor ) {\n\n\t\t\tconsole.error( 'AttributeBuffers of different types cannot be interleaved' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tarrayLength += attribute.array.length;\n\t\tstride += attribute.itemSize;\n\n\t}\n\n\t// Create the set of buffer attributes\n\tconst interleavedBuffer = new InterleavedBuffer( new TypedArray( arrayLength ), stride );\n\tlet offset = 0;\n\tconst res = [];\n\tconst getters = [ 'getX', 'getY', 'getZ', 'getW' ];\n\tconst setters = [ 'setX', 'setY', 'setZ', 'setW' ];\n\n\tfor ( let j = 0, l = attributes.length; j < l; j ++ ) {\n\n\t\tconst attribute = attributes[ j ];\n\t\tconst itemSize = attribute.itemSize;\n\t\tconst count = attribute.count;\n\t\tconst iba = new InterleavedBufferAttribute( interleavedBuffer, itemSize, offset, attribute.normalized );\n\t\tres.push( iba );\n\n\t\toffset += itemSize;\n\n\t\t// Move the data for each attribute into the new interleavedBuffer\n\t\t// at the appropriate offset\n\t\tfor ( let c = 0; c < count; c ++ ) {\n\n\t\t\tfor ( let k = 0; k < itemSize; k ++ ) {\n\n\t\t\t\tiba[ setters[ k ] ]( c, attribute[ getters[ k ] ]( c ) );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\treturn res;\n\n}\n\n// returns a new, non-interleaved version of the provided attribute\nexport function deinterleaveAttribute( attribute ) {\n\n\tconst cons = attribute.data.array.constructor;\n\tconst count = attribute.count;\n\tconst itemSize = attribute.itemSize;\n\tconst normalized = attribute.normalized;\n\n\tconst array = new cons( count * itemSize );\n\tlet newAttribute;\n\tif ( attribute.isInstancedInterleavedBufferAttribute ) {\n\n\t\tnewAttribute = new InstancedBufferAttribute( array, itemSize, normalized, attribute.meshPerAttribute );\n\n\t} else {\n\n\t\tnewAttribute = new BufferAttribute( array, itemSize, normalized );\n\n\t}\n\n\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\tnewAttribute.setX( i, attribute.getX( i ) );\n\n\t\tif ( itemSize >= 2 ) {\n\n\t\t\tnewAttribute.setY( i, attribute.getY( i ) );\n\n\t\t}\n\n\t\tif ( itemSize >= 3 ) {\n\n\t\t\tnewAttribute.setZ( i, attribute.getZ( i ) );\n\n\t\t}\n\n\t\tif ( itemSize >= 4 ) {\n\n\t\t\tnewAttribute.setW( i, attribute.getW( i ) );\n\n\t\t}\n\n\t}\n\n\treturn newAttribute;\n\n}\n\n// deinterleaves all attributes on the geometry\nexport function deinterleaveGeometry( geometry ) {\n\n\tconst attributes = geometry.attributes;\n\tconst morphTargets = geometry.morphTargets;\n\tconst attrMap = new Map();\n\n\tfor ( const key in attributes ) {\n\n\t\tconst attr = attributes[ key ];\n\t\tif ( attr.isInterleavedBufferAttribute ) {\n\n\t\t\tif ( ! attrMap.has( attr ) ) {\n\n\t\t\t\tattrMap.set( attr, deinterleaveAttribute( attr ) );\n\n\t\t\t}\n\n\t\t\tattributes[ key ] = attrMap.get( attr );\n\n\t\t}\n\n\t}\n\n\tfor ( const key in morphTargets ) {\n\n\t\tconst attr = morphTargets[ key ];\n\t\tif ( attr.isInterleavedBufferAttribute ) {\n\n\t\t\tif ( ! attrMap.has( attr ) ) {\n\n\t\t\t\tattrMap.set( attr, deinterleaveAttribute( attr ) );\n\n\t\t\t}\n\n\t\t\tmorphTargets[ key ] = attrMap.get( attr );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @return {number}\n */\nfunction estimateBytesUsed( geometry ) {\n\n\t// Return the estimated memory used by this geometry in bytes\n\t// Calculate using itemSize, count, and BYTES_PER_ELEMENT to account\n\t// for InterleavedBufferAttributes.\n\tlet mem = 0;\n\tfor ( const name in geometry.attributes ) {\n\n\t\tconst attr = geometry.getAttribute( name );\n\t\tmem += attr.count * attr.itemSize * attr.array.BYTES_PER_ELEMENT;\n\n\t}\n\n\tconst indices = geometry.getIndex();\n\tmem += indices ? indices.count * indices.itemSize * indices.array.BYTES_PER_ELEMENT : 0;\n\treturn mem;\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {number} tolerance\n * @return {BufferGeometry}\n */\nfunction mergeVertices( geometry, tolerance = 1e-4 ) {\n\n\ttolerance = Math.max( tolerance, Number.EPSILON );\n\n\t// Generate an index buffer if the geometry doesn't have one, or optimize it\n\t// if it's already available.\n\tconst hashToIndex = {};\n\tconst indices = geometry.getIndex();\n\tconst positions = geometry.getAttribute( 'position' );\n\tconst vertexCount = indices ? indices.count : positions.count;\n\n\t// next value for triangle indices\n\tlet nextIndex = 0;\n\n\t// attributes and new attribute arrays\n\tconst attributeNames = Object.keys( geometry.attributes );\n\tconst tmpAttributes = {};\n\tconst tmpMorphAttributes = {};\n\tconst newIndices = [];\n\tconst getters = [ 'getX', 'getY', 'getZ', 'getW' ];\n\tconst setters = [ 'setX', 'setY', 'setZ', 'setW' ];\n\n\t// Initialize the arrays, allocating space conservatively. Extra\n\t// space will be trimmed in the last step.\n\tfor ( let i = 0, l = attributeNames.length; i < l; i ++ ) {\n\n\t\tconst name = attributeNames[ i ];\n\t\tconst attr = geometry.attributes[ name ];\n\n\t\ttmpAttributes[ name ] = new attr.constructor(\n\t\t\tnew attr.array.constructor( attr.count * attr.itemSize ),\n\t\t\tattr.itemSize,\n\t\t\tattr.normalized\n\t\t);\n\n\t\tconst morphAttributes = geometry.morphAttributes[ name ];\n\t\tif ( morphAttributes ) {\n\n\t\t\tif ( ! tmpMorphAttributes[ name ] ) tmpMorphAttributes[ name ] = [];\n\t\t\tmorphAttributes.forEach( ( morphAttr, i ) => {\n\n\t\t\t\tconst array = new morphAttr.array.constructor( morphAttr.count * morphAttr.itemSize );\n\t\t\t\ttmpMorphAttributes[ name ][ i ] = new morphAttr.constructor( array, morphAttr.itemSize, morphAttr.normalized );\n\n\t\t\t} );\n\n\t\t}\n\n\t}\n\n\t// convert the error tolerance to an amount of decimal places to truncate to\n\tconst halfTolerance = tolerance * 0.5;\n\tconst exponent = Math.log10( 1 / tolerance );\n\tconst hashMultiplier = Math.pow( 10, exponent );\n\tconst hashAdditive = halfTolerance * hashMultiplier;\n\tfor ( let i = 0; i < vertexCount; i ++ ) {\n\n\t\tconst index = indices ? indices.getX( i ) : i;\n\n\t\t// Generate a hash for the vertex attributes at the current index 'i'\n\t\tlet hash = '';\n\t\tfor ( let j = 0, l = attributeNames.length; j < l; j ++ ) {\n\n\t\t\tconst name = attributeNames[ j ];\n\t\t\tconst attribute = geometry.getAttribute( name );\n\t\t\tconst itemSize = attribute.itemSize;\n\n\t\t\tfor ( let k = 0; k < itemSize; k ++ ) {\n\n\t\t\t\t// double tilde truncates the decimal value\n\t\t\t\thash += `${ ~ ~ ( attribute[ getters[ k ] ]( index ) * hashMultiplier + hashAdditive ) },`;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Add another reference to the vertex if it's already\n\t\t// used by another index\n\t\tif ( hash in hashToIndex ) {\n\n\t\t\tnewIndices.push( hashToIndex[ hash ] );\n\n\t\t} else {\n\n\t\t\t// copy data to the new index in the temporary attributes\n\t\t\tfor ( let j = 0, l = attributeNames.length; j < l; j ++ ) {\n\n\t\t\t\tconst name = attributeNames[ j ];\n\t\t\t\tconst attribute = geometry.getAttribute( name );\n\t\t\t\tconst morphAttributes = geometry.morphAttributes[ name ];\n\t\t\t\tconst itemSize = attribute.itemSize;\n\t\t\t\tconst newArray = tmpAttributes[ name ];\n\t\t\t\tconst newMorphArrays = tmpMorphAttributes[ name ];\n\n\t\t\t\tfor ( let k = 0; k < itemSize; k ++ ) {\n\n\t\t\t\t\tconst getterFunc = getters[ k ];\n\t\t\t\t\tconst setterFunc = setters[ k ];\n\t\t\t\t\tnewArray[ setterFunc ]( nextIndex, attribute[ getterFunc ]( index ) );\n\n\t\t\t\t\tif ( morphAttributes ) {\n\n\t\t\t\t\t\tfor ( let m = 0, ml = morphAttributes.length; m < ml; m ++ ) {\n\n\t\t\t\t\t\t\tnewMorphArrays[ m ][ setterFunc ]( nextIndex, morphAttributes[ m ][ getterFunc ]( index ) );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\thashToIndex[ hash ] = nextIndex;\n\t\t\tnewIndices.push( nextIndex );\n\t\t\tnextIndex ++;\n\n\t\t}\n\n\t}\n\n\t// generate result BufferGeometry\n\tconst result = geometry.clone();\n\tfor ( const name in geometry.attributes ) {\n\n\t\tconst tmpAttribute = tmpAttributes[ name ];\n\n\t\tresult.setAttribute( name, new tmpAttribute.constructor(\n\t\t\ttmpAttribute.array.slice( 0, nextIndex * tmpAttribute.itemSize ),\n\t\t\ttmpAttribute.itemSize,\n\t\t\ttmpAttribute.normalized,\n\t\t) );\n\n\t\tif ( ! ( name in tmpMorphAttributes ) ) continue;\n\n\t\tfor ( let j = 0; j < tmpMorphAttributes[ name ].length; j ++ ) {\n\n\t\t\tconst tmpMorphAttribute = tmpMorphAttributes[ name ][ j ];\n\n\t\t\tresult.morphAttributes[ name ][ j ] = new tmpMorphAttribute.constructor(\n\t\t\t\ttmpMorphAttribute.array.slice( 0, nextIndex * tmpMorphAttribute.itemSize ),\n\t\t\t\ttmpMorphAttribute.itemSize,\n\t\t\t\ttmpMorphAttribute.normalized,\n\t\t\t);\n\n\t\t}\n\n\t}\n\n\t// indices\n\n\tresult.setIndex( newIndices );\n\n\treturn result;\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {number} drawMode\n * @return {BufferGeometry}\n */\nfunction toTrianglesDrawMode( geometry, drawMode ) {\n\n\tif ( drawMode === TrianglesDrawMode ) {\n\n\t\tconsole.warn( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles.' );\n\t\treturn geometry;\n\n\t}\n\n\tif ( drawMode === TriangleFanDrawMode || drawMode === TriangleStripDrawMode ) {\n\n\t\tlet index = geometry.getIndex();\n\n\t\t// generate index if not present\n\n\t\tif ( index === null ) {\n\n\t\t\tconst indices = [];\n\n\t\t\tconst position = geometry.getAttribute( 'position' );\n\n\t\t\tif ( position !== undefined ) {\n\n\t\t\t\tfor ( let i = 0; i < position.count; i ++ ) {\n\n\t\t\t\t\tindices.push( i );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.setIndex( indices );\n\t\t\t\tindex = geometry.getIndex();\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible.' );\n\t\t\t\treturn geometry;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tconst numberOfTriangles = index.count - 2;\n\t\tconst newIndices = [];\n\n\t\tif ( drawMode === TriangleFanDrawMode ) {\n\n\t\t\t// gl.TRIANGLE_FAN\n\n\t\t\tfor ( let i = 1; i <= numberOfTriangles; i ++ ) {\n\n\t\t\t\tnewIndices.push( index.getX( 0 ) );\n\t\t\t\tnewIndices.push( index.getX( i ) );\n\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// gl.TRIANGLE_STRIP\n\n\t\t\tfor ( let i = 0; i < numberOfTriangles; i ++ ) {\n\n\t\t\t\tif ( i % 2 === 0 ) {\n\n\t\t\t\t\tnewIndices.push( index.getX( i ) );\n\t\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\t\t\t\t\tnewIndices.push( index.getX( i + 2 ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tnewIndices.push( index.getX( i + 2 ) );\n\t\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\t\t\t\t\tnewIndices.push( index.getX( i ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( ( newIndices.length / 3 ) !== numberOfTriangles ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.' );\n\n\t\t}\n\n\t\t// build final geometry\n\n\t\tconst newGeometry = geometry.clone();\n\t\tnewGeometry.setIndex( newIndices );\n\t\tnewGeometry.clearGroups();\n\n\t\treturn newGeometry;\n\n\t} else {\n\n\t\tconsole.error( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:', drawMode );\n\t\treturn geometry;\n\n\t}\n\n}\n\n/**\n * Calculates the morphed attributes of a morphed/skinned BufferGeometry.\n * Helpful for Raytracing or Decals.\n * @param {Mesh | Line | Points} object An instance of Mesh, Line or Points.\n * @return {Object} An Object with original position/normal attributes and morphed ones.\n */\nfunction computeMorphedAttributes( object ) {\n\n\tconst _vA = new Vector3();\n\tconst _vB = new Vector3();\n\tconst _vC = new Vector3();\n\n\tconst _tempA = new Vector3();\n\tconst _tempB = new Vector3();\n\tconst _tempC = new Vector3();\n\n\tconst _morphA = new Vector3();\n\tconst _morphB = new Vector3();\n\tconst _morphC = new Vector3();\n\n\tfunction _calculateMorphedAttributeData(\n\t\tobject,\n\t\tattribute,\n\t\tmorphAttribute,\n\t\tmorphTargetsRelative,\n\t\ta,\n\t\tb,\n\t\tc,\n\t\tmodifiedAttributeArray\n\t) {\n\n\t\t_vA.fromBufferAttribute( attribute, a );\n\t\t_vB.fromBufferAttribute( attribute, b );\n\t\t_vC.fromBufferAttribute( attribute, c );\n\n\t\tconst morphInfluences = object.morphTargetInfluences;\n\n\t\tif ( morphAttribute && morphInfluences ) {\n\n\t\t\t_morphA.set( 0, 0, 0 );\n\t\t\t_morphB.set( 0, 0, 0 );\n\t\t\t_morphC.set( 0, 0, 0 );\n\n\t\t\tfor ( let i = 0, il = morphAttribute.length; i < il; i ++ ) {\n\n\t\t\t\tconst influence = morphInfluences[ i ];\n\t\t\t\tconst morph = morphAttribute[ i ];\n\n\t\t\t\tif ( influence === 0 ) continue;\n\n\t\t\t\t_tempA.fromBufferAttribute( morph, a );\n\t\t\t\t_tempB.fromBufferAttribute( morph, b );\n\t\t\t\t_tempC.fromBufferAttribute( morph, c );\n\n\t\t\t\tif ( morphTargetsRelative ) {\n\n\t\t\t\t\t_morphA.addScaledVector( _tempA, influence );\n\t\t\t\t\t_morphB.addScaledVector( _tempB, influence );\n\t\t\t\t\t_morphC.addScaledVector( _tempC, influence );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t_morphA.addScaledVector( _tempA.sub( _vA ), influence );\n\t\t\t\t\t_morphB.addScaledVector( _tempB.sub( _vB ), influence );\n\t\t\t\t\t_morphC.addScaledVector( _tempC.sub( _vC ), influence );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t_vA.add( _morphA );\n\t\t\t_vB.add( _morphB );\n\t\t\t_vC.add( _morphC );\n\n\t\t}\n\n\t\tif ( object.isSkinnedMesh ) {\n\n\t\t\tobject.applyBoneTransform( a, _vA );\n\t\t\tobject.applyBoneTransform( b, _vB );\n\t\t\tobject.applyBoneTransform( c, _vC );\n\n\t\t}\n\n\t\tmodifiedAttributeArray[ a * 3 + 0 ] = _vA.x;\n\t\tmodifiedAttributeArray[ a * 3 + 1 ] = _vA.y;\n\t\tmodifiedAttributeArray[ a * 3 + 2 ] = _vA.z;\n\t\tmodifiedAttributeArray[ b * 3 + 0 ] = _vB.x;\n\t\tmodifiedAttributeArray[ b * 3 + 1 ] = _vB.y;\n\t\tmodifiedAttributeArray[ b * 3 + 2 ] = _vB.z;\n\t\tmodifiedAttributeArray[ c * 3 + 0 ] = _vC.x;\n\t\tmodifiedAttributeArray[ c * 3 + 1 ] = _vC.y;\n\t\tmodifiedAttributeArray[ c * 3 + 2 ] = _vC.z;\n\n\t}\n\n\tconst geometry = object.geometry;\n\tconst material = object.material;\n\n\tlet a, b, c;\n\tconst index = geometry.index;\n\tconst positionAttribute = geometry.attributes.position;\n\tconst morphPosition = geometry.morphAttributes.position;\n\tconst morphTargetsRelative = geometry.morphTargetsRelative;\n\tconst normalAttribute = geometry.attributes.normal;\n\tconst morphNormal = geometry.morphAttributes.position;\n\n\tconst groups = geometry.groups;\n\tconst drawRange = geometry.drawRange;\n\tlet i, j, il, jl;\n\tlet group;\n\tlet start, end;\n\n\tconst modifiedPosition = new Float32Array( positionAttribute.count * positionAttribute.itemSize );\n\tconst modifiedNormal = new Float32Array( normalAttribute.count * normalAttribute.itemSize );\n\n\tif ( index !== null ) {\n\n\t\t// indexed buffer geometry\n\n\t\tif ( Array.isArray( material ) ) {\n\n\t\t\tfor ( i = 0, il = groups.length; i < il; i ++ ) {\n\n\t\t\t\tgroup = groups[ i ];\n\n\t\t\t\tstart = Math.max( group.start, drawRange.start );\n\t\t\t\tend = Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( j = start, jl = end; j < jl; j += 3 ) {\n\n\t\t\t\t\ta = index.getX( j );\n\t\t\t\t\tb = index.getX( j + 1 );\n\t\t\t\t\tc = index.getX( j + 2 );\n\n\t\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\t\tobject,\n\t\t\t\t\t\tpositionAttribute,\n\t\t\t\t\t\tmorphPosition,\n\t\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\t\ta, b, c,\n\t\t\t\t\t\tmodifiedPosition\n\t\t\t\t\t);\n\n\t\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\t\tobject,\n\t\t\t\t\t\tnormalAttribute,\n\t\t\t\t\t\tmorphNormal,\n\t\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\t\ta, b, c,\n\t\t\t\t\t\tmodifiedNormal\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tstart = Math.max( 0, drawRange.start );\n\t\t\tend = Math.min( index.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\tfor ( i = start, il = end; i < il; i += 3 ) {\n\n\t\t\t\ta = index.getX( i );\n\t\t\t\tb = index.getX( i + 1 );\n\t\t\t\tc = index.getX( i + 2 );\n\n\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\tobject,\n\t\t\t\t\tpositionAttribute,\n\t\t\t\t\tmorphPosition,\n\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\ta, b, c,\n\t\t\t\t\tmodifiedPosition\n\t\t\t\t);\n\n\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\tobject,\n\t\t\t\t\tnormalAttribute,\n\t\t\t\t\tmorphNormal,\n\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\ta, b, c,\n\t\t\t\t\tmodifiedNormal\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t} else {\n\n\t\t// non-indexed buffer geometry\n\n\t\tif ( Array.isArray( material ) ) {\n\n\t\t\tfor ( i = 0, il = groups.length; i < il; i ++ ) {\n\n\t\t\t\tgroup = groups[ i ];\n\n\t\t\t\tstart = Math.max( group.start, drawRange.start );\n\t\t\t\tend = Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( j = start, jl = end; j < jl; j += 3 ) {\n\n\t\t\t\t\ta = j;\n\t\t\t\t\tb = j + 1;\n\t\t\t\t\tc = j + 2;\n\n\t\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\t\tobject,\n\t\t\t\t\t\tpositionAttribute,\n\t\t\t\t\t\tmorphPosition,\n\t\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\t\ta, b, c,\n\t\t\t\t\t\tmodifiedPosition\n\t\t\t\t\t);\n\n\t\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\t\tobject,\n\t\t\t\t\t\tnormalAttribute,\n\t\t\t\t\t\tmorphNormal,\n\t\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\t\ta, b, c,\n\t\t\t\t\t\tmodifiedNormal\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tstart = Math.max( 0, drawRange.start );\n\t\t\tend = Math.min( positionAttribute.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\tfor ( i = start, il = end; i < il; i += 3 ) {\n\n\t\t\t\ta = i;\n\t\t\t\tb = i + 1;\n\t\t\t\tc = i + 2;\n\n\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\tobject,\n\t\t\t\t\tpositionAttribute,\n\t\t\t\t\tmorphPosition,\n\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\ta, b, c,\n\t\t\t\t\tmodifiedPosition\n\t\t\t\t);\n\n\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\tobject,\n\t\t\t\t\tnormalAttribute,\n\t\t\t\t\tmorphNormal,\n\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\ta, b, c,\n\t\t\t\t\tmodifiedNormal\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tconst morphedPositionAttribute = new Float32BufferAttribute( modifiedPosition, 3 );\n\tconst morphedNormalAttribute = new Float32BufferAttribute( modifiedNormal, 3 );\n\n\treturn {\n\n\t\tpositionAttribute: positionAttribute,\n\t\tnormalAttribute: normalAttribute,\n\t\tmorphedPositionAttribute: morphedPositionAttribute,\n\t\tmorphedNormalAttribute: morphedNormalAttribute\n\n\t};\n\n}\n\nfunction mergeGroups( geometry ) {\n\n\tif ( geometry.groups.length === 0 ) {\n\n\t\tconsole.warn( 'THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge.' );\n\t\treturn geometry;\n\n\t}\n\n\tlet groups = geometry.groups;\n\n\t// sort groups by material index\n\n\tgroups = groups.sort( ( a, b ) => {\n\n\t\tif ( a.materialIndex !== b.materialIndex ) return a.materialIndex - b.materialIndex;\n\n\t\treturn a.start - b.start;\n\n\t} );\n\n\t// create index for non-indexed geometries\n\n\tif ( geometry.getIndex() === null ) {\n\n\t\tconst positionAttribute = geometry.getAttribute( 'position' );\n\t\tconst indices = [];\n\n\t\tfor ( let i = 0; i < positionAttribute.count; i += 3 ) {\n\n\t\t\tindices.push( i, i + 1, i + 2 );\n\n\t\t}\n\n\t\tgeometry.setIndex( indices );\n\n\t}\n\n\t// sort index\n\n\tconst index = geometry.getIndex();\n\n\tconst newIndices = [];\n\n\tfor ( let i = 0; i < groups.length; i ++ ) {\n\n\t\tconst group = groups[ i ];\n\n\t\tconst groupStart = group.start;\n\t\tconst groupLength = groupStart + group.count;\n\n\t\tfor ( let j = groupStart; j < groupLength; j ++ ) {\n\n\t\t\tnewIndices.push( index.getX( j ) );\n\n\t\t}\n\n\t}\n\n\tgeometry.dispose(); // Required to force buffer recreation\n\tgeometry.setIndex( newIndices );\n\n\t// update groups indices\n\n\tlet start = 0;\n\n\tfor ( let i = 0; i < groups.length; i ++ ) {\n\n\t\tconst group = groups[ i ];\n\n\t\tgroup.start = start;\n\t\tstart += group.count;\n\n\t}\n\n\t// merge groups\n\n\tlet currentGroup = groups[ 0 ];\n\n\tgeometry.groups = [ currentGroup ];\n\n\tfor ( let i = 1; i < groups.length; i ++ ) {\n\n\t\tconst group = groups[ i ];\n\n\t\tif ( currentGroup.materialIndex === group.materialIndex ) {\n\n\t\t\tcurrentGroup.count += group.count;\n\n\t\t} else {\n\n\t\t\tcurrentGroup = group;\n\t\t\tgeometry.groups.push( currentGroup );\n\n\t\t}\n\n\t}\n\n\treturn geometry;\n\n}\n\n\n/**\n * Modifies the supplied geometry if it is non-indexed, otherwise creates a new,\n * non-indexed geometry. Returns the geometry with smooth normals everywhere except\n * faces that meet at an angle greater than the crease angle.\n *\n * @param {BufferGeometry} geometry\n * @param {number} [creaseAngle]\n * @return {BufferGeometry}\n */\nfunction toCreasedNormals( geometry, creaseAngle = Math.PI / 3 /* 60 degrees */ ) {\n\n\tconst creaseDot = Math.cos( creaseAngle );\n\tconst hashMultiplier = ( 1 + 1e-10 ) * 1e2;\n\n\t// reusable vectors\n\tconst verts = [ new Vector3(), new Vector3(), new Vector3() ];\n\tconst tempVec1 = new Vector3();\n\tconst tempVec2 = new Vector3();\n\tconst tempNorm = new Vector3();\n\tconst tempNorm2 = new Vector3();\n\n\t// hashes a vector\n\tfunction hashVertex( v ) {\n\n\t\tconst x = ~ ~ ( v.x * hashMultiplier );\n\t\tconst y = ~ ~ ( v.y * hashMultiplier );\n\t\tconst z = ~ ~ ( v.z * hashMultiplier );\n\t\treturn `${x},${y},${z}`;\n\n\t}\n\n\t// BufferGeometry.toNonIndexed() warns if the geometry is non-indexed\n\t// and returns the original geometry\n\tconst resultGeometry = geometry.index ? geometry.toNonIndexed() : geometry;\n\tconst posAttr = resultGeometry.attributes.position;\n\tconst vertexMap = {};\n\n\t// find all the normals shared by commonly located vertices\n\tfor ( let i = 0, l = posAttr.count / 3; i < l; i ++ ) {\n\n\t\tconst i3 = 3 * i;\n\t\tconst a = verts[ 0 ].fromBufferAttribute( posAttr, i3 + 0 );\n\t\tconst b = verts[ 1 ].fromBufferAttribute( posAttr, i3 + 1 );\n\t\tconst c = verts[ 2 ].fromBufferAttribute( posAttr, i3 + 2 );\n\n\t\ttempVec1.subVectors( c, b );\n\t\ttempVec2.subVectors( a, b );\n\n\t\t// add the normal to the map for all vertices\n\t\tconst normal = new Vector3().crossVectors( tempVec1, tempVec2 ).normalize();\n\t\tfor ( let n = 0; n < 3; n ++ ) {\n\n\t\t\tconst vert = verts[ n ];\n\t\t\tconst hash = hashVertex( vert );\n\t\t\tif ( ! ( hash in vertexMap ) ) {\n\n\t\t\t\tvertexMap[ hash ] = [];\n\n\t\t\t}\n\n\t\t\tvertexMap[ hash ].push( normal );\n\n\t\t}\n\n\t}\n\n\t// average normals from all vertices that share a common location if they are within the\n\t// provided crease threshold\n\tconst normalArray = new Float32Array( posAttr.count * 3 );\n\tconst normAttr = new BufferAttribute( normalArray, 3, false );\n\tfor ( let i = 0, l = posAttr.count / 3; i < l; i ++ ) {\n\n\t\t// get the face normal for this vertex\n\t\tconst i3 = 3 * i;\n\t\tconst a = verts[ 0 ].fromBufferAttribute( posAttr, i3 + 0 );\n\t\tconst b = verts[ 1 ].fromBufferAttribute( posAttr, i3 + 1 );\n\t\tconst c = verts[ 2 ].fromBufferAttribute( posAttr, i3 + 2 );\n\n\t\ttempVec1.subVectors( c, b );\n\t\ttempVec2.subVectors( a, b );\n\n\t\ttempNorm.crossVectors( tempVec1, tempVec2 ).normalize();\n\n\t\t// average all normals that meet the threshold and set the normal value\n\t\tfor ( let n = 0; n < 3; n ++ ) {\n\n\t\t\tconst vert = verts[ n ];\n\t\t\tconst hash = hashVertex( vert );\n\t\t\tconst otherNormals = vertexMap[ hash ];\n\t\t\ttempNorm2.set( 0, 0, 0 );\n\n\t\t\tfor ( let k = 0, lk = otherNormals.length; k < lk; k ++ ) {\n\n\t\t\t\tconst otherNorm = otherNormals[ k ];\n\t\t\t\tif ( tempNorm.dot( otherNorm ) > creaseDot ) {\n\n\t\t\t\t\ttempNorm2.add( otherNorm );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\ttempNorm2.normalize();\n\t\t\tnormAttr.setXYZ( i3 + n, tempNorm2.x, tempNorm2.y, tempNorm2.z );\n\n\t\t}\n\n\t}\n\n\tresultGeometry.setAttribute( 'normal', normAttr );\n\treturn resultGeometry;\n\n}\n\nexport {\n\tcomputeMikkTSpaceTangents,\n\tmergeGeometries,\n\tmergeAttributes,\n\tinterleaveAttributes,\n\testimateBytesUsed,\n\tmergeVertices,\n\ttoTrianglesDrawMode,\n\tcomputeMorphedAttributes,\n\tmergeGroups,\n\ttoCreasedNormals\n};\n","import {\n\tAnimationClip,\n\tBone,\n\tBox3,\n\tBufferAttribute,\n\tBufferGeometry,\n\tClampToEdgeWrapping,\n\tColor,\n\tColorManagement,\n\tDirectionalLight,\n\tDoubleSide,\n\tFileLoader,\n\tFrontSide,\n\tGroup,\n\tImageBitmapLoader,\n\tInstancedMesh,\n\tInterleavedBuffer,\n\tInterleavedBufferAttribute,\n\tInterpolant,\n\tInterpolateDiscrete,\n\tInterpolateLinear,\n\tLine,\n\tLineBasicMaterial,\n\tLineLoop,\n\tLineSegments,\n\tLinearFilter,\n\tLinearMipmapLinearFilter,\n\tLinearMipmapNearestFilter,\n\tLinearSRGBColorSpace,\n\tLoader,\n\tLoaderUtils,\n\tMaterial,\n\tMathUtils,\n\tMatrix4,\n\tMesh,\n\tMeshBasicMaterial,\n\tMeshPhysicalMaterial,\n\tMeshStandardMaterial,\n\tMirroredRepeatWrapping,\n\tNearestFilter,\n\tNearestMipmapLinearFilter,\n\tNearestMipmapNearestFilter,\n\tNumberKeyframeTrack,\n\tObject3D,\n\tOrthographicCamera,\n\tPerspectiveCamera,\n\tPointLight,\n\tPoints,\n\tPointsMaterial,\n\tPropertyBinding,\n\tQuaternion,\n\tQuaternionKeyframeTrack,\n\tRepeatWrapping,\n\tSkeleton,\n\tSkinnedMesh,\n\tSphere,\n\tSpotLight,\n\tTexture,\n\tTextureLoader,\n\tTriangleFanDrawMode,\n\tTriangleStripDrawMode,\n\tVector2,\n\tVector3,\n\tVectorKeyframeTrack,\n\tSRGBColorSpace,\n\tInstancedBufferAttribute\n} from 'three';\nimport { toTrianglesDrawMode } from '../utils/BufferGeometryUtils.js';\n\nclass GLTFLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.dracoLoader = null;\n\t\tthis.ktx2Loader = null;\n\t\tthis.meshoptDecoder = null;\n\n\t\tthis.pluginCallbacks = [];\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsClearcoatExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsDispersionExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureBasisUExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureWebPExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureAVIFExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsSheenExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsTransmissionExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsVolumeExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsIorExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsEmissiveStrengthExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsSpecularExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsIridescenceExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsAnisotropyExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsBumpExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFLightsExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMeshoptCompression( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMeshGpuInstancing( parser );\n\n\t\t} );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tlet resourcePath;\n\n\t\tif ( this.resourcePath !== '' ) {\n\n\t\t\tresourcePath = this.resourcePath;\n\n\t\t} else if ( this.path !== '' ) {\n\n\t\t\t// If a base path is set, resources will be relative paths from that plus the relative path of the gltf file\n\t\t\t// Example  path = 'https://my-cnd-server.com/', url = 'assets/models/model.gltf'\n\t\t\t// resourcePath = 'https://my-cnd-server.com/assets/models/'\n\t\t\t// referenced resource 'model.bin' will be loaded from 'https://my-cnd-server.com/assets/models/model.bin'\n\t\t\t// referenced resource '../textures/texture.png' will be loaded from 'https://my-cnd-server.com/assets/textures/texture.png'\n\t\t\tconst relativeUrl = LoaderUtils.extractUrlBase( url );\n\t\t\tresourcePath = LoaderUtils.resolveURL( relativeUrl, this.path );\n\n\t\t} else {\n\n\t\t\tresourcePath = LoaderUtils.extractUrlBase( url );\n\n\t\t}\n\n\t\t// Tells the LoadingManager to track an extra item, which resolves after\n\t\t// the model is fully loaded. This means the count of items loaded will\n\t\t// be incorrect, but ensures manager.onLoad() does not fire early.\n\t\tthis.manager.itemStart( url );\n\n\t\tconst _onError = function ( e ) {\n\n\t\t\tif ( onError ) {\n\n\t\t\t\tonError( e );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( e );\n\n\t\t\t}\n\n\t\t\tscope.manager.itemError( url );\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t};\n\n\t\tconst loader = new FileLoader( this.manager );\n\n\t\tloader.setPath( this.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\n\t\tloader.load( url, function ( data ) {\n\n\t\t\ttry {\n\n\t\t\t\tscope.parse( data, resourcePath, function ( gltf ) {\n\n\t\t\t\t\tonLoad( gltf );\n\n\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t}, _onError );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\t_onError( e );\n\n\t\t\t}\n\n\t\t}, onProgress, _onError );\n\n\t}\n\n\tsetDRACOLoader( dracoLoader ) {\n\n\t\tthis.dracoLoader = dracoLoader;\n\t\treturn this;\n\n\t}\n\n\tsetKTX2Loader( ktx2Loader ) {\n\n\t\tthis.ktx2Loader = ktx2Loader;\n\t\treturn this;\n\n\t}\n\n\tsetMeshoptDecoder( meshoptDecoder ) {\n\n\t\tthis.meshoptDecoder = meshoptDecoder;\n\t\treturn this;\n\n\t}\n\n\tregister( callback ) {\n\n\t\tif ( this.pluginCallbacks.indexOf( callback ) === - 1 ) {\n\n\t\t\tthis.pluginCallbacks.push( callback );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tunregister( callback ) {\n\n\t\tif ( this.pluginCallbacks.indexOf( callback ) !== - 1 ) {\n\n\t\t\tthis.pluginCallbacks.splice( this.pluginCallbacks.indexOf( callback ), 1 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tparse( data, path, onLoad, onError ) {\n\n\t\tlet json;\n\t\tconst extensions = {};\n\t\tconst plugins = {};\n\t\tconst textDecoder = new TextDecoder();\n\n\t\tif ( typeof data === 'string' ) {\n\n\t\t\tjson = JSON.parse( data );\n\n\t\t} else if ( data instanceof ArrayBuffer ) {\n\n\t\t\tconst magic = textDecoder.decode( new Uint8Array( data, 0, 4 ) );\n\n\t\t\tif ( magic === BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\t\ttry {\n\n\t\t\t\t\textensions[ EXTENSIONS.KHR_BINARY_GLTF ] = new GLTFBinaryExtension( data );\n\n\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\tif ( onError ) onError( error );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tjson = JSON.parse( extensions[ EXTENSIONS.KHR_BINARY_GLTF ].content );\n\n\t\t\t} else {\n\n\t\t\t\tjson = JSON.parse( textDecoder.decode( data ) );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tjson = data;\n\n\t\t}\n\n\t\tif ( json.asset === undefined || json.asset.version[ 0 ] < 2 ) {\n\n\t\t\tif ( onError ) onError( new Error( 'THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.' ) );\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst parser = new GLTFParser( json, {\n\n\t\t\tpath: path || this.resourcePath || '',\n\t\t\tcrossOrigin: this.crossOrigin,\n\t\t\trequestHeader: this.requestHeader,\n\t\t\tmanager: this.manager,\n\t\t\tktx2Loader: this.ktx2Loader,\n\t\t\tmeshoptDecoder: this.meshoptDecoder\n\n\t\t} );\n\n\t\tparser.fileLoader.setRequestHeader( this.requestHeader );\n\n\t\tfor ( let i = 0; i < this.pluginCallbacks.length; i ++ ) {\n\n\t\t\tconst plugin = this.pluginCallbacks[ i ]( parser );\n\n\t\t\tif ( ! plugin.name ) console.error( 'THREE.GLTFLoader: Invalid plugin found: missing name' );\n\n\t\t\tplugins[ plugin.name ] = plugin;\n\n\t\t\t// Workaround to avoid determining as unknown extension\n\t\t\t// in addUnknownExtensionsToUserData().\n\t\t\t// Remove this workaround if we move all the existing\n\t\t\t// extension handlers to plugin system\n\t\t\textensions[ plugin.name ] = true;\n\n\t\t}\n\n\t\tif ( json.extensionsUsed ) {\n\n\t\t\tfor ( let i = 0; i < json.extensionsUsed.length; ++ i ) {\n\n\t\t\t\tconst extensionName = json.extensionsUsed[ i ];\n\t\t\t\tconst extensionsRequired = json.extensionsRequired || [];\n\n\t\t\t\tswitch ( extensionName ) {\n\n\t\t\t\t\tcase EXTENSIONS.KHR_MATERIALS_UNLIT:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFMaterialsUnlitExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFDracoMeshCompressionExtension( json, this.dracoLoader );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_TEXTURE_TRANSFORM:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFTextureTransformExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_MESH_QUANTIZATION:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFMeshQuantizationExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tif ( extensionsRequired.indexOf( extensionName ) >= 0 && plugins[ extensionName ] === undefined ) {\n\n\t\t\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Unknown extension \"' + extensionName + '\".' );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tparser.setExtensions( extensions );\n\t\tparser.setPlugins( plugins );\n\t\tparser.parse( onLoad, onError );\n\n\t}\n\n\tparseAsync( data, path ) {\n\n\t\tconst scope = this;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tscope.parse( data, path, resolve, reject );\n\n\t\t} );\n\n\t}\n\n}\n\n/* GLTFREGISTRY */\n\nfunction GLTFRegistry() {\n\n\tlet objects = {};\n\n\treturn\t{\n\n\t\tget: function ( key ) {\n\n\t\t\treturn objects[ key ];\n\n\t\t},\n\n\t\tadd: function ( key, object ) {\n\n\t\t\tobjects[ key ] = object;\n\n\t\t},\n\n\t\tremove: function ( key ) {\n\n\t\t\tdelete objects[ key ];\n\n\t\t},\n\n\t\tremoveAll: function () {\n\n\t\t\tobjects = {};\n\n\t\t}\n\n\t};\n\n}\n\n/*********************************/\n/********** EXTENSIONS ***********/\n/*********************************/\n\nconst EXTENSIONS = {\n\tKHR_BINARY_GLTF: 'KHR_binary_glTF',\n\tKHR_DRACO_MESH_COMPRESSION: 'KHR_draco_mesh_compression',\n\tKHR_LIGHTS_PUNCTUAL: 'KHR_lights_punctual',\n\tKHR_MATERIALS_CLEARCOAT: 'KHR_materials_clearcoat',\n\tKHR_MATERIALS_DISPERSION: 'KHR_materials_dispersion',\n\tKHR_MATERIALS_IOR: 'KHR_materials_ior',\n\tKHR_MATERIALS_SHEEN: 'KHR_materials_sheen',\n\tKHR_MATERIALS_SPECULAR: 'KHR_materials_specular',\n\tKHR_MATERIALS_TRANSMISSION: 'KHR_materials_transmission',\n\tKHR_MATERIALS_IRIDESCENCE: 'KHR_materials_iridescence',\n\tKHR_MATERIALS_ANISOTROPY: 'KHR_materials_anisotropy',\n\tKHR_MATERIALS_UNLIT: 'KHR_materials_unlit',\n\tKHR_MATERIALS_VOLUME: 'KHR_materials_volume',\n\tKHR_TEXTURE_BASISU: 'KHR_texture_basisu',\n\tKHR_TEXTURE_TRANSFORM: 'KHR_texture_transform',\n\tKHR_MESH_QUANTIZATION: 'KHR_mesh_quantization',\n\tKHR_MATERIALS_EMISSIVE_STRENGTH: 'KHR_materials_emissive_strength',\n\tEXT_MATERIALS_BUMP: 'EXT_materials_bump',\n\tEXT_TEXTURE_WEBP: 'EXT_texture_webp',\n\tEXT_TEXTURE_AVIF: 'EXT_texture_avif',\n\tEXT_MESHOPT_COMPRESSION: 'EXT_meshopt_compression',\n\tEXT_MESH_GPU_INSTANCING: 'EXT_mesh_gpu_instancing'\n};\n\n/**\n * Punctual Lights Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_lights_punctual\n */\nclass GLTFLightsExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_LIGHTS_PUNCTUAL;\n\n\t\t// Object3D instance caches\n\t\tthis.cache = { refs: {}, uses: {} };\n\n\t}\n\n\t_markDefs() {\n\n\t\tconst parser = this.parser;\n\t\tconst nodeDefs = this.parser.json.nodes || [];\n\n\t\tfor ( let nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\n\n\t\t\tconst nodeDef = nodeDefs[ nodeIndex ];\n\n\t\t\tif ( nodeDef.extensions\n\t\t\t\t\t&& nodeDef.extensions[ this.name ]\n\t\t\t\t\t&& nodeDef.extensions[ this.name ].light !== undefined ) {\n\n\t\t\t\tparser._addNodeRef( this.cache, nodeDef.extensions[ this.name ].light );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_loadLight( lightIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst cacheKey = 'light:' + lightIndex;\n\t\tlet dependency = parser.cache.get( cacheKey );\n\n\t\tif ( dependency ) return dependency;\n\n\t\tconst json = parser.json;\n\t\tconst extensions = ( json.extensions && json.extensions[ this.name ] ) || {};\n\t\tconst lightDefs = extensions.lights || [];\n\t\tconst lightDef = lightDefs[ lightIndex ];\n\t\tlet lightNode;\n\n\t\tconst color = new Color( 0xffffff );\n\n\t\tif ( lightDef.color !== undefined ) color.setRGB( lightDef.color[ 0 ], lightDef.color[ 1 ], lightDef.color[ 2 ], LinearSRGBColorSpace );\n\n\t\tconst range = lightDef.range !== undefined ? lightDef.range : 0;\n\n\t\tswitch ( lightDef.type ) {\n\n\t\t\tcase 'directional':\n\t\t\t\tlightNode = new DirectionalLight( color );\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tcase 'point':\n\t\t\t\tlightNode = new PointLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\tbreak;\n\n\t\t\tcase 'spot':\n\t\t\t\tlightNode = new SpotLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\t// Handle spotlight properties.\n\t\t\t\tlightDef.spot = lightDef.spot || {};\n\t\t\t\tlightDef.spot.innerConeAngle = lightDef.spot.innerConeAngle !== undefined ? lightDef.spot.innerConeAngle : 0;\n\t\t\t\tlightDef.spot.outerConeAngle = lightDef.spot.outerConeAngle !== undefined ? lightDef.spot.outerConeAngle : Math.PI / 4.0;\n\t\t\t\tlightNode.angle = lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.penumbra = 1.0 - lightDef.spot.innerConeAngle / lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Unexpected light type: ' + lightDef.type );\n\n\t\t}\n\n\t\t// Some lights (e.g. spot) default to a position other than the origin. Reset the position\n\t\t// here, because node-level parsing will only override position if explicitly specified.\n\t\tlightNode.position.set( 0, 0, 0 );\n\n\t\tlightNode.decay = 2;\n\n\t\tassignExtrasToUserData( lightNode, lightDef );\n\n\t\tif ( lightDef.intensity !== undefined ) lightNode.intensity = lightDef.intensity;\n\n\t\tlightNode.name = parser.createUniqueName( lightDef.name || ( 'light_' + lightIndex ) );\n\n\t\tdependency = Promise.resolve( lightNode );\n\n\t\tparser.cache.add( cacheKey, dependency );\n\n\t\treturn dependency;\n\n\t}\n\n\tgetDependency( type, index ) {\n\n\t\tif ( type !== 'light' ) return;\n\n\t\treturn this._loadLight( index );\n\n\t}\n\n\tcreateNodeAttachment( nodeIndex ) {\n\n\t\tconst self = this;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\t\tconst lightDef = ( nodeDef.extensions && nodeDef.extensions[ this.name ] ) || {};\n\t\tconst lightIndex = lightDef.light;\n\n\t\tif ( lightIndex === undefined ) return null;\n\n\t\treturn this._loadLight( lightIndex ).then( function ( light ) {\n\n\t\t\treturn parser._getNodeRef( self.cache, lightIndex, light );\n\n\t\t} );\n\n\t}\n\n}\n\n/**\n * Unlit Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_unlit\n */\nclass GLTFMaterialsUnlitExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_UNLIT;\n\n\t}\n\n\tgetMaterialType() {\n\n\t\treturn MeshBasicMaterial;\n\n\t}\n\n\textendParams( materialParams, materialDef, parser ) {\n\n\t\tconst pending = [];\n\n\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\tmaterialParams.opacity = 1.0;\n\n\t\tconst metallicRoughness = materialDef.pbrMetallicRoughness;\n\n\t\tif ( metallicRoughness ) {\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tconst array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.setRGB( array[ 0 ], array[ 1 ], array[ 2 ], LinearSRGBColorSpace );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture, SRGBColorSpace ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials Emissive Strength Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/blob/5768b3ce0ef32bc39cdf1bef10b948586635ead3/extensions/2.0/Khronos/KHR_materials_emissive_strength/README.md\n */\nclass GLTFMaterialsEmissiveStrengthExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_EMISSIVE_STRENGTH;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst emissiveStrength = materialDef.extensions[ this.name ].emissiveStrength;\n\n\t\tif ( emissiveStrength !== undefined ) {\n\n\t\t\tmaterialParams.emissiveIntensity = emissiveStrength;\n\n\t\t}\n\n\t\treturn Promise.resolve();\n\n\t}\n\n}\n\n/**\n * Clearcoat Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_clearcoat\n */\nclass GLTFMaterialsClearcoatExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_CLEARCOAT;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.clearcoatFactor !== undefined ) {\n\n\t\t\tmaterialParams.clearcoat = extension.clearcoatFactor;\n\n\t\t}\n\n\t\tif ( extension.clearcoatTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatMap', extension.clearcoatTexture ) );\n\n\t\t}\n\n\t\tif ( extension.clearcoatRoughnessFactor !== undefined ) {\n\n\t\t\tmaterialParams.clearcoatRoughness = extension.clearcoatRoughnessFactor;\n\n\t\t}\n\n\t\tif ( extension.clearcoatRoughnessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatRoughnessMap', extension.clearcoatRoughnessTexture ) );\n\n\t\t}\n\n\t\tif ( extension.clearcoatNormalTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatNormalMap', extension.clearcoatNormalTexture ) );\n\n\t\t\tif ( extension.clearcoatNormalTexture.scale !== undefined ) {\n\n\t\t\t\tconst scale = extension.clearcoatNormalTexture.scale;\n\n\t\t\t\tmaterialParams.clearcoatNormalScale = new Vector2( scale, scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials dispersion Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/main/extensions/2.0/Khronos/KHR_materials_dispersion\n */\nclass GLTFMaterialsDispersionExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_DISPERSION;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.dispersion = extension.dispersion !== undefined ? extension.dispersion : 0;\n\n\t\treturn Promise.resolve();\n\n\t}\n\n}\n\n/**\n * Iridescence Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_iridescence\n */\nclass GLTFMaterialsIridescenceExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_IRIDESCENCE;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.iridescenceFactor !== undefined ) {\n\n\t\t\tmaterialParams.iridescence = extension.iridescenceFactor;\n\n\t\t}\n\n\t\tif ( extension.iridescenceTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'iridescenceMap', extension.iridescenceTexture ) );\n\n\t\t}\n\n\t\tif ( extension.iridescenceIor !== undefined ) {\n\n\t\t\tmaterialParams.iridescenceIOR = extension.iridescenceIor;\n\n\t\t}\n\n\t\tif ( materialParams.iridescenceThicknessRange === undefined ) {\n\n\t\t\tmaterialParams.iridescenceThicknessRange = [ 100, 400 ];\n\n\t\t}\n\n\t\tif ( extension.iridescenceThicknessMinimum !== undefined ) {\n\n\t\t\tmaterialParams.iridescenceThicknessRange[ 0 ] = extension.iridescenceThicknessMinimum;\n\n\t\t}\n\n\t\tif ( extension.iridescenceThicknessMaximum !== undefined ) {\n\n\t\t\tmaterialParams.iridescenceThicknessRange[ 1 ] = extension.iridescenceThicknessMaximum;\n\n\t\t}\n\n\t\tif ( extension.iridescenceThicknessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'iridescenceThicknessMap', extension.iridescenceThicknessTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Sheen Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/main/extensions/2.0/Khronos/KHR_materials_sheen\n */\nclass GLTFMaterialsSheenExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_SHEEN;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tmaterialParams.sheenColor = new Color( 0, 0, 0 );\n\t\tmaterialParams.sheenRoughness = 0;\n\t\tmaterialParams.sheen = 1;\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.sheenColorFactor !== undefined ) {\n\n\t\t\tconst colorFactor = extension.sheenColorFactor;\n\t\t\tmaterialParams.sheenColor.setRGB( colorFactor[ 0 ], colorFactor[ 1 ], colorFactor[ 2 ], LinearSRGBColorSpace );\n\n\t\t}\n\n\t\tif ( extension.sheenRoughnessFactor !== undefined ) {\n\n\t\t\tmaterialParams.sheenRoughness = extension.sheenRoughnessFactor;\n\n\t\t}\n\n\t\tif ( extension.sheenColorTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'sheenColorMap', extension.sheenColorTexture, SRGBColorSpace ) );\n\n\t\t}\n\n\t\tif ( extension.sheenRoughnessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'sheenRoughnessMap', extension.sheenRoughnessTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Transmission Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_transmission\n * Draft: https://github.com/KhronosGroup/glTF/pull/1698\n */\nclass GLTFMaterialsTransmissionExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_TRANSMISSION;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.transmissionFactor !== undefined ) {\n\n\t\t\tmaterialParams.transmission = extension.transmissionFactor;\n\n\t\t}\n\n\t\tif ( extension.transmissionTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'transmissionMap', extension.transmissionTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials Volume Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_volume\n */\nclass GLTFMaterialsVolumeExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_VOLUME;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.thickness = extension.thicknessFactor !== undefined ? extension.thicknessFactor : 0;\n\n\t\tif ( extension.thicknessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'thicknessMap', extension.thicknessTexture ) );\n\n\t\t}\n\n\t\tmaterialParams.attenuationDistance = extension.attenuationDistance || Infinity;\n\n\t\tconst colorArray = extension.attenuationColor || [ 1, 1, 1 ];\n\t\tmaterialParams.attenuationColor = new Color().setRGB( colorArray[ 0 ], colorArray[ 1 ], colorArray[ 2 ], LinearSRGBColorSpace );\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials ior Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_ior\n */\nclass GLTFMaterialsIorExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_IOR;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.ior = extension.ior !== undefined ? extension.ior : 1.5;\n\n\t\treturn Promise.resolve();\n\n\t}\n\n}\n\n/**\n * Materials specular Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_specular\n */\nclass GLTFMaterialsSpecularExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_SPECULAR;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.specularIntensity = extension.specularFactor !== undefined ? extension.specularFactor : 1.0;\n\n\t\tif ( extension.specularTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'specularIntensityMap', extension.specularTexture ) );\n\n\t\t}\n\n\t\tconst colorArray = extension.specularColorFactor || [ 1, 1, 1 ];\n\t\tmaterialParams.specularColor = new Color().setRGB( colorArray[ 0 ], colorArray[ 1 ], colorArray[ 2 ], LinearSRGBColorSpace );\n\n\t\tif ( extension.specularColorTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'specularColorMap', extension.specularColorTexture, SRGBColorSpace ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n\n/**\n * Materials bump Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/EXT_materials_bump\n */\nclass GLTFMaterialsBumpExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.EXT_MATERIALS_BUMP;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.bumpScale = extension.bumpFactor !== undefined ? extension.bumpFactor : 1.0;\n\n\t\tif ( extension.bumpTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'bumpMap', extension.bumpTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials anisotropy Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_anisotropy\n */\nclass GLTFMaterialsAnisotropyExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_ANISOTROPY;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.anisotropyStrength !== undefined ) {\n\n\t\t\tmaterialParams.anisotropy = extension.anisotropyStrength;\n\n\t\t}\n\n\t\tif ( extension.anisotropyRotation !== undefined ) {\n\n\t\t\tmaterialParams.anisotropyRotation = extension.anisotropyRotation;\n\n\t\t}\n\n\t\tif ( extension.anisotropyTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'anisotropyMap', extension.anisotropyTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * BasisU Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_basisu\n */\nclass GLTFTextureBasisUExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_TEXTURE_BASISU;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ this.name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ this.name ];\n\t\tconst loader = parser.options.ktx2Loader;\n\n\t\tif ( ! loader ) {\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( this.name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures' );\n\n\t\t\t} else {\n\n\t\t\t\t// Assumes that the extension is optional and that a fallback texture is present\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn parser.loadTextureImage( textureIndex, extension.source, loader );\n\n\t}\n\n}\n\n/**\n * WebP Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_texture_webp\n */\nclass GLTFTextureWebPExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.EXT_TEXTURE_WEBP;\n\t\tthis.isSupported = null;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst name = this.name;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ name ];\n\t\tconst source = json.images[ extension.source ];\n\n\t\tlet loader = parser.textureLoader;\n\t\tif ( source.uri ) {\n\n\t\t\tconst handler = parser.options.manager.getHandler( source.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.detectSupport().then( function ( isSupported ) {\n\n\t\t\tif ( isSupported ) return parser.loadTextureImage( textureIndex, extension.source, loader );\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: WebP required by asset but unsupported.' );\n\n\t\t\t}\n\n\t\t\t// Fall back to PNG or JPEG.\n\t\t\treturn parser.loadTexture( textureIndex );\n\n\t\t} );\n\n\t}\n\n\tdetectSupport() {\n\n\t\tif ( ! this.isSupported ) {\n\n\t\t\tthis.isSupported = new Promise( function ( resolve ) {\n\n\t\t\t\tconst image = new Image();\n\n\t\t\t\t// Lossy test image. Support for lossy images doesn't guarantee support for all\n\t\t\t\t// WebP images, unfortunately.\n\t\t\t\timage.src = 'data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA';\n\n\t\t\t\timage.onload = image.onerror = function () {\n\n\t\t\t\t\tresolve( image.height === 1 );\n\n\t\t\t\t};\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn this.isSupported;\n\n\t}\n\n}\n\n/**\n * AVIF Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_texture_avif\n */\nclass GLTFTextureAVIFExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.EXT_TEXTURE_AVIF;\n\t\tthis.isSupported = null;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst name = this.name;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ name ];\n\t\tconst source = json.images[ extension.source ];\n\n\t\tlet loader = parser.textureLoader;\n\t\tif ( source.uri ) {\n\n\t\t\tconst handler = parser.options.manager.getHandler( source.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.detectSupport().then( function ( isSupported ) {\n\n\t\t\tif ( isSupported ) return parser.loadTextureImage( textureIndex, extension.source, loader );\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: AVIF required by asset but unsupported.' );\n\n\t\t\t}\n\n\t\t\t// Fall back to PNG or JPEG.\n\t\t\treturn parser.loadTexture( textureIndex );\n\n\t\t} );\n\n\t}\n\n\tdetectSupport() {\n\n\t\tif ( ! this.isSupported ) {\n\n\t\t\tthis.isSupported = new Promise( function ( resolve ) {\n\n\t\t\t\tconst image = new Image();\n\n\t\t\t\t// Lossy test image.\n\t\t\t\timage.src = 'data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=';\n\t\t\t\timage.onload = image.onerror = function () {\n\n\t\t\t\t\tresolve( image.height === 1 );\n\n\t\t\t\t};\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn this.isSupported;\n\n\t}\n\n}\n\n/**\n * meshopt BufferView Compression Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_meshopt_compression\n */\nclass GLTFMeshoptCompression {\n\n\tconstructor( parser ) {\n\n\t\tthis.name = EXTENSIONS.EXT_MESHOPT_COMPRESSION;\n\t\tthis.parser = parser;\n\n\t}\n\n\tloadBufferView( index ) {\n\n\t\tconst json = this.parser.json;\n\t\tconst bufferView = json.bufferViews[ index ];\n\n\t\tif ( bufferView.extensions && bufferView.extensions[ this.name ] ) {\n\n\t\t\tconst extensionDef = bufferView.extensions[ this.name ];\n\n\t\t\tconst buffer = this.parser.getDependency( 'buffer', extensionDef.buffer );\n\t\t\tconst decoder = this.parser.options.meshoptDecoder;\n\n\t\t\tif ( ! decoder || ! decoder.supported ) {\n\n\t\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( this.name ) >= 0 ) {\n\n\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files' );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Assumes that the extension is optional and that fallback buffer data is present\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn buffer.then( function ( res ) {\n\n\t\t\t\tconst byteOffset = extensionDef.byteOffset || 0;\n\t\t\t\tconst byteLength = extensionDef.byteLength || 0;\n\n\t\t\t\tconst count = extensionDef.count;\n\t\t\t\tconst stride = extensionDef.byteStride;\n\n\t\t\t\tconst source = new Uint8Array( res, byteOffset, byteLength );\n\n\t\t\t\tif ( decoder.decodeGltfBufferAsync ) {\n\n\t\t\t\t\treturn decoder.decodeGltfBufferAsync( count, stride, source, extensionDef.mode, extensionDef.filter ).then( function ( res ) {\n\n\t\t\t\t\t\treturn res.buffer;\n\n\t\t\t\t\t} );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Support for MeshoptDecoder 0.18 or earlier, without decodeGltfBufferAsync\n\t\t\t\t\treturn decoder.ready.then( function () {\n\n\t\t\t\t\t\tconst result = new ArrayBuffer( count * stride );\n\t\t\t\t\t\tdecoder.decodeGltfBuffer( new Uint8Array( result ), count, stride, source, extensionDef.mode, extensionDef.filter );\n\t\t\t\t\t\treturn result;\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} else {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * GPU Instancing Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_mesh_gpu_instancing\n *\n */\nclass GLTFMeshGpuInstancing {\n\n\tconstructor( parser ) {\n\n\t\tthis.name = EXTENSIONS.EXT_MESH_GPU_INSTANCING;\n\t\tthis.parser = parser;\n\n\t}\n\n\tcreateNodeMesh( nodeIndex ) {\n\n\t\tconst json = this.parser.json;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\tif ( ! nodeDef.extensions || ! nodeDef.extensions[ this.name ] ||\n\t\t\tnodeDef.mesh === undefined ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst meshDef = json.meshes[ nodeDef.mesh ];\n\n\t\t// No Points or Lines + Instancing support yet\n\n\t\tfor ( const primitive of meshDef.primitives ) {\n\n\t\t\tif ( primitive.mode !== WEBGL_CONSTANTS.TRIANGLES &&\n\t\t\t\t primitive.mode !== WEBGL_CONSTANTS.TRIANGLE_STRIP &&\n\t\t\t\t primitive.mode !== WEBGL_CONSTANTS.TRIANGLE_FAN &&\n\t\t\t\t primitive.mode !== undefined ) {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst extensionDef = nodeDef.extensions[ this.name ];\n\t\tconst attributesDef = extensionDef.attributes;\n\n\t\t// @TODO: Can we support InstancedMesh + SkinnedMesh?\n\n\t\tconst pending = [];\n\t\tconst attributes = {};\n\n\t\tfor ( const key in attributesDef ) {\n\n\t\t\tpending.push( this.parser.getDependency( 'accessor', attributesDef[ key ] ).then( accessor => {\n\n\t\t\t\tattributes[ key ] = accessor;\n\t\t\t\treturn attributes[ key ];\n\n\t\t\t} ) );\n\n\t\t}\n\n\t\tif ( pending.length < 1 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tpending.push( this.parser.createNodeMesh( nodeIndex ) );\n\n\t\treturn Promise.all( pending ).then( results => {\n\n\t\t\tconst nodeObject = results.pop();\n\t\t\tconst meshes = nodeObject.isGroup ? nodeObject.children : [ nodeObject ];\n\t\t\tconst count = results[ 0 ].count; // All attribute counts should be same\n\t\t\tconst instancedMeshes = [];\n\n\t\t\tfor ( const mesh of meshes ) {\n\n\t\t\t\t// Temporal variables\n\t\t\t\tconst m = new Matrix4();\n\t\t\t\tconst p = new Vector3();\n\t\t\t\tconst q = new Quaternion();\n\t\t\t\tconst s = new Vector3( 1, 1, 1 );\n\n\t\t\t\tconst instancedMesh = new InstancedMesh( mesh.geometry, mesh.material, count );\n\n\t\t\t\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\t\t\t\tif ( attributes.TRANSLATION ) {\n\n\t\t\t\t\t\tp.fromBufferAttribute( attributes.TRANSLATION, i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( attributes.ROTATION ) {\n\n\t\t\t\t\t\tq.fromBufferAttribute( attributes.ROTATION, i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( attributes.SCALE ) {\n\n\t\t\t\t\t\ts.fromBufferAttribute( attributes.SCALE, i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tinstancedMesh.setMatrixAt( i, m.compose( p, q, s ) );\n\n\t\t\t\t}\n\n\t\t\t\t// Add instance attributes to the geometry, excluding TRS.\n\t\t\t\tfor ( const attributeName in attributes ) {\n\n\t\t\t\t\tif ( attributeName === '_COLOR_0' ) {\n\n\t\t\t\t\t\tconst attr = attributes[ attributeName ];\n\t\t\t\t\t\tinstancedMesh.instanceColor = new InstancedBufferAttribute( attr.array, attr.itemSize, attr.normalized );\n\n\t\t\t\t\t} else if ( attributeName !== 'TRANSLATION' &&\n\t\t\t\t\t\t attributeName !== 'ROTATION' &&\n\t\t\t\t\t\t attributeName !== 'SCALE' ) {\n\n\t\t\t\t\t\tmesh.geometry.setAttribute( attributeName, attributes[ attributeName ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// Just in case\n\t\t\t\tObject3D.prototype.copy.call( instancedMesh, mesh );\n\n\t\t\t\tthis.parser.assignFinalMaterial( instancedMesh );\n\n\t\t\t\tinstancedMeshes.push( instancedMesh );\n\n\t\t\t}\n\n\t\t\tif ( nodeObject.isGroup ) {\n\n\t\t\t\tnodeObject.clear();\n\n\t\t\t\tnodeObject.add( ... instancedMeshes );\n\n\t\t\t\treturn nodeObject;\n\n\t\t\t}\n\n\t\t\treturn instancedMeshes[ 0 ];\n\n\t\t} );\n\n\t}\n\n}\n\n/* BINARY EXTENSION */\nconst BINARY_EXTENSION_HEADER_MAGIC = 'glTF';\nconst BINARY_EXTENSION_HEADER_LENGTH = 12;\nconst BINARY_EXTENSION_CHUNK_TYPES = { JSON: 0x4E4F534A, BIN: 0x004E4942 };\n\nclass GLTFBinaryExtension {\n\n\tconstructor( data ) {\n\n\t\tthis.name = EXTENSIONS.KHR_BINARY_GLTF;\n\t\tthis.content = null;\n\t\tthis.body = null;\n\n\t\tconst headerView = new DataView( data, 0, BINARY_EXTENSION_HEADER_LENGTH );\n\t\tconst textDecoder = new TextDecoder();\n\n\t\tthis.header = {\n\t\t\tmagic: textDecoder.decode( new Uint8Array( data.slice( 0, 4 ) ) ),\n\t\t\tversion: headerView.getUint32( 4, true ),\n\t\t\tlength: headerView.getUint32( 8, true )\n\t\t};\n\n\t\tif ( this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported glTF-Binary header.' );\n\n\t\t} else if ( this.header.version < 2.0 ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Legacy binary file detected.' );\n\n\t\t}\n\n\t\tconst chunkContentsLength = this.header.length - BINARY_EXTENSION_HEADER_LENGTH;\n\t\tconst chunkView = new DataView( data, BINARY_EXTENSION_HEADER_LENGTH );\n\t\tlet chunkIndex = 0;\n\n\t\twhile ( chunkIndex < chunkContentsLength ) {\n\n\t\t\tconst chunkLength = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tconst chunkType = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tif ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.JSON ) {\n\n\t\t\t\tconst contentArray = new Uint8Array( data, BINARY_EXTENSION_HEADER_LENGTH + chunkIndex, chunkLength );\n\t\t\t\tthis.content = textDecoder.decode( contentArray );\n\n\t\t\t} else if ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.BIN ) {\n\n\t\t\t\tconst byteOffset = BINARY_EXTENSION_HEADER_LENGTH + chunkIndex;\n\t\t\t\tthis.body = data.slice( byteOffset, byteOffset + chunkLength );\n\n\t\t\t}\n\n\t\t\t// Clients must ignore chunks with unknown types.\n\n\t\t\tchunkIndex += chunkLength;\n\n\t\t}\n\n\t\tif ( this.content === null ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: JSON content not found.' );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * DRACO Mesh Compression Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_draco_mesh_compression\n */\nclass GLTFDracoMeshCompressionExtension {\n\n\tconstructor( json, dracoLoader ) {\n\n\t\tif ( ! dracoLoader ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: No DRACOLoader instance provided.' );\n\n\t\t}\n\n\t\tthis.name = EXTENSIONS.KHR_DRACO_MESH_COMPRESSION;\n\t\tthis.json = json;\n\t\tthis.dracoLoader = dracoLoader;\n\t\tthis.dracoLoader.preload();\n\n\t}\n\n\tdecodePrimitive( primitive, parser ) {\n\n\t\tconst json = this.json;\n\t\tconst dracoLoader = this.dracoLoader;\n\t\tconst bufferViewIndex = primitive.extensions[ this.name ].bufferView;\n\t\tconst gltfAttributeMap = primitive.extensions[ this.name ].attributes;\n\t\tconst threeAttributeMap = {};\n\t\tconst attributeNormalizedMap = {};\n\t\tconst attributeTypeMap = {};\n\n\t\tfor ( const attributeName in gltfAttributeMap ) {\n\n\t\t\tconst threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tthreeAttributeMap[ threeAttributeName ] = gltfAttributeMap[ attributeName ];\n\n\t\t}\n\n\t\tfor ( const attributeName in primitive.attributes ) {\n\n\t\t\tconst threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tif ( gltfAttributeMap[ attributeName ] !== undefined ) {\n\n\t\t\t\tconst accessorDef = json.accessors[ primitive.attributes[ attributeName ] ];\n\t\t\t\tconst componentType = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t\tattributeTypeMap[ threeAttributeName ] = componentType.name;\n\t\t\t\tattributeNormalizedMap[ threeAttributeName ] = accessorDef.normalized === true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn parser.getDependency( 'bufferView', bufferViewIndex ).then( function ( bufferView ) {\n\n\t\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\t\tdracoLoader.decodeDracoFile( bufferView, function ( geometry ) {\n\n\t\t\t\t\tfor ( const attributeName in geometry.attributes ) {\n\n\t\t\t\t\t\tconst attribute = geometry.attributes[ attributeName ];\n\t\t\t\t\t\tconst normalized = attributeNormalizedMap[ attributeName ];\n\n\t\t\t\t\t\tif ( normalized !== undefined ) attribute.normalized = normalized;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve( geometry );\n\n\t\t\t\t}, threeAttributeMap, attributeTypeMap, LinearSRGBColorSpace, reject );\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n}\n\n/**\n * Texture Transform Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_transform\n */\nclass GLTFTextureTransformExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_TEXTURE_TRANSFORM;\n\n\t}\n\n\textendTexture( texture, transform ) {\n\n\t\tif ( ( transform.texCoord === undefined || transform.texCoord === texture.channel )\n\t\t\t&& transform.offset === undefined\n\t\t\t&& transform.rotation === undefined\n\t\t\t&& transform.scale === undefined ) {\n\n\t\t\t// See https://github.com/mrdoob/three.js/issues/21819.\n\t\t\treturn texture;\n\n\t\t}\n\n\t\ttexture = texture.clone();\n\n\t\tif ( transform.texCoord !== undefined ) {\n\n\t\t\ttexture.channel = transform.texCoord;\n\n\t\t}\n\n\t\tif ( transform.offset !== undefined ) {\n\n\t\t\ttexture.offset.fromArray( transform.offset );\n\n\t\t}\n\n\t\tif ( transform.rotation !== undefined ) {\n\n\t\t\ttexture.rotation = transform.rotation;\n\n\t\t}\n\n\t\tif ( transform.scale !== undefined ) {\n\n\t\t\ttexture.repeat.fromArray( transform.scale );\n\n\t\t}\n\n\t\ttexture.needsUpdate = true;\n\n\t\treturn texture;\n\n\t}\n\n}\n\n/**\n * Mesh Quantization Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization\n */\nclass GLTFMeshQuantizationExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_MESH_QUANTIZATION;\n\n\t}\n\n}\n\n/*********************************/\n/********** INTERPOLATION ********/\n/*********************************/\n\n// Spline Interpolation\n// Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#appendix-c-spline-interpolation\nclass GLTFCubicSplineInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tcopySampleValue_( index ) {\n\n\t\t// Copies a sample value to the result buffer. See description of glTF\n\t\t// CUBICSPLINE values layout in interpolate_() function below.\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tvalueSize = this.valueSize,\n\t\t\toffset = index * valueSize * 3 + valueSize;\n\n\t\tfor ( let i = 0; i !== valueSize; i ++ ) {\n\n\t\t\tresult[ i ] = values[ offset + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = this.resultBuffer;\n\t\tconst values = this.sampleValues;\n\t\tconst stride = this.valueSize;\n\n\t\tconst stride2 = stride * 2;\n\t\tconst stride3 = stride * 3;\n\n\t\tconst td = t1 - t0;\n\n\t\tconst p = ( t - t0 ) / td;\n\t\tconst pp = p * p;\n\t\tconst ppp = pp * p;\n\n\t\tconst offset1 = i1 * stride3;\n\t\tconst offset0 = offset1 - stride3;\n\n\t\tconst s2 = - 2 * ppp + 3 * pp;\n\t\tconst s3 = ppp - pp;\n\t\tconst s0 = 1 - s2;\n\t\tconst s1 = s3 - pp + p;\n\n\t\t// Layout of keyframe output values for CUBICSPLINE animations:\n\t\t//   [ inTangent_1, splineVertex_1, outTangent_1, inTangent_2, splineVertex_2, ... ]\n\t\tfor ( let i = 0; i !== stride; i ++ ) {\n\n\t\t\tconst p0 = values[ offset0 + i + stride ]; // splineVertex_k\n\t\t\tconst m0 = values[ offset0 + i + stride2 ] * td; // outTangent_k * (t_k+1 - t_k)\n\t\t\tconst p1 = values[ offset1 + i + stride ]; // splineVertex_k+1\n\t\t\tconst m1 = values[ offset1 + i ] * td; // inTangent_k+1 * (t_k+1 - t_k)\n\n\t\t\tresult[ i ] = s0 * p0 + s1 * m0 + s2 * p1 + s3 * m1;\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\nconst _q = new Quaternion();\n\nclass GLTFCubicSplineQuaternionInterpolant extends GLTFCubicSplineInterpolant {\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = super.interpolate_( i1, t0, t, t1 );\n\n\t\t_q.fromArray( result ).normalize().toArray( result );\n\n\t\treturn result;\n\n\t}\n\n}\n\n\n/*********************************/\n/********** INTERNALS ************/\n/*********************************/\n\n/* CONSTANTS */\n\nconst WEBGL_CONSTANTS = {\n\tFLOAT: 5126,\n\t//FLOAT_MAT2: 35674,\n\tFLOAT_MAT3: 35675,\n\tFLOAT_MAT4: 35676,\n\tFLOAT_VEC2: 35664,\n\tFLOAT_VEC3: 35665,\n\tFLOAT_VEC4: 35666,\n\tLINEAR: 9729,\n\tREPEAT: 10497,\n\tSAMPLER_2D: 35678,\n\tPOINTS: 0,\n\tLINES: 1,\n\tLINE_LOOP: 2,\n\tLINE_STRIP: 3,\n\tTRIANGLES: 4,\n\tTRIANGLE_STRIP: 5,\n\tTRIANGLE_FAN: 6,\n\tUNSIGNED_BYTE: 5121,\n\tUNSIGNED_SHORT: 5123\n};\n\nconst WEBGL_COMPONENT_TYPES = {\n\t5120: Int8Array,\n\t5121: Uint8Array,\n\t5122: Int16Array,\n\t5123: Uint16Array,\n\t5125: Uint32Array,\n\t5126: Float32Array\n};\n\nconst WEBGL_FILTERS = {\n\t9728: NearestFilter,\n\t9729: LinearFilter,\n\t9984: NearestMipmapNearestFilter,\n\t9985: LinearMipmapNearestFilter,\n\t9986: NearestMipmapLinearFilter,\n\t9987: LinearMipmapLinearFilter\n};\n\nconst WEBGL_WRAPPINGS = {\n\t33071: ClampToEdgeWrapping,\n\t33648: MirroredRepeatWrapping,\n\t10497: RepeatWrapping\n};\n\nconst WEBGL_TYPE_SIZES = {\n\t'SCALAR': 1,\n\t'VEC2': 2,\n\t'VEC3': 3,\n\t'VEC4': 4,\n\t'MAT2': 4,\n\t'MAT3': 9,\n\t'MAT4': 16\n};\n\nconst ATTRIBUTES = {\n\tPOSITION: 'position',\n\tNORMAL: 'normal',\n\tTANGENT: 'tangent',\n\tTEXCOORD_0: 'uv',\n\tTEXCOORD_1: 'uv1',\n\tTEXCOORD_2: 'uv2',\n\tTEXCOORD_3: 'uv3',\n\tCOLOR_0: 'color',\n\tWEIGHTS_0: 'skinWeight',\n\tJOINTS_0: 'skinIndex',\n};\n\nconst PATH_PROPERTIES = {\n\tscale: 'scale',\n\ttranslation: 'position',\n\trotation: 'quaternion',\n\tweights: 'morphTargetInfluences'\n};\n\nconst INTERPOLATION = {\n\tCUBICSPLINE: undefined, // We use a custom interpolant (GLTFCubicSplineInterpolation) for CUBICSPLINE tracks. Each\n\t\t                        // keyframe track will be initialized with a default interpolation type, then modified.\n\tLINEAR: InterpolateLinear,\n\tSTEP: InterpolateDiscrete\n};\n\nconst ALPHA_MODES = {\n\tOPAQUE: 'OPAQUE',\n\tMASK: 'MASK',\n\tBLEND: 'BLEND'\n};\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material\n *\n * @param {Object<String, Material>} cache\n * @return {Material}\n */\nfunction createDefaultMaterial( cache ) {\n\n\tif ( cache[ 'DefaultMaterial' ] === undefined ) {\n\n\t\tcache[ 'DefaultMaterial' ] = new MeshStandardMaterial( {\n\t\t\tcolor: 0xFFFFFF,\n\t\t\temissive: 0x000000,\n\t\t\tmetalness: 1,\n\t\t\troughness: 1,\n\t\t\ttransparent: false,\n\t\t\tdepthTest: true,\n\t\t\tside: FrontSide\n\t\t} );\n\n\t}\n\n\treturn cache[ 'DefaultMaterial' ];\n\n}\n\nfunction addUnknownExtensionsToUserData( knownExtensions, object, objectDef ) {\n\n\t// Add unknown glTF extensions to an object's userData.\n\n\tfor ( const name in objectDef.extensions ) {\n\n\t\tif ( knownExtensions[ name ] === undefined ) {\n\n\t\t\tobject.userData.gltfExtensions = object.userData.gltfExtensions || {};\n\t\t\tobject.userData.gltfExtensions[ name ] = objectDef.extensions[ name ];\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * @param {Object3D|Material|BufferGeometry} object\n * @param {GLTF.definition} gltfDef\n */\nfunction assignExtrasToUserData( object, gltfDef ) {\n\n\tif ( gltfDef.extras !== undefined ) {\n\n\t\tif ( typeof gltfDef.extras === 'object' ) {\n\n\t\t\tObject.assign( object.userData, gltfDef.extras );\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Ignoring primitive type .extras, ' + gltfDef.extras );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets\n *\n * @param {BufferGeometry} geometry\n * @param {Array<GLTF.Target>} targets\n * @param {GLTFParser} parser\n * @return {Promise<BufferGeometry>}\n */\nfunction addMorphTargets( geometry, targets, parser ) {\n\n\tlet hasMorphPosition = false;\n\tlet hasMorphNormal = false;\n\tlet hasMorphColor = false;\n\n\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\tconst target = targets[ i ];\n\n\t\tif ( target.POSITION !== undefined ) hasMorphPosition = true;\n\t\tif ( target.NORMAL !== undefined ) hasMorphNormal = true;\n\t\tif ( target.COLOR_0 !== undefined ) hasMorphColor = true;\n\n\t\tif ( hasMorphPosition && hasMorphNormal && hasMorphColor ) break;\n\n\t}\n\n\tif ( ! hasMorphPosition && ! hasMorphNormal && ! hasMorphColor ) return Promise.resolve( geometry );\n\n\tconst pendingPositionAccessors = [];\n\tconst pendingNormalAccessors = [];\n\tconst pendingColorAccessors = [];\n\n\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\tconst target = targets[ i ];\n\n\t\tif ( hasMorphPosition ) {\n\n\t\t\tconst pendingAccessor = target.POSITION !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.POSITION )\n\t\t\t\t: geometry.attributes.position;\n\n\t\t\tpendingPositionAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t\tif ( hasMorphNormal ) {\n\n\t\t\tconst pendingAccessor = target.NORMAL !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.NORMAL )\n\t\t\t\t: geometry.attributes.normal;\n\n\t\t\tpendingNormalAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t\tif ( hasMorphColor ) {\n\n\t\t\tconst pendingAccessor = target.COLOR_0 !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.COLOR_0 )\n\t\t\t\t: geometry.attributes.color;\n\n\t\t\tpendingColorAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t}\n\n\treturn Promise.all( [\n\t\tPromise.all( pendingPositionAccessors ),\n\t\tPromise.all( pendingNormalAccessors ),\n\t\tPromise.all( pendingColorAccessors )\n\t] ).then( function ( accessors ) {\n\n\t\tconst morphPositions = accessors[ 0 ];\n\t\tconst morphNormals = accessors[ 1 ];\n\t\tconst morphColors = accessors[ 2 ];\n\n\t\tif ( hasMorphPosition ) geometry.morphAttributes.position = morphPositions;\n\t\tif ( hasMorphNormal ) geometry.morphAttributes.normal = morphNormals;\n\t\tif ( hasMorphColor ) geometry.morphAttributes.color = morphColors;\n\t\tgeometry.morphTargetsRelative = true;\n\n\t\treturn geometry;\n\n\t} );\n\n}\n\n/**\n * @param {Mesh} mesh\n * @param {GLTF.Mesh} meshDef\n */\nfunction updateMorphTargets( mesh, meshDef ) {\n\n\tmesh.updateMorphTargets();\n\n\tif ( meshDef.weights !== undefined ) {\n\n\t\tfor ( let i = 0, il = meshDef.weights.length; i < il; i ++ ) {\n\n\t\t\tmesh.morphTargetInfluences[ i ] = meshDef.weights[ i ];\n\n\t\t}\n\n\t}\n\n\t// .extras has user-defined data, so check that .extras.targetNames is an array.\n\tif ( meshDef.extras && Array.isArray( meshDef.extras.targetNames ) ) {\n\n\t\tconst targetNames = meshDef.extras.targetNames;\n\n\t\tif ( mesh.morphTargetInfluences.length === targetNames.length ) {\n\n\t\t\tmesh.morphTargetDictionary = {};\n\n\t\t\tfor ( let i = 0, il = targetNames.length; i < il; i ++ ) {\n\n\t\t\t\tmesh.morphTargetDictionary[ targetNames[ i ] ] = i;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.' );\n\n\t\t}\n\n\t}\n\n}\n\nfunction createPrimitiveKey( primitiveDef ) {\n\n\tlet geometryKey;\n\n\tconst dracoExtension = primitiveDef.extensions && primitiveDef.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ];\n\n\tif ( dracoExtension ) {\n\n\t\tgeometryKey = 'draco:' + dracoExtension.bufferView\n\t\t\t\t+ ':' + dracoExtension.indices\n\t\t\t\t+ ':' + createAttributesKey( dracoExtension.attributes );\n\n\t} else {\n\n\t\tgeometryKey = primitiveDef.indices + ':' + createAttributesKey( primitiveDef.attributes ) + ':' + primitiveDef.mode;\n\n\t}\n\n\tif ( primitiveDef.targets !== undefined ) {\n\n\t\tfor ( let i = 0, il = primitiveDef.targets.length; i < il; i ++ ) {\n\n\t\t\tgeometryKey += ':' + createAttributesKey( primitiveDef.targets[ i ] );\n\n\t\t}\n\n\t}\n\n\treturn geometryKey;\n\n}\n\nfunction createAttributesKey( attributes ) {\n\n\tlet attributesKey = '';\n\n\tconst keys = Object.keys( attributes ).sort();\n\n\tfor ( let i = 0, il = keys.length; i < il; i ++ ) {\n\n\t\tattributesKey += keys[ i ] + ':' + attributes[ keys[ i ] ] + ';';\n\n\t}\n\n\treturn attributesKey;\n\n}\n\nfunction getNormalizedComponentScale( constructor ) {\n\n\t// Reference:\n\t// https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization#encoding-quantized-data\n\n\tswitch ( constructor ) {\n\n\t\tcase Int8Array:\n\t\t\treturn 1 / 127;\n\n\t\tcase Uint8Array:\n\t\t\treturn 1 / 255;\n\n\t\tcase Int16Array:\n\t\t\treturn 1 / 32767;\n\n\t\tcase Uint16Array:\n\t\t\treturn 1 / 65535;\n\n\t\tdefault:\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported normalized accessor component type.' );\n\n\t}\n\n}\n\nfunction getImageURIMimeType( uri ) {\n\n\tif ( uri.search( /\\.jpe?g($|\\?)/i ) > 0 || uri.search( /^data\\:image\\/jpeg/ ) === 0 ) return 'image/jpeg';\n\tif ( uri.search( /\\.webp($|\\?)/i ) > 0 || uri.search( /^data\\:image\\/webp/ ) === 0 ) return 'image/webp';\n\tif ( uri.search( /\\.ktx2($|\\?)/i ) > 0 || uri.search( /^data\\:image\\/ktx2/ ) === 0 ) return 'image/ktx2';\n\n\treturn 'image/png';\n\n}\n\nconst _identityMatrix = new Matrix4();\n\n/* GLTF PARSER */\n\nclass GLTFParser {\n\n\tconstructor( json = {}, options = {} ) {\n\n\t\tthis.json = json;\n\t\tthis.extensions = {};\n\t\tthis.plugins = {};\n\t\tthis.options = options;\n\n\t\t// loader object cache\n\t\tthis.cache = new GLTFRegistry();\n\n\t\t// associations between Three.js objects and glTF elements\n\t\tthis.associations = new Map();\n\n\t\t// BufferGeometry caching\n\t\tthis.primitiveCache = {};\n\n\t\t// Node cache\n\t\tthis.nodeCache = {};\n\n\t\t// Object3D instance caches\n\t\tthis.meshCache = { refs: {}, uses: {} };\n\t\tthis.cameraCache = { refs: {}, uses: {} };\n\t\tthis.lightCache = { refs: {}, uses: {} };\n\n\t\tthis.sourceCache = {};\n\t\tthis.textureCache = {};\n\n\t\t// Track node names, to ensure no duplicates\n\t\tthis.nodeNamesUsed = {};\n\n\t\t// Use an ImageBitmapLoader if imageBitmaps are supported. Moves much of the\n\t\t// expensive work of uploading a texture to the GPU off the main thread.\n\n\t\tlet isSafari = false;\n\t\tlet safariVersion = - 1;\n\t\tlet isFirefox = false;\n\t\tlet firefoxVersion = - 1;\n\n\t\tif ( typeof navigator !== 'undefined' ) {\n\n\t\t\tconst userAgent = navigator.userAgent;\n\n\t\t\tisSafari = /^((?!chrome|android).)*safari/i.test( userAgent ) === true;\n\t\t\tconst safariMatch = userAgent.match( /Version\\/(\\d+)/ );\n\t\t\tsafariVersion = isSafari && safariMatch ? parseInt( safariMatch[ 1 ], 10 ) : - 1;\n\n\t\t\tisFirefox = userAgent.indexOf( 'Firefox' ) > - 1;\n\t\t\tfirefoxVersion = isFirefox ? userAgent.match( /Firefox\\/([0-9]+)\\./ )[ 1 ] : - 1;\n\n\t\t}\n\n\t\tif ( typeof createImageBitmap === 'undefined' || ( isSafari && safariVersion < 17 ) || ( isFirefox && firefoxVersion < 98 ) ) {\n\n\t\t\tthis.textureLoader = new TextureLoader( this.options.manager );\n\n\t\t} else {\n\n\t\t\tthis.textureLoader = new ImageBitmapLoader( this.options.manager );\n\n\t\t}\n\n\t\tthis.textureLoader.setCrossOrigin( this.options.crossOrigin );\n\t\tthis.textureLoader.setRequestHeader( this.options.requestHeader );\n\n\t\tthis.fileLoader = new FileLoader( this.options.manager );\n\t\tthis.fileLoader.setResponseType( 'arraybuffer' );\n\n\t\tif ( this.options.crossOrigin === 'use-credentials' ) {\n\n\t\t\tthis.fileLoader.setWithCredentials( true );\n\n\t\t}\n\n\t}\n\n\tsetExtensions( extensions ) {\n\n\t\tthis.extensions = extensions;\n\n\t}\n\n\tsetPlugins( plugins ) {\n\n\t\tthis.plugins = plugins;\n\n\t}\n\n\tparse( onLoad, onError ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\n\t\t// Clear the loader cache\n\t\tthis.cache.removeAll();\n\t\tthis.nodeCache = {};\n\n\t\t// Mark the special nodes/meshes in json for efficient parse\n\t\tthis._invokeAll( function ( ext ) {\n\n\t\t\treturn ext._markDefs && ext._markDefs();\n\n\t\t} );\n\n\t\tPromise.all( this._invokeAll( function ( ext ) {\n\n\t\t\treturn ext.beforeRoot && ext.beforeRoot();\n\n\t\t} ) ).then( function () {\n\n\t\t\treturn Promise.all( [\n\n\t\t\t\tparser.getDependencies( 'scene' ),\n\t\t\t\tparser.getDependencies( 'animation' ),\n\t\t\t\tparser.getDependencies( 'camera' ),\n\n\t\t\t] );\n\n\t\t} ).then( function ( dependencies ) {\n\n\t\t\tconst result = {\n\t\t\t\tscene: dependencies[ 0 ][ json.scene || 0 ],\n\t\t\t\tscenes: dependencies[ 0 ],\n\t\t\t\tanimations: dependencies[ 1 ],\n\t\t\t\tcameras: dependencies[ 2 ],\n\t\t\t\tasset: json.asset,\n\t\t\t\tparser: parser,\n\t\t\t\tuserData: {}\n\t\t\t};\n\n\t\t\taddUnknownExtensionsToUserData( extensions, result, json );\n\n\t\t\tassignExtrasToUserData( result, json );\n\n\t\t\treturn Promise.all( parser._invokeAll( function ( ext ) {\n\n\t\t\t\treturn ext.afterRoot && ext.afterRoot( result );\n\n\t\t\t} ) ).then( function () {\n\n\t\t\t\tfor ( const scene of result.scenes ) {\n\n\t\t\t\t\tscene.updateMatrixWorld();\n\n\t\t\t\t}\n\n\t\t\t\tonLoad( result );\n\n\t\t\t} );\n\n\t\t} ).catch( onError );\n\n\t}\n\n\t/**\n\t * Marks the special nodes/meshes in json for efficient parse.\n\t */\n\t_markDefs() {\n\n\t\tconst nodeDefs = this.json.nodes || [];\n\t\tconst skinDefs = this.json.skins || [];\n\t\tconst meshDefs = this.json.meshes || [];\n\n\t\t// Nothing in the node definition indicates whether it is a Bone or an\n\t\t// Object3D. Use the skins' joint references to mark bones.\n\t\tfor ( let skinIndex = 0, skinLength = skinDefs.length; skinIndex < skinLength; skinIndex ++ ) {\n\n\t\t\tconst joints = skinDefs[ skinIndex ].joints;\n\n\t\t\tfor ( let i = 0, il = joints.length; i < il; i ++ ) {\n\n\t\t\t\tnodeDefs[ joints[ i ] ].isBone = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Iterate over all nodes, marking references to shared resources,\n\t\t// as well as skeleton joints.\n\t\tfor ( let nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\n\n\t\t\tconst nodeDef = nodeDefs[ nodeIndex ];\n\n\t\t\tif ( nodeDef.mesh !== undefined ) {\n\n\t\t\t\tthis._addNodeRef( this.meshCache, nodeDef.mesh );\n\n\t\t\t\t// Nothing in the mesh definition indicates whether it is\n\t\t\t\t// a SkinnedMesh or Mesh. Use the node's mesh reference\n\t\t\t\t// to mark SkinnedMesh if node has skin.\n\t\t\t\tif ( nodeDef.skin !== undefined ) {\n\n\t\t\t\t\tmeshDefs[ nodeDef.mesh ].isSkinnedMesh = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.camera !== undefined ) {\n\n\t\t\t\tthis._addNodeRef( this.cameraCache, nodeDef.camera );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Counts references to shared node / Object3D resources. These resources\n\t * can be reused, or \"instantiated\", at multiple nodes in the scene\n\t * hierarchy. Mesh, Camera, and Light instances are instantiated and must\n\t * be marked. Non-scenegraph resources (like Materials, Geometries, and\n\t * Textures) can be reused directly and are not marked here.\n\t *\n\t * Example: CesiumMilkTruck sample model reuses \"Wheel\" meshes.\n\t *\n\t * @param {Object} cache\n\t * @param {Object3D} index\n\t */\n\t_addNodeRef( cache, index ) {\n\n\t\tif ( index === undefined ) return;\n\n\t\tif ( cache.refs[ index ] === undefined ) {\n\n\t\t\tcache.refs[ index ] = cache.uses[ index ] = 0;\n\n\t\t}\n\n\t\tcache.refs[ index ] ++;\n\n\t}\n\n\t/**\n\t * Returns a reference to a shared resource, cloning it if necessary.\n\t *\n\t * @param {Object} cache\n\t * @param {Number} index\n\t * @param {Object} object\n\t * @return {Object}\n\t */\n\t_getNodeRef( cache, index, object ) {\n\n\t\tif ( cache.refs[ index ] <= 1 ) return object;\n\n\t\tconst ref = object.clone();\n\n\t\t// Propagates mappings to the cloned object, prevents mappings on the\n\t\t// original object from being lost.\n\t\tconst updateMappings = ( original, clone ) => {\n\n\t\t\tconst mappings = this.associations.get( original );\n\t\t\tif ( mappings != null ) {\n\n\t\t\t\tthis.associations.set( clone, mappings );\n\n\t\t\t}\n\n\t\t\tfor ( const [ i, child ] of original.children.entries() ) {\n\n\t\t\t\tupdateMappings( child, clone.children[ i ] );\n\n\t\t\t}\n\n\t\t};\n\n\t\tupdateMappings( object, ref );\n\n\t\tref.name += '_instance_' + ( cache.uses[ index ] ++ );\n\n\t\treturn ref;\n\n\t}\n\n\t_invokeOne( func ) {\n\n\t\tconst extensions = Object.values( this.plugins );\n\t\textensions.push( this );\n\n\t\tfor ( let i = 0; i < extensions.length; i ++ ) {\n\n\t\t\tconst result = func( extensions[ i ] );\n\n\t\t\tif ( result ) return result;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\t_invokeAll( func ) {\n\n\t\tconst extensions = Object.values( this.plugins );\n\t\textensions.unshift( this );\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0; i < extensions.length; i ++ ) {\n\n\t\t\tconst result = func( extensions[ i ] );\n\n\t\t\tif ( result ) pending.push( result );\n\n\t\t}\n\n\t\treturn pending;\n\n\t}\n\n\t/**\n\t * Requests the specified dependency asynchronously, with caching.\n\t * @param {string} type\n\t * @param {number} index\n\t * @return {Promise<Object3D|Material|THREE.Texture|AnimationClip|ArrayBuffer|Object>}\n\t */\n\tgetDependency( type, index ) {\n\n\t\tconst cacheKey = type + ':' + index;\n\t\tlet dependency = this.cache.get( cacheKey );\n\n\t\tif ( ! dependency ) {\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 'scene':\n\t\t\t\t\tdependency = this.loadScene( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'node':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadNode && ext.loadNode( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'mesh':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadMesh && ext.loadMesh( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'accessor':\n\t\t\t\t\tdependency = this.loadAccessor( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'bufferView':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadBufferView && ext.loadBufferView( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'buffer':\n\t\t\t\t\tdependency = this.loadBuffer( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'material':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadMaterial && ext.loadMaterial( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'texture':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadTexture && ext.loadTexture( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'skin':\n\t\t\t\t\tdependency = this.loadSkin( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'animation':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadAnimation && ext.loadAnimation( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'camera':\n\t\t\t\t\tdependency = this.loadCamera( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext != this && ext.getDependency && ext.getDependency( type, index );\n\n\t\t\t\t\t} );\n\n\t\t\t\t\tif ( ! dependency ) {\n\n\t\t\t\t\t\tthrow new Error( 'Unknown type: ' + type );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tthis.cache.add( cacheKey, dependency );\n\n\t\t}\n\n\t\treturn dependency;\n\n\t}\n\n\t/**\n\t * Requests all dependencies of the specified type asynchronously, with caching.\n\t * @param {string} type\n\t * @return {Promise<Array<Object>>}\n\t */\n\tgetDependencies( type ) {\n\n\t\tlet dependencies = this.cache.get( type );\n\n\t\tif ( ! dependencies ) {\n\n\t\t\tconst parser = this;\n\t\t\tconst defs = this.json[ type + ( type === 'mesh' ? 'es' : 's' ) ] || [];\n\n\t\t\tdependencies = Promise.all( defs.map( function ( def, index ) {\n\n\t\t\t\treturn parser.getDependency( type, index );\n\n\t\t\t} ) );\n\n\t\t\tthis.cache.add( type, dependencies );\n\n\t\t}\n\n\t\treturn dependencies;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tloadBuffer( bufferIndex ) {\n\n\t\tconst bufferDef = this.json.buffers[ bufferIndex ];\n\t\tconst loader = this.fileLoader;\n\n\t\tif ( bufferDef.type && bufferDef.type !== 'arraybuffer' ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: ' + bufferDef.type + ' buffer type is not supported.' );\n\n\t\t}\n\n\t\t// If present, GLB container is required to be the first buffer.\n\t\tif ( bufferDef.uri === undefined && bufferIndex === 0 ) {\n\n\t\t\treturn Promise.resolve( this.extensions[ EXTENSIONS.KHR_BINARY_GLTF ].body );\n\n\t\t}\n\n\t\tconst options = this.options;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tloader.load( LoaderUtils.resolveURL( bufferDef.uri, options.path ), resolve, undefined, function () {\n\n\t\t\t\treject( new Error( 'THREE.GLTFLoader: Failed to load buffer \"' + bufferDef.uri + '\".' ) );\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferViewIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tloadBufferView( bufferViewIndex ) {\n\n\t\tconst bufferViewDef = this.json.bufferViews[ bufferViewIndex ];\n\n\t\treturn this.getDependency( 'buffer', bufferViewDef.buffer ).then( function ( buffer ) {\n\n\t\t\tconst byteLength = bufferViewDef.byteLength || 0;\n\t\t\tconst byteOffset = bufferViewDef.byteOffset || 0;\n\t\t\treturn buffer.slice( byteOffset, byteOffset + byteLength );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#accessors\n\t * @param {number} accessorIndex\n\t * @return {Promise<BufferAttribute|InterleavedBufferAttribute>}\n\t */\n\tloadAccessor( accessorIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\n\t\tconst accessorDef = this.json.accessors[ accessorIndex ];\n\n\t\tif ( accessorDef.bufferView === undefined && accessorDef.sparse === undefined ) {\n\n\t\t\tconst itemSize = WEBGL_TYPE_SIZES[ accessorDef.type ];\n\t\t\tconst TypedArray = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\t\t\tconst normalized = accessorDef.normalized === true;\n\n\t\t\tconst array = new TypedArray( accessorDef.count * itemSize );\n\t\t\treturn Promise.resolve( new BufferAttribute( array, itemSize, normalized ) );\n\n\t\t}\n\n\t\tconst pendingBufferViews = [];\n\n\t\tif ( accessorDef.bufferView !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.bufferView ) );\n\n\t\t} else {\n\n\t\t\tpendingBufferViews.push( null );\n\n\t\t}\n\n\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.indices.bufferView ) );\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.values.bufferView ) );\n\n\t\t}\n\n\t\treturn Promise.all( pendingBufferViews ).then( function ( bufferViews ) {\n\n\t\t\tconst bufferView = bufferViews[ 0 ];\n\n\t\t\tconst itemSize = WEBGL_TYPE_SIZES[ accessorDef.type ];\n\t\t\tconst TypedArray = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t// For VEC3: itemSize is 3, elementBytes is 4, itemBytes is 12.\n\t\t\tconst elementBytes = TypedArray.BYTES_PER_ELEMENT;\n\t\t\tconst itemBytes = elementBytes * itemSize;\n\t\t\tconst byteOffset = accessorDef.byteOffset || 0;\n\t\t\tconst byteStride = accessorDef.bufferView !== undefined ? json.bufferViews[ accessorDef.bufferView ].byteStride : undefined;\n\t\t\tconst normalized = accessorDef.normalized === true;\n\t\t\tlet array, bufferAttribute;\n\n\t\t\t// The buffer is not interleaved if the stride is the item size in bytes.\n\t\t\tif ( byteStride && byteStride !== itemBytes ) {\n\n\t\t\t\t// Each \"slice\" of the buffer, as defined by 'count' elements of 'byteStride' bytes, gets its own InterleavedBuffer\n\t\t\t\t// This makes sure that IBA.count reflects accessor.count properly\n\t\t\t\tconst ibSlice = Math.floor( byteOffset / byteStride );\n\t\t\t\tconst ibCacheKey = 'InterleavedBuffer:' + accessorDef.bufferView + ':' + accessorDef.componentType + ':' + ibSlice + ':' + accessorDef.count;\n\t\t\t\tlet ib = parser.cache.get( ibCacheKey );\n\n\t\t\t\tif ( ! ib ) {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, ibSlice * byteStride, accessorDef.count * byteStride / elementBytes );\n\n\t\t\t\t\t// Integer parameters to IB/IBA are in array elements, not bytes.\n\t\t\t\t\tib = new InterleavedBuffer( array, byteStride / elementBytes );\n\n\t\t\t\t\tparser.cache.add( ibCacheKey, ib );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new InterleavedBufferAttribute( ib, itemSize, ( byteOffset % byteStride ) / elementBytes, normalized );\n\n\t\t\t} else {\n\n\t\t\t\tif ( bufferView === null ) {\n\n\t\t\t\t\tarray = new TypedArray( accessorDef.count * itemSize );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, byteOffset, accessorDef.count * itemSize );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new BufferAttribute( array, itemSize, normalized );\n\n\t\t\t}\n\n\t\t\t// https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#sparse-accessors\n\t\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\t\tconst itemSizeIndices = WEBGL_TYPE_SIZES.SCALAR;\n\t\t\t\tconst TypedArrayIndices = WEBGL_COMPONENT_TYPES[ accessorDef.sparse.indices.componentType ];\n\n\t\t\t\tconst byteOffsetIndices = accessorDef.sparse.indices.byteOffset || 0;\n\t\t\t\tconst byteOffsetValues = accessorDef.sparse.values.byteOffset || 0;\n\n\t\t\t\tconst sparseIndices = new TypedArrayIndices( bufferViews[ 1 ], byteOffsetIndices, accessorDef.sparse.count * itemSizeIndices );\n\t\t\t\tconst sparseValues = new TypedArray( bufferViews[ 2 ], byteOffsetValues, accessorDef.sparse.count * itemSize );\n\n\t\t\t\tif ( bufferView !== null ) {\n\n\t\t\t\t\t// Avoid modifying the original ArrayBuffer, if the bufferView wasn't initialized with zeroes.\n\t\t\t\t\tbufferAttribute = new BufferAttribute( bufferAttribute.array.slice(), bufferAttribute.itemSize, bufferAttribute.normalized );\n\n\t\t\t\t}\n\n\t\t\t\t// Ignore normalized since we copy from sparse\n\t\t\t\tbufferAttribute.normalized = false;\n\n\t\t\t\tfor ( let i = 0, il = sparseIndices.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst index = sparseIndices[ i ];\n\n\t\t\t\t\tbufferAttribute.setX( index, sparseValues[ i * itemSize ] );\n\t\t\t\t\tif ( itemSize >= 2 ) bufferAttribute.setY( index, sparseValues[ i * itemSize + 1 ] );\n\t\t\t\t\tif ( itemSize >= 3 ) bufferAttribute.setZ( index, sparseValues[ i * itemSize + 2 ] );\n\t\t\t\t\tif ( itemSize >= 4 ) bufferAttribute.setW( index, sparseValues[ i * itemSize + 3 ] );\n\t\t\t\t\tif ( itemSize >= 5 ) throw new Error( 'THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.' );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute.normalized = normalized;\n\n\t\t\t}\n\n\t\t\treturn bufferAttribute;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures\n\t * @param {number} textureIndex\n\t * @return {Promise<THREE.Texture|null>}\n\t */\n\tloadTexture( textureIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst options = this.options;\n\t\tconst textureDef = json.textures[ textureIndex ];\n\t\tconst sourceIndex = textureDef.source;\n\t\tconst sourceDef = json.images[ sourceIndex ];\n\n\t\tlet loader = this.textureLoader;\n\n\t\tif ( sourceDef.uri ) {\n\n\t\t\tconst handler = options.manager.getHandler( sourceDef.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.loadTextureImage( textureIndex, sourceIndex, loader );\n\n\t}\n\n\tloadTextureImage( textureIndex, sourceIndex, loader ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\t\tconst sourceDef = json.images[ sourceIndex ];\n\n\t\tconst cacheKey = ( sourceDef.uri || sourceDef.bufferView ) + ':' + textureDef.sampler;\n\n\t\tif ( this.textureCache[ cacheKey ] ) {\n\n\t\t\t// See https://github.com/mrdoob/three.js/issues/21559.\n\t\t\treturn this.textureCache[ cacheKey ];\n\n\t\t}\n\n\t\tconst promise = this.loadImageSource( sourceIndex, loader ).then( function ( texture ) {\n\n\t\t\ttexture.flipY = false;\n\n\t\t\ttexture.name = textureDef.name || sourceDef.name || '';\n\n\t\t\tif ( texture.name === '' && typeof sourceDef.uri === 'string' && sourceDef.uri.startsWith( 'data:image/' ) === false ) {\n\n\t\t\t\ttexture.name = sourceDef.uri;\n\n\t\t\t}\n\n\t\t\tconst samplers = json.samplers || {};\n\t\t\tconst sampler = samplers[ textureDef.sampler ] || {};\n\n\t\t\ttexture.magFilter = WEBGL_FILTERS[ sampler.magFilter ] || LinearFilter;\n\t\t\ttexture.minFilter = WEBGL_FILTERS[ sampler.minFilter ] || LinearMipmapLinearFilter;\n\t\t\ttexture.wrapS = WEBGL_WRAPPINGS[ sampler.wrapS ] || RepeatWrapping;\n\t\t\ttexture.wrapT = WEBGL_WRAPPINGS[ sampler.wrapT ] || RepeatWrapping;\n\t\t\ttexture.generateMipmaps = ! texture.isCompressedTexture && texture.minFilter !== NearestFilter && texture.minFilter !== LinearFilter;\n\n\t\t\tparser.associations.set( texture, { textures: textureIndex } );\n\n\t\t\treturn texture;\n\n\t\t} ).catch( function () {\n\n\t\t\treturn null;\n\n\t\t} );\n\n\t\tthis.textureCache[ cacheKey ] = promise;\n\n\t\treturn promise;\n\n\t}\n\n\tloadImageSource( sourceIndex, loader ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst options = this.options;\n\n\t\tif ( this.sourceCache[ sourceIndex ] !== undefined ) {\n\n\t\t\treturn this.sourceCache[ sourceIndex ].then( ( texture ) => texture.clone() );\n\n\t\t}\n\n\t\tconst sourceDef = json.images[ sourceIndex ];\n\n\t\tconst URL = self.URL || self.webkitURL;\n\n\t\tlet sourceURI = sourceDef.uri || '';\n\t\tlet isObjectURL = false;\n\n\t\tif ( sourceDef.bufferView !== undefined ) {\n\n\t\t\t// Load binary image data from bufferView, if provided.\n\n\t\t\tsourceURI = parser.getDependency( 'bufferView', sourceDef.bufferView ).then( function ( bufferView ) {\n\n\t\t\t\tisObjectURL = true;\n\t\t\t\tconst blob = new Blob( [ bufferView ], { type: sourceDef.mimeType } );\n\t\t\t\tsourceURI = URL.createObjectURL( blob );\n\t\t\t\treturn sourceURI;\n\n\t\t\t} );\n\n\t\t} else if ( sourceDef.uri === undefined ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Image ' + sourceIndex + ' is missing URI and bufferView' );\n\n\t\t}\n\n\t\tconst promise = Promise.resolve( sourceURI ).then( function ( sourceURI ) {\n\n\t\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\t\tlet onLoad = resolve;\n\n\t\t\t\tif ( loader.isImageBitmapLoader === true ) {\n\n\t\t\t\t\tonLoad = function ( imageBitmap ) {\n\n\t\t\t\t\t\tconst texture = new Texture( imageBitmap );\n\t\t\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t\t\tresolve( texture );\n\n\t\t\t\t\t};\n\n\t\t\t\t}\n\n\t\t\t\tloader.load( LoaderUtils.resolveURL( sourceURI, options.path ), onLoad, undefined, reject );\n\n\t\t\t} );\n\n\t\t} ).then( function ( texture ) {\n\n\t\t\t// Clean up resources and configure Texture.\n\n\t\t\tif ( isObjectURL === true ) {\n\n\t\t\t\tURL.revokeObjectURL( sourceURI );\n\n\t\t\t}\n\n\t\t\tassignExtrasToUserData( texture, sourceDef );\n\n\t\t\ttexture.userData.mimeType = sourceDef.mimeType || getImageURIMimeType( sourceDef.uri );\n\n\t\t\treturn texture;\n\n\t\t} ).catch( function ( error ) {\n\n\t\t\tconsole.error( 'THREE.GLTFLoader: Couldn\\'t load texture', sourceURI );\n\t\t\tthrow error;\n\n\t\t} );\n\n\t\tthis.sourceCache[ sourceIndex ] = promise;\n\t\treturn promise;\n\n\t}\n\n\t/**\n\t * Asynchronously assigns a texture to the given material parameters.\n\t *\n\t * @param {Object} materialParams\n\t * @param {string} mapName\n\t * @param {Object} mapDef\n\t * @param {string} colorSpace\n\t * @return {Promise<Texture>}\n\t */\n\tassignTexture( materialParams, mapName, mapDef, colorSpace ) {\n\n\t\tconst parser = this;\n\n\t\treturn this.getDependency( 'texture', mapDef.index ).then( function ( texture ) {\n\n\t\t\tif ( ! texture ) return null;\n\n\t\t\tif ( mapDef.texCoord !== undefined && mapDef.texCoord > 0 ) {\n\n\t\t\t\ttexture = texture.clone();\n\t\t\t\ttexture.channel = mapDef.texCoord;\n\n\t\t\t}\n\n\t\t\tif ( parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] ) {\n\n\t\t\t\tconst transform = mapDef.extensions !== undefined ? mapDef.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] : undefined;\n\n\t\t\t\tif ( transform ) {\n\n\t\t\t\t\tconst gltfReference = parser.associations.get( texture );\n\t\t\t\t\ttexture = parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ].extendTexture( texture, transform );\n\t\t\t\t\tparser.associations.set( texture, gltfReference );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( colorSpace !== undefined ) {\n\n\t\t\t\ttexture.colorSpace = colorSpace;\n\n\t\t\t}\n\n\t\t\tmaterialParams[ mapName ] = texture;\n\n\t\t\treturn texture;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Assigns final material to a Mesh, Line, or Points instance. The instance\n\t * already has a material (generated from the glTF material options alone)\n\t * but reuse of the same glTF material may require multiple threejs materials\n\t * to accommodate different primitive types, defines, etc. New materials will\n\t * be created if necessary, and reused from a cache.\n\t * @param  {Object3D} mesh Mesh, Line, or Points instance.\n\t */\n\tassignFinalMaterial( mesh ) {\n\n\t\tconst geometry = mesh.geometry;\n\t\tlet material = mesh.material;\n\n\t\tconst useDerivativeTangents = geometry.attributes.tangent === undefined;\n\t\tconst useVertexColors = geometry.attributes.color !== undefined;\n\t\tconst useFlatShading = geometry.attributes.normal === undefined;\n\n\t\tif ( mesh.isPoints ) {\n\n\t\t\tconst cacheKey = 'PointsMaterial:' + material.uuid;\n\n\t\t\tlet pointsMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! pointsMaterial ) {\n\n\t\t\t\tpointsMaterial = new PointsMaterial();\n\t\t\t\tMaterial.prototype.copy.call( pointsMaterial, material );\n\t\t\t\tpointsMaterial.color.copy( material.color );\n\t\t\t\tpointsMaterial.map = material.map;\n\t\t\t\tpointsMaterial.sizeAttenuation = false; // glTF spec says points should be 1px\n\n\t\t\t\tthis.cache.add( cacheKey, pointsMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = pointsMaterial;\n\n\t\t} else if ( mesh.isLine ) {\n\n\t\t\tconst cacheKey = 'LineBasicMaterial:' + material.uuid;\n\n\t\t\tlet lineMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! lineMaterial ) {\n\n\t\t\t\tlineMaterial = new LineBasicMaterial();\n\t\t\t\tMaterial.prototype.copy.call( lineMaterial, material );\n\t\t\t\tlineMaterial.color.copy( material.color );\n\t\t\t\tlineMaterial.map = material.map;\n\n\t\t\t\tthis.cache.add( cacheKey, lineMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = lineMaterial;\n\n\t\t}\n\n\t\t// Clone the material if it will be modified\n\t\tif ( useDerivativeTangents || useVertexColors || useFlatShading ) {\n\n\t\t\tlet cacheKey = 'ClonedMaterial:' + material.uuid + ':';\n\n\t\t\tif ( useDerivativeTangents ) cacheKey += 'derivative-tangents:';\n\t\t\tif ( useVertexColors ) cacheKey += 'vertex-colors:';\n\t\t\tif ( useFlatShading ) cacheKey += 'flat-shading:';\n\n\t\t\tlet cachedMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! cachedMaterial ) {\n\n\t\t\t\tcachedMaterial = material.clone();\n\n\t\t\t\tif ( useVertexColors ) cachedMaterial.vertexColors = true;\n\t\t\t\tif ( useFlatShading ) cachedMaterial.flatShading = true;\n\n\t\t\t\tif ( useDerivativeTangents ) {\n\n\t\t\t\t\t// https://github.com/mrdoob/three.js/issues/11438#issuecomment-507003995\n\t\t\t\t\tif ( cachedMaterial.normalScale ) cachedMaterial.normalScale.y *= - 1;\n\t\t\t\t\tif ( cachedMaterial.clearcoatNormalScale ) cachedMaterial.clearcoatNormalScale.y *= - 1;\n\n\t\t\t\t}\n\n\t\t\t\tthis.cache.add( cacheKey, cachedMaterial );\n\n\t\t\t\tthis.associations.set( cachedMaterial, this.associations.get( material ) );\n\n\t\t\t}\n\n\t\t\tmaterial = cachedMaterial;\n\n\t\t}\n\n\t\tmesh.material = material;\n\n\t}\n\n\tgetMaterialType( /* materialIndex */ ) {\n\n\t\treturn MeshStandardMaterial;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials\n\t * @param {number} materialIndex\n\t * @return {Promise<Material>}\n\t */\n\tloadMaterial( materialIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\t\tconst materialDef = json.materials[ materialIndex ];\n\n\t\tlet materialType;\n\t\tconst materialParams = {};\n\t\tconst materialExtensions = materialDef.extensions || {};\n\n\t\tconst pending = [];\n\n\t\tif ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ] ) {\n\n\t\t\tconst kmuExtension = extensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ];\n\t\t\tmaterialType = kmuExtension.getMaterialType();\n\t\t\tpending.push( kmuExtension.extendParams( materialParams, materialDef, parser ) );\n\n\t\t} else {\n\n\t\t\t// Specification:\n\t\t\t// https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#metallic-roughness-material\n\n\t\t\tconst metallicRoughness = materialDef.pbrMetallicRoughness || {};\n\n\t\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\t\tmaterialParams.opacity = 1.0;\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tconst array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.setRGB( array[ 0 ], array[ 1 ], array[ 2 ], LinearSRGBColorSpace );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture, SRGBColorSpace ) );\n\n\t\t\t}\n\n\t\t\tmaterialParams.metalness = metallicRoughness.metallicFactor !== undefined ? metallicRoughness.metallicFactor : 1.0;\n\t\t\tmaterialParams.roughness = metallicRoughness.roughnessFactor !== undefined ? metallicRoughness.roughnessFactor : 1.0;\n\n\t\t\tif ( metallicRoughness.metallicRoughnessTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'metalnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'roughnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\n\t\t\t}\n\n\t\t\tmaterialType = this._invokeOne( function ( ext ) {\n\n\t\t\t\treturn ext.getMaterialType && ext.getMaterialType( materialIndex );\n\n\t\t\t} );\n\n\t\t\tpending.push( Promise.all( this._invokeAll( function ( ext ) {\n\n\t\t\t\treturn ext.extendMaterialParams && ext.extendMaterialParams( materialIndex, materialParams );\n\n\t\t\t} ) ) );\n\n\t\t}\n\n\t\tif ( materialDef.doubleSided === true ) {\n\n\t\t\tmaterialParams.side = DoubleSide;\n\n\t\t}\n\n\t\tconst alphaMode = materialDef.alphaMode || ALPHA_MODES.OPAQUE;\n\n\t\tif ( alphaMode === ALPHA_MODES.BLEND ) {\n\n\t\t\tmaterialParams.transparent = true;\n\n\t\t\t// See: https://github.com/mrdoob/three.js/issues/17706\n\t\t\tmaterialParams.depthWrite = false;\n\n\t\t} else {\n\n\t\t\tmaterialParams.transparent = false;\n\n\t\t\tif ( alphaMode === ALPHA_MODES.MASK ) {\n\n\t\t\t\tmaterialParams.alphaTest = materialDef.alphaCutoff !== undefined ? materialDef.alphaCutoff : 0.5;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.normalTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'normalMap', materialDef.normalTexture ) );\n\n\t\t\tmaterialParams.normalScale = new Vector2( 1, 1 );\n\n\t\t\tif ( materialDef.normalTexture.scale !== undefined ) {\n\n\t\t\t\tconst scale = materialDef.normalTexture.scale;\n\n\t\t\t\tmaterialParams.normalScale.set( scale, scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.occlusionTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'aoMap', materialDef.occlusionTexture ) );\n\n\t\t\tif ( materialDef.occlusionTexture.strength !== undefined ) {\n\n\t\t\t\tmaterialParams.aoMapIntensity = materialDef.occlusionTexture.strength;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.emissiveFactor !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tconst emissiveFactor = materialDef.emissiveFactor;\n\t\t\tmaterialParams.emissive = new Color().setRGB( emissiveFactor[ 0 ], emissiveFactor[ 1 ], emissiveFactor[ 2 ], LinearSRGBColorSpace );\n\n\t\t}\n\n\t\tif ( materialDef.emissiveTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'emissiveMap', materialDef.emissiveTexture, SRGBColorSpace ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\tconst material = new materialType( materialParams );\n\n\t\t\tif ( materialDef.name ) material.name = materialDef.name;\n\n\t\t\tassignExtrasToUserData( material, materialDef );\n\n\t\t\tparser.associations.set( material, { materials: materialIndex } );\n\n\t\t\tif ( materialDef.extensions ) addUnknownExtensionsToUserData( extensions, material, materialDef );\n\n\t\t\treturn material;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * When Object3D instances are targeted by animation, they need unique names.\n\t *\n\t * @param {String} originalName\n\t * @return {String}\n\t */\n\tcreateUniqueName( originalName ) {\n\n\t\tconst sanitizedName = PropertyBinding.sanitizeNodeName( originalName || '' );\n\n\t\tif ( sanitizedName in this.nodeNamesUsed ) {\n\n\t\t\treturn sanitizedName + '_' + ( ++ this.nodeNamesUsed[ sanitizedName ] );\n\n\t\t} else {\n\n\t\t\tthis.nodeNamesUsed[ sanitizedName ] = 0;\n\n\t\t\treturn sanitizedName;\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#geometry\n\t *\n\t * Creates BufferGeometries from primitives.\n\t *\n\t * @param {Array<GLTF.Primitive>} primitives\n\t * @return {Promise<Array<BufferGeometry>>}\n\t */\n\tloadGeometries( primitives ) {\n\n\t\tconst parser = this;\n\t\tconst extensions = this.extensions;\n\t\tconst cache = this.primitiveCache;\n\n\t\tfunction createDracoPrimitive( primitive ) {\n\n\t\t\treturn extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ]\n\t\t\t\t.decodePrimitive( primitive, parser )\n\t\t\t\t.then( function ( geometry ) {\n\n\t\t\t\t\treturn addPrimitiveAttributes( geometry, primitive, parser );\n\n\t\t\t\t} );\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tconst primitive = primitives[ i ];\n\t\t\tconst cacheKey = createPrimitiveKey( primitive );\n\n\t\t\t// See if we've already created this geometry\n\t\t\tconst cached = cache[ cacheKey ];\n\n\t\t\tif ( cached ) {\n\n\t\t\t\t// Use the cached geometry if it exists\n\t\t\t\tpending.push( cached.promise );\n\n\t\t\t} else {\n\n\t\t\t\tlet geometryPromise;\n\n\t\t\t\tif ( primitive.extensions && primitive.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ] ) {\n\n\t\t\t\t\t// Use DRACO geometry if available\n\t\t\t\t\tgeometryPromise = createDracoPrimitive( primitive );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Otherwise create a new geometry\n\t\t\t\t\tgeometryPromise = addPrimitiveAttributes( new BufferGeometry(), primitive, parser );\n\n\t\t\t\t}\n\n\t\t\t\t// Cache this geometry\n\t\t\t\tcache[ cacheKey ] = { primitive: primitive, promise: geometryPromise };\n\n\t\t\t\tpending.push( geometryPromise );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes\n\t * @param {number} meshIndex\n\t * @return {Promise<Group|Mesh|SkinnedMesh>}\n\t */\n\tloadMesh( meshIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\n\t\tconst meshDef = json.meshes[ meshIndex ];\n\t\tconst primitives = meshDef.primitives;\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tconst material = primitives[ i ].material === undefined\n\t\t\t\t? createDefaultMaterial( this.cache )\n\t\t\t\t: this.getDependency( 'material', primitives[ i ].material );\n\n\t\t\tpending.push( material );\n\n\t\t}\n\n\t\tpending.push( parser.loadGeometries( primitives ) );\n\n\t\treturn Promise.all( pending ).then( function ( results ) {\n\n\t\t\tconst materials = results.slice( 0, results.length - 1 );\n\t\t\tconst geometries = results[ results.length - 1 ];\n\n\t\t\tconst meshes = [];\n\n\t\t\tfor ( let i = 0, il = geometries.length; i < il; i ++ ) {\n\n\t\t\t\tconst geometry = geometries[ i ];\n\t\t\t\tconst primitive = primitives[ i ];\n\n\t\t\t\t// 1. create Mesh\n\n\t\t\t\tlet mesh;\n\n\t\t\t\tconst material = materials[ i ];\n\n\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLES ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ||\n\t\t\t\t\t\tprimitive.mode === undefined ) {\n\n\t\t\t\t\t// .isSkinnedMesh isn't in glTF spec. See ._markDefs()\n\t\t\t\t\tmesh = meshDef.isSkinnedMesh === true\n\t\t\t\t\t\t? new SkinnedMesh( geometry, material )\n\t\t\t\t\t\t: new Mesh( geometry, material );\n\n\t\t\t\t\tif ( mesh.isSkinnedMesh === true ) {\n\n\t\t\t\t\t\t// normalize skin weights to fix malformed assets (see #15319)\n\t\t\t\t\t\tmesh.normalizeSkinWeights();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ) {\n\n\t\t\t\t\t\tmesh.geometry = toTrianglesDrawMode( mesh.geometry, TriangleStripDrawMode );\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ) {\n\n\t\t\t\t\t\tmesh.geometry = toTrianglesDrawMode( mesh.geometry, TriangleFanDrawMode );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINES ) {\n\n\t\t\t\t\tmesh = new LineSegments( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_STRIP ) {\n\n\t\t\t\t\tmesh = new Line( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_LOOP ) {\n\n\t\t\t\t\tmesh = new LineLoop( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.POINTS ) {\n\n\t\t\t\t\tmesh = new Points( geometry, material );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Primitive mode unsupported: ' + primitive.mode );\n\n\t\t\t\t}\n\n\t\t\t\tif ( Object.keys( mesh.geometry.morphAttributes ).length > 0 ) {\n\n\t\t\t\t\tupdateMorphTargets( mesh, meshDef );\n\n\t\t\t\t}\n\n\t\t\t\tmesh.name = parser.createUniqueName( meshDef.name || ( 'mesh_' + meshIndex ) );\n\n\t\t\t\tassignExtrasToUserData( mesh, meshDef );\n\n\t\t\t\tif ( primitive.extensions ) addUnknownExtensionsToUserData( extensions, mesh, primitive );\n\n\t\t\t\tparser.assignFinalMaterial( mesh );\n\n\t\t\t\tmeshes.push( mesh );\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\tparser.associations.set( meshes[ i ], {\n\t\t\t\t\tmeshes: meshIndex,\n\t\t\t\t\tprimitives: i\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tif ( meshes.length === 1 ) {\n\n\t\t\t\tif ( meshDef.extensions ) addUnknownExtensionsToUserData( extensions, meshes[ 0 ], meshDef );\n\n\t\t\t\treturn meshes[ 0 ];\n\n\t\t\t}\n\n\t\t\tconst group = new Group();\n\n\t\t\tif ( meshDef.extensions ) addUnknownExtensionsToUserData( extensions, group, meshDef );\n\n\t\t\tparser.associations.set( group, { meshes: meshIndex } );\n\n\t\t\tfor ( let i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\tgroup.add( meshes[ i ] );\n\n\t\t\t}\n\n\t\t\treturn group;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras\n\t * @param {number} cameraIndex\n\t * @return {Promise<THREE.Camera>}\n\t */\n\tloadCamera( cameraIndex ) {\n\n\t\tlet camera;\n\t\tconst cameraDef = this.json.cameras[ cameraIndex ];\n\t\tconst params = cameraDef[ cameraDef.type ];\n\n\t\tif ( ! params ) {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing camera parameters.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( cameraDef.type === 'perspective' ) {\n\n\t\t\tcamera = new PerspectiveCamera( MathUtils.radToDeg( params.yfov ), params.aspectRatio || 1, params.znear || 1, params.zfar || 2e6 );\n\n\t\t} else if ( cameraDef.type === 'orthographic' ) {\n\n\t\t\tcamera = new OrthographicCamera( - params.xmag, params.xmag, params.ymag, - params.ymag, params.znear, params.zfar );\n\n\t\t}\n\n\t\tif ( cameraDef.name ) camera.name = this.createUniqueName( cameraDef.name );\n\n\t\tassignExtrasToUserData( camera, cameraDef );\n\n\t\treturn Promise.resolve( camera );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#skins\n\t * @param {number} skinIndex\n\t * @return {Promise<Skeleton>}\n\t */\n\tloadSkin( skinIndex ) {\n\n\t\tconst skinDef = this.json.skins[ skinIndex ];\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = skinDef.joints.length; i < il; i ++ ) {\n\n\t\t\tpending.push( this._loadNodeShallow( skinDef.joints[ i ] ) );\n\n\t\t}\n\n\t\tif ( skinDef.inverseBindMatrices !== undefined ) {\n\n\t\t\tpending.push( this.getDependency( 'accessor', skinDef.inverseBindMatrices ) );\n\n\t\t} else {\n\n\t\t\tpending.push( null );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function ( results ) {\n\n\t\t\tconst inverseBindMatrices = results.pop();\n\t\t\tconst jointNodes = results;\n\n\t\t\t// Note that bones (joint nodes) may or may not be in the\n\t\t\t// scene graph at this time.\n\n\t\t\tconst bones = [];\n\t\t\tconst boneInverses = [];\n\n\t\t\tfor ( let i = 0, il = jointNodes.length; i < il; i ++ ) {\n\n\t\t\t\tconst jointNode = jointNodes[ i ];\n\n\t\t\t\tif ( jointNode ) {\n\n\t\t\t\t\tbones.push( jointNode );\n\n\t\t\t\t\tconst mat = new Matrix4();\n\n\t\t\t\t\tif ( inverseBindMatrices !== null ) {\n\n\t\t\t\t\t\tmat.fromArray( inverseBindMatrices.array, i * 16 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tboneInverses.push( mat );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Joint \"%s\" could not be found.', skinDef.joints[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new Skeleton( bones, boneInverses );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#animations\n\t * @param {number} animationIndex\n\t * @return {Promise<AnimationClip>}\n\t */\n\tloadAnimation( animationIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst parser = this;\n\n\t\tconst animationDef = json.animations[ animationIndex ];\n\t\tconst animationName = animationDef.name ? animationDef.name : 'animation_' + animationIndex;\n\n\t\tconst pendingNodes = [];\n\t\tconst pendingInputAccessors = [];\n\t\tconst pendingOutputAccessors = [];\n\t\tconst pendingSamplers = [];\n\t\tconst pendingTargets = [];\n\n\t\tfor ( let i = 0, il = animationDef.channels.length; i < il; i ++ ) {\n\n\t\t\tconst channel = animationDef.channels[ i ];\n\t\t\tconst sampler = animationDef.samplers[ channel.sampler ];\n\t\t\tconst target = channel.target;\n\t\t\tconst name = target.node;\n\t\t\tconst input = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.input ] : sampler.input;\n\t\t\tconst output = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.output ] : sampler.output;\n\n\t\t\tif ( target.node === undefined ) continue;\n\n\t\t\tpendingNodes.push( this.getDependency( 'node', name ) );\n\t\t\tpendingInputAccessors.push( this.getDependency( 'accessor', input ) );\n\t\t\tpendingOutputAccessors.push( this.getDependency( 'accessor', output ) );\n\t\t\tpendingSamplers.push( sampler );\n\t\t\tpendingTargets.push( target );\n\n\t\t}\n\n\t\treturn Promise.all( [\n\n\t\t\tPromise.all( pendingNodes ),\n\t\t\tPromise.all( pendingInputAccessors ),\n\t\t\tPromise.all( pendingOutputAccessors ),\n\t\t\tPromise.all( pendingSamplers ),\n\t\t\tPromise.all( pendingTargets )\n\n\t\t] ).then( function ( dependencies ) {\n\n\t\t\tconst nodes = dependencies[ 0 ];\n\t\t\tconst inputAccessors = dependencies[ 1 ];\n\t\t\tconst outputAccessors = dependencies[ 2 ];\n\t\t\tconst samplers = dependencies[ 3 ];\n\t\t\tconst targets = dependencies[ 4 ];\n\n\t\t\tconst tracks = [];\n\n\t\t\tfor ( let i = 0, il = nodes.length; i < il; i ++ ) {\n\n\t\t\t\tconst node = nodes[ i ];\n\t\t\t\tconst inputAccessor = inputAccessors[ i ];\n\t\t\t\tconst outputAccessor = outputAccessors[ i ];\n\t\t\t\tconst sampler = samplers[ i ];\n\t\t\t\tconst target = targets[ i ];\n\n\t\t\t\tif ( node === undefined ) continue;\n\n\t\t\t\tif ( node.updateMatrix ) {\n\n\t\t\t\t\tnode.updateMatrix();\n\n\t\t\t\t}\n\n\t\t\t\tconst createdTracks = parser._createAnimationTracks( node, inputAccessor, outputAccessor, sampler, target );\n\n\t\t\t\tif ( createdTracks ) {\n\n\t\t\t\t\tfor ( let k = 0; k < createdTracks.length; k ++ ) {\n\n\t\t\t\t\t\ttracks.push( createdTracks[ k ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new AnimationClip( animationName, undefined, tracks );\n\n\t\t} );\n\n\t}\n\n\tcreateNodeMesh( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst parser = this;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\tif ( nodeDef.mesh === undefined ) return null;\n\n\t\treturn parser.getDependency( 'mesh', nodeDef.mesh ).then( function ( mesh ) {\n\n\t\t\tconst node = parser._getNodeRef( parser.meshCache, nodeDef.mesh, mesh );\n\n\t\t\t// if weights are provided on the node, override weights on the mesh.\n\t\t\tif ( nodeDef.weights !== undefined ) {\n\n\t\t\t\tnode.traverse( function ( o ) {\n\n\t\t\t\t\tif ( ! o.isMesh ) return;\n\n\t\t\t\t\tfor ( let i = 0, il = nodeDef.weights.length; i < il; i ++ ) {\n\n\t\t\t\t\t\to.morphTargetInfluences[ i ] = nodeDef.weights[ i ];\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#nodes-and-hierarchy\n\t * @param {number} nodeIndex\n\t * @return {Promise<Object3D>}\n\t */\n\tloadNode( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst parser = this;\n\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\tconst nodePending = parser._loadNodeShallow( nodeIndex );\n\n\t\tconst childPending = [];\n\t\tconst childrenDef = nodeDef.children || [];\n\n\t\tfor ( let i = 0, il = childrenDef.length; i < il; i ++ ) {\n\n\t\t\tchildPending.push( parser.getDependency( 'node', childrenDef[ i ] ) );\n\n\t\t}\n\n\t\tconst skeletonPending = nodeDef.skin === undefined\n\t\t\t? Promise.resolve( null )\n\t\t\t: parser.getDependency( 'skin', nodeDef.skin );\n\n\t\treturn Promise.all( [\n\t\t\tnodePending,\n\t\t\tPromise.all( childPending ),\n\t\t\tskeletonPending\n\t\t] ).then( function ( results ) {\n\n\t\t\tconst node = results[ 0 ];\n\t\t\tconst children = results[ 1 ];\n\t\t\tconst skeleton = results[ 2 ];\n\n\t\t\tif ( skeleton !== null ) {\n\n\t\t\t\t// This full traverse should be fine because\n\t\t\t\t// child glTF nodes have not been added to this node yet.\n\t\t\t\tnode.traverse( function ( mesh ) {\n\n\t\t\t\t\tif ( ! mesh.isSkinnedMesh ) return;\n\n\t\t\t\t\tmesh.bind( skeleton, _identityMatrix );\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, il = children.length; i < il; i ++ ) {\n\n\t\t\t\tnode.add( children[ i ] );\n\n\t\t\t}\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t}\n\n\t// ._loadNodeShallow() parses a single node.\n\t// skin and child nodes are created and added in .loadNode() (no '_' prefix).\n\t_loadNodeShallow( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\t\tconst parser = this;\n\n\t\t// This method is called from .loadNode() and .loadSkin().\n\t\t// Cache a node to avoid duplication.\n\n\t\tif ( this.nodeCache[ nodeIndex ] !== undefined ) {\n\n\t\t\treturn this.nodeCache[ nodeIndex ];\n\n\t\t}\n\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\t// reserve node's name before its dependencies, so the root has the intended name.\n\t\tconst nodeName = nodeDef.name ? parser.createUniqueName( nodeDef.name ) : '';\n\n\t\tconst pending = [];\n\n\t\tconst meshPromise = parser._invokeOne( function ( ext ) {\n\n\t\t\treturn ext.createNodeMesh && ext.createNodeMesh( nodeIndex );\n\n\t\t} );\n\n\t\tif ( meshPromise ) {\n\n\t\t\tpending.push( meshPromise );\n\n\t\t}\n\n\t\tif ( nodeDef.camera !== undefined ) {\n\n\t\t\tpending.push( parser.getDependency( 'camera', nodeDef.camera ).then( function ( camera ) {\n\n\t\t\t\treturn parser._getNodeRef( parser.cameraCache, nodeDef.camera, camera );\n\n\t\t\t} ) );\n\n\t\t}\n\n\t\tparser._invokeAll( function ( ext ) {\n\n\t\t\treturn ext.createNodeAttachment && ext.createNodeAttachment( nodeIndex );\n\n\t\t} ).forEach( function ( promise ) {\n\n\t\t\tpending.push( promise );\n\n\t\t} );\n\n\t\tthis.nodeCache[ nodeIndex ] = Promise.all( pending ).then( function ( objects ) {\n\n\t\t\tlet node;\n\n\t\t\t// .isBone isn't in glTF spec. See ._markDefs\n\t\t\tif ( nodeDef.isBone === true ) {\n\n\t\t\t\tnode = new Bone();\n\n\t\t\t} else if ( objects.length > 1 ) {\n\n\t\t\t\tnode = new Group();\n\n\t\t\t} else if ( objects.length === 1 ) {\n\n\t\t\t\tnode = objects[ 0 ];\n\n\t\t\t} else {\n\n\t\t\t\tnode = new Object3D();\n\n\t\t\t}\n\n\t\t\tif ( node !== objects[ 0 ] ) {\n\n\t\t\t\tfor ( let i = 0, il = objects.length; i < il; i ++ ) {\n\n\t\t\t\t\tnode.add( objects[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.name ) {\n\n\t\t\t\tnode.userData.name = nodeDef.name;\n\t\t\t\tnode.name = nodeName;\n\n\t\t\t}\n\n\t\t\tassignExtrasToUserData( node, nodeDef );\n\n\t\t\tif ( nodeDef.extensions ) addUnknownExtensionsToUserData( extensions, node, nodeDef );\n\n\t\t\tif ( nodeDef.matrix !== undefined ) {\n\n\t\t\t\tconst matrix = new Matrix4();\n\t\t\t\tmatrix.fromArray( nodeDef.matrix );\n\t\t\t\tnode.applyMatrix4( matrix );\n\n\t\t\t} else {\n\n\t\t\t\tif ( nodeDef.translation !== undefined ) {\n\n\t\t\t\t\tnode.position.fromArray( nodeDef.translation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.rotation !== undefined ) {\n\n\t\t\t\t\tnode.quaternion.fromArray( nodeDef.rotation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.scale !== undefined ) {\n\n\t\t\t\t\tnode.scale.fromArray( nodeDef.scale );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( ! parser.associations.has( node ) ) {\n\n\t\t\t\tparser.associations.set( node, {} );\n\n\t\t\t}\n\n\t\t\tparser.associations.get( node ).nodes = nodeIndex;\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t\treturn this.nodeCache[ nodeIndex ];\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#scenes\n\t * @param {number} sceneIndex\n\t * @return {Promise<Group>}\n\t */\n\tloadScene( sceneIndex ) {\n\n\t\tconst extensions = this.extensions;\n\t\tconst sceneDef = this.json.scenes[ sceneIndex ];\n\t\tconst parser = this;\n\n\t\t// Loader returns Group, not Scene.\n\t\t// See: https://github.com/mrdoob/three.js/issues/18342#issuecomment-578981172\n\t\tconst scene = new Group();\n\t\tif ( sceneDef.name ) scene.name = parser.createUniqueName( sceneDef.name );\n\n\t\tassignExtrasToUserData( scene, sceneDef );\n\n\t\tif ( sceneDef.extensions ) addUnknownExtensionsToUserData( extensions, scene, sceneDef );\n\n\t\tconst nodeIds = sceneDef.nodes || [];\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = nodeIds.length; i < il; i ++ ) {\n\n\t\t\tpending.push( parser.getDependency( 'node', nodeIds[ i ] ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function ( nodes ) {\n\n\t\t\tfor ( let i = 0, il = nodes.length; i < il; i ++ ) {\n\n\t\t\t\tscene.add( nodes[ i ] );\n\n\t\t\t}\n\n\t\t\t// Removes dangling associations, associations that reference a node that\n\t\t\t// didn't make it into the scene.\n\t\t\tconst reduceAssociations = ( node ) => {\n\n\t\t\t\tconst reducedAssociations = new Map();\n\n\t\t\t\tfor ( const [ key, value ] of parser.associations ) {\n\n\t\t\t\t\tif ( key instanceof Material || key instanceof Texture ) {\n\n\t\t\t\t\t\treducedAssociations.set( key, value );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tnode.traverse( ( node ) => {\n\n\t\t\t\t\tconst mappings = parser.associations.get( node );\n\n\t\t\t\t\tif ( mappings != null ) {\n\n\t\t\t\t\t\treducedAssociations.set( node, mappings );\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\treturn reducedAssociations;\n\n\t\t\t};\n\n\t\t\tparser.associations = reduceAssociations( scene );\n\n\t\t\treturn scene;\n\n\t\t} );\n\n\t}\n\n\t_createAnimationTracks( node, inputAccessor, outputAccessor, sampler, target ) {\n\n\t\tconst tracks = [];\n\n\t\tconst targetName = node.name ? node.name : node.uuid;\n\t\tconst targetNames = [];\n\n\t\tif ( PATH_PROPERTIES[ target.path ] === PATH_PROPERTIES.weights ) {\n\n\t\t\tnode.traverse( function ( object ) {\n\n\t\t\t\tif ( object.morphTargetInfluences ) {\n\n\t\t\t\t\ttargetNames.push( object.name ? object.name : object.uuid );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} else {\n\n\t\t\ttargetNames.push( targetName );\n\n\t\t}\n\n\t\tlet TypedKeyframeTrack;\n\n\t\tswitch ( PATH_PROPERTIES[ target.path ] ) {\n\n\t\t\tcase PATH_PROPERTIES.weights:\n\n\t\t\t\tTypedKeyframeTrack = NumberKeyframeTrack;\n\t\t\t\tbreak;\n\n\t\t\tcase PATH_PROPERTIES.rotation:\n\n\t\t\t\tTypedKeyframeTrack = QuaternionKeyframeTrack;\n\t\t\t\tbreak;\n\n\t\t\tcase PATH_PROPERTIES.position:\n\t\t\tcase PATH_PROPERTIES.scale:\n\n\t\t\t\tTypedKeyframeTrack = VectorKeyframeTrack;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tswitch ( outputAccessor.itemSize ) {\n\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tTypedKeyframeTrack = NumberKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\tcase 3:\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tTypedKeyframeTrack = VectorKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tconst interpolation = sampler.interpolation !== undefined ? INTERPOLATION[ sampler.interpolation ] : InterpolateLinear;\n\n\n\t\tconst outputArray = this._getArrayFromAccessor( outputAccessor );\n\n\t\tfor ( let j = 0, jl = targetNames.length; j < jl; j ++ ) {\n\n\t\t\tconst track = new TypedKeyframeTrack(\n\t\t\t\ttargetNames[ j ] + '.' + PATH_PROPERTIES[ target.path ],\n\t\t\t\tinputAccessor.array,\n\t\t\t\toutputArray,\n\t\t\t\tinterpolation\n\t\t\t);\n\n\t\t\t// Override interpolation with custom factory method.\n\t\t\tif ( sampler.interpolation === 'CUBICSPLINE' ) {\n\n\t\t\t\tthis._createCubicSplineTrackInterpolant( track );\n\n\t\t\t}\n\n\t\t\ttracks.push( track );\n\n\t\t}\n\n\t\treturn tracks;\n\n\t}\n\n\t_getArrayFromAccessor( accessor ) {\n\n\t\tlet outputArray = accessor.array;\n\n\t\tif ( accessor.normalized ) {\n\n\t\t\tconst scale = getNormalizedComponentScale( outputArray.constructor );\n\t\t\tconst scaled = new Float32Array( outputArray.length );\n\n\t\t\tfor ( let j = 0, jl = outputArray.length; j < jl; j ++ ) {\n\n\t\t\t\tscaled[ j ] = outputArray[ j ] * scale;\n\n\t\t\t}\n\n\t\t\toutputArray = scaled;\n\n\t\t}\n\n\t\treturn outputArray;\n\n\t}\n\n\t_createCubicSplineTrackInterpolant( track ) {\n\n\t\ttrack.createInterpolant = function InterpolantFactoryMethodGLTFCubicSpline( result ) {\n\n\t\t\t// A CUBICSPLINE keyframe in glTF has three output values for each input value,\n\t\t\t// representing inTangent, splineVertex, and outTangent. As a result, track.getValueSize()\n\t\t\t// must be divided by three to get the interpolant's sampleSize argument.\n\n\t\t\tconst interpolantType = ( this instanceof QuaternionKeyframeTrack ) ? GLTFCubicSplineQuaternionInterpolant : GLTFCubicSplineInterpolant;\n\n\t\t\treturn new interpolantType( this.times, this.values, this.getValueSize() / 3, result );\n\n\t\t};\n\n\t\t// Mark as CUBICSPLINE. `track.getInterpolation()` doesn't support custom interpolants.\n\t\ttrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline = true;\n\n\t}\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {GLTF.Primitive} primitiveDef\n * @param {GLTFParser} parser\n */\nfunction computeBounds( geometry, primitiveDef, parser ) {\n\n\tconst attributes = primitiveDef.attributes;\n\n\tconst box = new Box3();\n\n\tif ( attributes.POSITION !== undefined ) {\n\n\t\tconst accessor = parser.json.accessors[ attributes.POSITION ];\n\n\t\tconst min = accessor.min;\n\t\tconst max = accessor.max;\n\n\t\t// glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n\t\tif ( min !== undefined && max !== undefined ) {\n\n\t\t\tbox.set(\n\t\t\t\tnew Vector3( min[ 0 ], min[ 1 ], min[ 2 ] ),\n\t\t\t\tnew Vector3( max[ 0 ], max[ 1 ], max[ 2 ] )\n\t\t\t);\n\n\t\t\tif ( accessor.normalized ) {\n\n\t\t\t\tconst boxScale = getNormalizedComponentScale( WEBGL_COMPONENT_TYPES[ accessor.componentType ] );\n\t\t\t\tbox.min.multiplyScalar( boxScale );\n\t\t\t\tbox.max.multiplyScalar( boxScale );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing min/max properties for accessor POSITION.' );\n\n\t\t\treturn;\n\n\t\t}\n\n\t} else {\n\n\t\treturn;\n\n\t}\n\n\tconst targets = primitiveDef.targets;\n\n\tif ( targets !== undefined ) {\n\n\t\tconst maxDisplacement = new Vector3();\n\t\tconst vector = new Vector3();\n\n\t\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\t\tconst target = targets[ i ];\n\n\t\t\tif ( target.POSITION !== undefined ) {\n\n\t\t\t\tconst accessor = parser.json.accessors[ target.POSITION ];\n\t\t\t\tconst min = accessor.min;\n\t\t\t\tconst max = accessor.max;\n\n\t\t\t\t// glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n\t\t\t\tif ( min !== undefined && max !== undefined ) {\n\n\t\t\t\t\t// we need to get max of absolute components because target weight is [-1,1]\n\t\t\t\t\tvector.setX( Math.max( Math.abs( min[ 0 ] ), Math.abs( max[ 0 ] ) ) );\n\t\t\t\t\tvector.setY( Math.max( Math.abs( min[ 1 ] ), Math.abs( max[ 1 ] ) ) );\n\t\t\t\t\tvector.setZ( Math.max( Math.abs( min[ 2 ] ), Math.abs( max[ 2 ] ) ) );\n\n\n\t\t\t\t\tif ( accessor.normalized ) {\n\n\t\t\t\t\t\tconst boxScale = getNormalizedComponentScale( WEBGL_COMPONENT_TYPES[ accessor.componentType ] );\n\t\t\t\t\t\tvector.multiplyScalar( boxScale );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Note: this assumes that the sum of all weights is at most 1. This isn't quite correct - it's more conservative\n\t\t\t\t\t// to assume that each target can have a max weight of 1. However, for some use cases - notably, when morph targets\n\t\t\t\t\t// are used to implement key-frame animations and as such only two are active at a time - this results in very large\n\t\t\t\t\t// boxes. So for now we make a box that's sometimes a touch too small but is hopefully mostly of reasonable size.\n\t\t\t\t\tmaxDisplacement.max( vector );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing min/max properties for accessor POSITION.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// As per comment above this box isn't conservative, but has a reasonable size for a very large number of morph targets.\n\t\tbox.expandByVector( maxDisplacement );\n\n\t}\n\n\tgeometry.boundingBox = box;\n\n\tconst sphere = new Sphere();\n\n\tbox.getCenter( sphere.center );\n\tsphere.radius = box.min.distanceTo( box.max ) / 2;\n\n\tgeometry.boundingSphere = sphere;\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {GLTF.Primitive} primitiveDef\n * @param {GLTFParser} parser\n * @return {Promise<BufferGeometry>}\n */\nfunction addPrimitiveAttributes( geometry, primitiveDef, parser ) {\n\n\tconst attributes = primitiveDef.attributes;\n\n\tconst pending = [];\n\n\tfunction assignAttributeAccessor( accessorIndex, attributeName ) {\n\n\t\treturn parser.getDependency( 'accessor', accessorIndex )\n\t\t\t.then( function ( accessor ) {\n\n\t\t\t\tgeometry.setAttribute( attributeName, accessor );\n\n\t\t\t} );\n\n\t}\n\n\tfor ( const gltfAttributeName in attributes ) {\n\n\t\tconst threeAttributeName = ATTRIBUTES[ gltfAttributeName ] || gltfAttributeName.toLowerCase();\n\n\t\t// Skip attributes already provided by e.g. Draco extension.\n\t\tif ( threeAttributeName in geometry.attributes ) continue;\n\n\t\tpending.push( assignAttributeAccessor( attributes[ gltfAttributeName ], threeAttributeName ) );\n\n\t}\n\n\tif ( primitiveDef.indices !== undefined && ! geometry.index ) {\n\n\t\tconst accessor = parser.getDependency( 'accessor', primitiveDef.indices ).then( function ( accessor ) {\n\n\t\t\tgeometry.setIndex( accessor );\n\n\t\t} );\n\n\t\tpending.push( accessor );\n\n\t}\n\n\tif ( ColorManagement.workingColorSpace !== LinearSRGBColorSpace && 'COLOR_0' in attributes ) {\n\n\t\tconsole.warn( `THREE.GLTFLoader: Converting vertex colors from \"srgb-linear\" to \"${ColorManagement.workingColorSpace}\" not supported.` );\n\n\t}\n\n\tassignExtrasToUserData( geometry, primitiveDef );\n\n\tcomputeBounds( geometry, primitiveDef, parser );\n\n\treturn Promise.all( pending ).then( function () {\n\n\t\treturn primitiveDef.targets !== undefined\n\t\t\t? addMorphTargets( geometry, primitiveDef.targets, parser )\n\t\t\t: geometry;\n\n\t} );\n\n}\n\nexport { GLTFLoader };\n","/**\n * Full-screen textured quad shader\n */\n\nconst CopyShader = {\n\n\tname: 'CopyShader',\n\n\tuniforms: {\n\n\t\t'tDiffuse': { value: null },\n\t\t'opacity': { value: 1.0 }\n\n\t},\n\n\tvertexShader: /* glsl */`\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}`,\n\n\tfragmentShader: /* glsl */`\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\n\t\t}`\n\n};\n\nexport { CopyShader };\n","import {\n\tShaderMaterial,\n\tUniformsUtils\n} from 'three';\nimport { Pass, FullScreenQuad } from './Pass.js';\n\nclass ShaderPass extends Pass {\n\n\tconstructor( shader, textureID ) {\n\n\t\tsuper();\n\n\t\tthis.textureID = ( textureID !== undefined ) ? textureID : 'tDiffuse';\n\n\t\tif ( shader instanceof ShaderMaterial ) {\n\n\t\t\tthis.uniforms = shader.uniforms;\n\n\t\t\tthis.material = shader;\n\n\t\t} else if ( shader ) {\n\n\t\t\tthis.uniforms = UniformsUtils.clone( shader.uniforms );\n\n\t\t\tthis.material = new ShaderMaterial( {\n\n\t\t\t\tname: ( shader.name !== undefined ) ? shader.name : 'unspecified',\n\t\t\t\tdefines: Object.assign( {}, shader.defines ),\n\t\t\t\tuniforms: this.uniforms,\n\t\t\t\tvertexShader: shader.vertexShader,\n\t\t\t\tfragmentShader: shader.fragmentShader\n\n\t\t\t} );\n\n\t\t}\n\n\t\tthis.fsQuad = new FullScreenQuad( this.material );\n\n\t}\n\n\trender( renderer, writeBuffer, readBuffer /*, deltaTime, maskActive */ ) {\n\n\t\tif ( this.uniforms[ this.textureID ] ) {\n\n\t\t\tthis.uniforms[ this.textureID ].value = readBuffer.texture;\n\n\t\t}\n\n\t\tthis.fsQuad.material = this.material;\n\n\t\tif ( this.renderToScreen ) {\n\n\t\t\trenderer.setRenderTarget( null );\n\t\t\tthis.fsQuad.render( renderer );\n\n\t\t} else {\n\n\t\t\trenderer.setRenderTarget( writeBuffer );\n\t\t\t// TODO: Avoid using autoClear properties, see https://github.com/mrdoob/three.js/pull/15571#issuecomment-465669600\n\t\t\tif ( this.clear ) renderer.clear( renderer.autoClearColor, renderer.autoClearDepth, renderer.autoClearStencil );\n\t\t\tthis.fsQuad.render( renderer );\n\n\t\t}\n\n\t}\n\n\tdispose() {\n\n\t\tthis.material.dispose();\n\n\t\tthis.fsQuad.dispose();\n\n\t}\n\n}\n\nexport { ShaderPass };\n","import { Pass } from './Pass.js';\n\nclass MaskPass extends Pass {\n\n\tconstructor( scene, camera ) {\n\n\t\tsuper();\n\n\t\tthis.scene = scene;\n\t\tthis.camera = camera;\n\n\t\tthis.clear = true;\n\t\tthis.needsSwap = false;\n\n\t\tthis.inverse = false;\n\n\t}\n\n\trender( renderer, writeBuffer, readBuffer /*, deltaTime, maskActive */ ) {\n\n\t\tconst context = renderer.getContext();\n\t\tconst state = renderer.state;\n\n\t\t// don't update color or depth\n\n\t\tstate.buffers.color.setMask( false );\n\t\tstate.buffers.depth.setMask( false );\n\n\t\t// lock buffers\n\n\t\tstate.buffers.color.setLocked( true );\n\t\tstate.buffers.depth.setLocked( true );\n\n\t\t// set up stencil\n\n\t\tlet writeValue, clearValue;\n\n\t\tif ( this.inverse ) {\n\n\t\t\twriteValue = 0;\n\t\t\tclearValue = 1;\n\n\t\t} else {\n\n\t\t\twriteValue = 1;\n\t\t\tclearValue = 0;\n\n\t\t}\n\n\t\tstate.buffers.stencil.setTest( true );\n\t\tstate.buffers.stencil.setOp( context.REPLACE, context.REPLACE, context.REPLACE );\n\t\tstate.buffers.stencil.setFunc( context.ALWAYS, writeValue, 0xffffffff );\n\t\tstate.buffers.stencil.setClear( clearValue );\n\t\tstate.buffers.stencil.setLocked( true );\n\n\t\t// draw into the stencil buffer\n\n\t\trenderer.setRenderTarget( readBuffer );\n\t\tif ( this.clear ) renderer.clear();\n\t\trenderer.render( this.scene, this.camera );\n\n\t\trenderer.setRenderTarget( writeBuffer );\n\t\tif ( this.clear ) renderer.clear();\n\t\trenderer.render( this.scene, this.camera );\n\n\t\t// unlock color and depth buffer and make them writable for subsequent rendering/clearing\n\n\t\tstate.buffers.color.setLocked( false );\n\t\tstate.buffers.depth.setLocked( false );\n\n\t\tstate.buffers.color.setMask( true );\n\t\tstate.buffers.depth.setMask( true );\n\n\t\t// only render where stencil is set to 1\n\n\t\tstate.buffers.stencil.setLocked( false );\n\t\tstate.buffers.stencil.setFunc( context.EQUAL, 1, 0xffffffff ); // draw if == 1\n\t\tstate.buffers.stencil.setOp( context.KEEP, context.KEEP, context.KEEP );\n\t\tstate.buffers.stencil.setLocked( true );\n\n\t}\n\n}\n\nclass ClearMaskPass extends Pass {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.needsSwap = false;\n\n\t}\n\n\trender( renderer /*, writeBuffer, readBuffer, deltaTime, maskActive */ ) {\n\n\t\trenderer.state.buffers.stencil.setLocked( false );\n\t\trenderer.state.buffers.stencil.setTest( false );\n\n\t}\n\n}\n\nexport { MaskPass, ClearMaskPass };\n","import {\n\tClock,\n\tHalfFloatType,\n\tNoBlending,\n\tVector2,\n\tWebGLRenderTarget\n} from 'three';\nimport { CopyShader } from '../shaders/CopyShader.js';\nimport { ShaderPass } from './ShaderPass.js';\nimport { ClearMaskPass, MaskPass } from './MaskPass.js';\n\nclass EffectComposer {\n\n\tconstructor( renderer, renderTarget ) {\n\n\t\tthis.renderer = renderer;\n\n\t\tthis._pixelRatio = renderer.getPixelRatio();\n\n\t\tif ( renderTarget === undefined ) {\n\n\t\t\tconst size = renderer.getSize( new Vector2() );\n\t\t\tthis._width = size.width;\n\t\t\tthis._height = size.height;\n\n\t\t\trenderTarget = new WebGLRenderTarget( this._width * this._pixelRatio, this._height * this._pixelRatio, { type: HalfFloatType } );\n\t\t\trenderTarget.texture.name = 'EffectComposer.rt1';\n\n\t\t} else {\n\n\t\t\tthis._width = renderTarget.width;\n\t\t\tthis._height = renderTarget.height;\n\n\t\t}\n\n\t\tthis.renderTarget1 = renderTarget;\n\t\tthis.renderTarget2 = renderTarget.clone();\n\t\tthis.renderTarget2.texture.name = 'EffectComposer.rt2';\n\n\t\tthis.writeBuffer = this.renderTarget1;\n\t\tthis.readBuffer = this.renderTarget2;\n\n\t\tthis.renderToScreen = true;\n\n\t\tthis.passes = [];\n\n\t\tthis.copyPass = new ShaderPass( CopyShader );\n\t\tthis.copyPass.material.blending = NoBlending;\n\n\t\tthis.clock = new Clock();\n\n\t}\n\n\tswapBuffers() {\n\n\t\tconst tmp = this.readBuffer;\n\t\tthis.readBuffer = this.writeBuffer;\n\t\tthis.writeBuffer = tmp;\n\n\t}\n\n\taddPass( pass ) {\n\n\t\tthis.passes.push( pass );\n\t\tpass.setSize( this._width * this._pixelRatio, this._height * this._pixelRatio );\n\n\t}\n\n\tinsertPass( pass, index ) {\n\n\t\tthis.passes.splice( index, 0, pass );\n\t\tpass.setSize( this._width * this._pixelRatio, this._height * this._pixelRatio );\n\n\t}\n\n\tremovePass( pass ) {\n\n\t\tconst index = this.passes.indexOf( pass );\n\n\t\tif ( index !== - 1 ) {\n\n\t\t\tthis.passes.splice( index, 1 );\n\n\t\t}\n\n\t}\n\n\tisLastEnabledPass( passIndex ) {\n\n\t\tfor ( let i = passIndex + 1; i < this.passes.length; i ++ ) {\n\n\t\t\tif ( this.passes[ i ].enabled ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\trender( deltaTime ) {\n\n\t\t// deltaTime value is in seconds\n\n\t\tif ( deltaTime === undefined ) {\n\n\t\t\tdeltaTime = this.clock.getDelta();\n\n\t\t}\n\n\t\tconst currentRenderTarget = this.renderer.getRenderTarget();\n\n\t\tlet maskActive = false;\n\n\t\tfor ( let i = 0, il = this.passes.length; i < il; i ++ ) {\n\n\t\t\tconst pass = this.passes[ i ];\n\n\t\t\tif ( pass.enabled === false ) continue;\n\n\t\t\tpass.renderToScreen = ( this.renderToScreen && this.isLastEnabledPass( i ) );\n\t\t\tpass.render( this.renderer, this.writeBuffer, this.readBuffer, deltaTime, maskActive );\n\n\t\t\tif ( pass.needsSwap ) {\n\n\t\t\t\tif ( maskActive ) {\n\n\t\t\t\t\tconst context = this.renderer.getContext();\n\t\t\t\t\tconst stencil = this.renderer.state.buffers.stencil;\n\n\t\t\t\t\t//context.stencilFunc( context.NOTEQUAL, 1, 0xffffffff );\n\t\t\t\t\tstencil.setFunc( context.NOTEQUAL, 1, 0xffffffff );\n\n\t\t\t\t\tthis.copyPass.render( this.renderer, this.writeBuffer, this.readBuffer, deltaTime );\n\n\t\t\t\t\t//context.stencilFunc( context.EQUAL, 1, 0xffffffff );\n\t\t\t\t\tstencil.setFunc( context.EQUAL, 1, 0xffffffff );\n\n\t\t\t\t}\n\n\t\t\t\tthis.swapBuffers();\n\n\t\t\t}\n\n\t\t\tif ( MaskPass !== undefined ) {\n\n\t\t\t\tif ( pass instanceof MaskPass ) {\n\n\t\t\t\t\tmaskActive = true;\n\n\t\t\t\t} else if ( pass instanceof ClearMaskPass ) {\n\n\t\t\t\t\tmaskActive = false;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.renderer.setRenderTarget( currentRenderTarget );\n\n\t}\n\n\treset( renderTarget ) {\n\n\t\tif ( renderTarget === undefined ) {\n\n\t\t\tconst size = this.renderer.getSize( new Vector2() );\n\t\t\tthis._pixelRatio = this.renderer.getPixelRatio();\n\t\t\tthis._width = size.width;\n\t\t\tthis._height = size.height;\n\n\t\t\trenderTarget = this.renderTarget1.clone();\n\t\t\trenderTarget.setSize( this._width * this._pixelRatio, this._height * this._pixelRatio );\n\n\t\t}\n\n\t\tthis.renderTarget1.dispose();\n\t\tthis.renderTarget2.dispose();\n\t\tthis.renderTarget1 = renderTarget;\n\t\tthis.renderTarget2 = renderTarget.clone();\n\n\t\tthis.writeBuffer = this.renderTarget1;\n\t\tthis.readBuffer = this.renderTarget2;\n\n\t}\n\n\tsetSize( width, height ) {\n\n\t\tthis._width = width;\n\t\tthis._height = height;\n\n\t\tconst effectiveWidth = this._width * this._pixelRatio;\n\t\tconst effectiveHeight = this._height * this._pixelRatio;\n\n\t\tthis.renderTarget1.setSize( effectiveWidth, effectiveHeight );\n\t\tthis.renderTarget2.setSize( effectiveWidth, effectiveHeight );\n\n\t\tfor ( let i = 0; i < this.passes.length; i ++ ) {\n\n\t\t\tthis.passes[ i ].setSize( effectiveWidth, effectiveHeight );\n\n\t\t}\n\n\t}\n\n\tsetPixelRatio( pixelRatio ) {\n\n\t\tthis._pixelRatio = pixelRatio;\n\n\t\tthis.setSize( this._width, this._height );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.renderTarget1.dispose();\n\t\tthis.renderTarget2.dispose();\n\n\t\tthis.copyPass.dispose();\n\n\t}\n\n}\n\nexport { EffectComposer };\n","const OutputShader = {\n\n\tname: 'OutputShader',\n\n\tuniforms: {\n\n\t\t'tDiffuse': { value: null },\n\t\t'toneMappingExposure': { value: 1 }\n\n\t},\n\n\tvertexShader: /* glsl */`\n\t\tprecision highp float;\n\n\t\tuniform mat4 modelViewMatrix;\n\t\tuniform mat4 projectionMatrix;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}`,\n\n\tfragmentShader: /* glsl */`\n\t\n\t\tprecision highp float;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\t#include <tonemapping_pars_fragment>\n\t\t#include <colorspace_pars_fragment>\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor = texture2D( tDiffuse, vUv );\n\n\t\t\t// tone mapping\n\n\t\t\t#ifdef LINEAR_TONE_MAPPING\n\n\t\t\t\tgl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );\n\n\t\t\t#elif defined( REINHARD_TONE_MAPPING )\n\n\t\t\t\tgl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );\n\n\t\t\t#elif defined( CINEON_TONE_MAPPING )\n\n\t\t\t\tgl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );\n\n\t\t\t#elif defined( ACES_FILMIC_TONE_MAPPING )\n\n\t\t\t\tgl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );\n\n\t\t\t#elif defined( AGX_TONE_MAPPING )\n\n\t\t\t\tgl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );\n\n\t\t\t#elif defined( NEUTRAL_TONE_MAPPING )\n\n\t\t\t\tgl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );\n\n\t\t\t#endif\n\n\t\t\t// color space\n\n\t\t\t#ifdef SRGB_TRANSFER\n\n\t\t\t\tgl_FragColor = sRGBTransferOETF( gl_FragColor );\n\n\t\t\t#endif\n\n\t\t}`\n\n};\n\nexport { OutputShader };\n","import {\n\tColorManagement,\n\tRawShaderMaterial,\n\tUniformsUtils,\n\tLinearToneMapping,\n\tReinhardToneMapping,\n\tCineonToneMapping,\n\tAgXToneMapping,\n\tACESFilmicToneMapping,\n\tNeutralToneMapping,\n\tSRGBTransfer\n} from 'three';\nimport { Pass, FullScreenQuad } from './Pass.js';\nimport { OutputShader } from '../shaders/OutputShader.js';\n\nclass OutputPass extends Pass {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\t//\n\n\t\tconst shader = OutputShader;\n\n\t\tthis.uniforms = UniformsUtils.clone( shader.uniforms );\n\n\t\tthis.material = new RawShaderMaterial( {\n\t\t\tname: shader.name,\n\t\t\tuniforms: this.uniforms,\n\t\t\tvertexShader: shader.vertexShader,\n\t\t\tfragmentShader: shader.fragmentShader\n\t\t} );\n\n\t\tthis.fsQuad = new FullScreenQuad( this.material );\n\n\t\t// internal cache\n\n\t\tthis._outputColorSpace = null;\n\t\tthis._toneMapping = null;\n\n\t}\n\n\trender( renderer, writeBuffer, readBuffer/*, deltaTime, maskActive */ ) {\n\n\t\tthis.uniforms[ 'tDiffuse' ].value = readBuffer.texture;\n\t\tthis.uniforms[ 'toneMappingExposure' ].value = renderer.toneMappingExposure;\n\n\t\t// rebuild defines if required\n\n\t\tif ( this._outputColorSpace !== renderer.outputColorSpace || this._toneMapping !== renderer.toneMapping ) {\n\n\t\t\tthis._outputColorSpace = renderer.outputColorSpace;\n\t\t\tthis._toneMapping = renderer.toneMapping;\n\n\t\t\tthis.material.defines = {};\n\n\t\t\tif ( ColorManagement.getTransfer( this._outputColorSpace ) === SRGBTransfer ) this.material.defines.SRGB_TRANSFER = '';\n\n\t\t\tif ( this._toneMapping === LinearToneMapping ) this.material.defines.LINEAR_TONE_MAPPING = '';\n\t\t\telse if ( this._toneMapping === ReinhardToneMapping ) this.material.defines.REINHARD_TONE_MAPPING = '';\n\t\t\telse if ( this._toneMapping === CineonToneMapping ) this.material.defines.CINEON_TONE_MAPPING = '';\n\t\t\telse if ( this._toneMapping === ACESFilmicToneMapping ) this.material.defines.ACES_FILMIC_TONE_MAPPING = '';\n\t\t\telse if ( this._toneMapping === AgXToneMapping ) this.material.defines.AGX_TONE_MAPPING = '';\n\t\t\telse if ( this._toneMapping === NeutralToneMapping ) this.material.defines.NEUTRAL_TONE_MAPPING = '';\n\n\t\t\tthis.material.needsUpdate = true;\n\n\t\t}\n\n\t\t//\n\n\t\tif ( this.renderToScreen === true ) {\n\n\t\t\trenderer.setRenderTarget( null );\n\t\t\tthis.fsQuad.render( renderer );\n\n\t\t} else {\n\n\t\t\trenderer.setRenderTarget( writeBuffer );\n\t\t\tif ( this.clear ) renderer.clear( renderer.autoClearColor, renderer.autoClearDepth, renderer.autoClearStencil );\n\t\t\tthis.fsQuad.render( renderer );\n\n\t\t}\n\n\t}\n\n\tdispose() {\n\n\t\tthis.material.dispose();\n\t\tthis.fsQuad.dispose();\n\n\t}\n\n}\n\nexport { OutputPass };\n","import {\n\tColor\n} from 'three';\nimport { Pass } from './Pass.js';\n\nclass RenderPass extends Pass {\n\n\tconstructor( scene, camera, overrideMaterial = null, clearColor = null, clearAlpha = null ) {\n\n\t\tsuper();\n\n\t\tthis.scene = scene;\n\t\tthis.camera = camera;\n\n\t\tthis.overrideMaterial = overrideMaterial;\n\n\t\tthis.clearColor = clearColor;\n\t\tthis.clearAlpha = clearAlpha;\n\n\t\tthis.clear = true;\n\t\tthis.clearDepth = false;\n\t\tthis.needsSwap = false;\n\t\tthis._oldClearColor = new Color();\n\n\t}\n\n\trender( renderer, writeBuffer, readBuffer /*, deltaTime, maskActive */ ) {\n\n\t\tconst oldAutoClear = renderer.autoClear;\n\t\trenderer.autoClear = false;\n\n\t\tlet oldClearAlpha, oldOverrideMaterial;\n\n\t\tif ( this.overrideMaterial !== null ) {\n\n\t\t\toldOverrideMaterial = this.scene.overrideMaterial;\n\n\t\t\tthis.scene.overrideMaterial = this.overrideMaterial;\n\n\t\t}\n\n\t\tif ( this.clearColor !== null ) {\n\n\t\t\trenderer.getClearColor( this._oldClearColor );\n\t\t\trenderer.setClearColor( this.clearColor, renderer.getClearAlpha() );\n\n\t\t}\n\n\t\tif ( this.clearAlpha !== null ) {\n\n\t\t\toldClearAlpha = renderer.getClearAlpha();\n\t\t\trenderer.setClearAlpha( this.clearAlpha );\n\n\t\t}\n\n\t\tif ( this.clearDepth == true ) {\n\n\t\t\trenderer.clearDepth();\n\n\t\t}\n\n\t\trenderer.setRenderTarget( this.renderToScreen ? null : readBuffer );\n\n\t\tif ( this.clear === true ) {\n\n\t\t\t// TODO: Avoid using autoClear properties, see https://github.com/mrdoob/three.js/pull/15571#issuecomment-465669600\n\t\t\trenderer.clear( renderer.autoClearColor, renderer.autoClearDepth, renderer.autoClearStencil );\n\n\t\t}\n\n\t\trenderer.render( this.scene, this.camera );\n\n\t\t// restore\n\n\t\tif ( this.clearColor !== null ) {\n\n\t\t\trenderer.setClearColor( this._oldClearColor );\n\n\t\t}\n\n\t\tif ( this.clearAlpha !== null ) {\n\n\t\t\trenderer.setClearAlpha( oldClearAlpha );\n\n\t\t}\n\n\t\tif ( this.overrideMaterial !== null ) {\n\n\t\t\tthis.scene.overrideMaterial = oldOverrideMaterial;\n\n\t\t}\n\n\t\trenderer.autoClear = oldAutoClear;\n\n\t}\n\n}\n\nexport { RenderPass };\n","import {\n\tColor\n} from 'three';\n\n/**\n * Luminosity\n * http://en.wikipedia.org/wiki/Luminosity\n */\n\nconst LuminosityHighPassShader = {\n\n\tname: 'LuminosityHighPassShader',\n\n\tshaderID: 'luminosityHighPass',\n\n\tuniforms: {\n\n\t\t'tDiffuse': { value: null },\n\t\t'luminosityThreshold': { value: 1.0 },\n\t\t'smoothWidth': { value: 1.0 },\n\t\t'defaultColor': { value: new Color( 0x000000 ) },\n\t\t'defaultOpacity': { value: 0.0 }\n\n\t},\n\n\tvertexShader: /* glsl */`\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}`,\n\n\tfragmentShader: /* glsl */`\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec3 defaultColor;\n\t\tuniform float defaultOpacity;\n\t\tuniform float luminosityThreshold;\n\t\tuniform float smoothWidth;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\n\t\t\tfloat v = luminance( texel.xyz );\n\n\t\t\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n\n\t\t\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n\n\t\t\tgl_FragColor = mix( outputColor, texel, alpha );\n\n\t\t}`\n\n};\n\nexport { LuminosityHighPassShader };\n","import {\n\tAdditiveBlending,\n\tColor,\n\tHalfFloatType,\n\tMeshBasicMaterial,\n\tShaderMaterial,\n\tUniformsUtils,\n\tVector2,\n\tVector3,\n\tWebGLRenderTarget\n} from 'three';\nimport { Pass, FullScreenQuad } from './Pass.js';\nimport { CopyShader } from '../shaders/CopyShader.js';\nimport { LuminosityHighPassShader } from '../shaders/LuminosityHighPassShader.js';\n\n/**\n * UnrealBloomPass is inspired by the bloom pass of Unreal Engine. It creates a\n * mip map chain of bloom textures and blurs them with different radii. Because\n * of the weighted combination of mips, and because larger blurs are done on\n * higher mips, this effect provides good quality and performance.\n *\n * Reference:\n * - https://docs.unrealengine.com/latest/INT/Engine/Rendering/PostProcessEffects/Bloom/\n */\nclass UnrealBloomPass extends Pass {\n\n\tconstructor( resolution, strength, radius, threshold ) {\n\n\t\tsuper();\n\n\t\tthis.strength = ( strength !== undefined ) ? strength : 1;\n\t\tthis.radius = radius;\n\t\tthis.threshold = threshold;\n\t\tthis.resolution = ( resolution !== undefined ) ? new Vector2( resolution.x, resolution.y ) : new Vector2( 256, 256 );\n\n\t\t// create color only once here, reuse it later inside the render function\n\t\tthis.clearColor = new Color( 0, 0, 0 );\n\n\t\t// render targets\n\t\tthis.renderTargetsHorizontal = [];\n\t\tthis.renderTargetsVertical = [];\n\t\tthis.nMips = 5;\n\t\tlet resx = Math.round( this.resolution.x / 2 );\n\t\tlet resy = Math.round( this.resolution.y / 2 );\n\n\t\tthis.renderTargetBright = new WebGLRenderTarget( resx, resy, { type: HalfFloatType } );\n\t\tthis.renderTargetBright.texture.name = 'UnrealBloomPass.bright';\n\t\tthis.renderTargetBright.texture.generateMipmaps = false;\n\n\t\tfor ( let i = 0; i < this.nMips; i ++ ) {\n\n\t\t\tconst renderTargetHorizontal = new WebGLRenderTarget( resx, resy, { type: HalfFloatType } );\n\n\t\t\trenderTargetHorizontal.texture.name = 'UnrealBloomPass.h' + i;\n\t\t\trenderTargetHorizontal.texture.generateMipmaps = false;\n\n\t\t\tthis.renderTargetsHorizontal.push( renderTargetHorizontal );\n\n\t\t\tconst renderTargetVertical = new WebGLRenderTarget( resx, resy, { type: HalfFloatType } );\n\n\t\t\trenderTargetVertical.texture.name = 'UnrealBloomPass.v' + i;\n\t\t\trenderTargetVertical.texture.generateMipmaps = false;\n\n\t\t\tthis.renderTargetsVertical.push( renderTargetVertical );\n\n\t\t\tresx = Math.round( resx / 2 );\n\n\t\t\tresy = Math.round( resy / 2 );\n\n\t\t}\n\n\t\t// luminosity high pass material\n\n\t\tconst highPassShader = LuminosityHighPassShader;\n\t\tthis.highPassUniforms = UniformsUtils.clone( highPassShader.uniforms );\n\n\t\tthis.highPassUniforms[ 'luminosityThreshold' ].value = threshold;\n\t\tthis.highPassUniforms[ 'smoothWidth' ].value = 0.01;\n\n\t\tthis.materialHighPassFilter = new ShaderMaterial( {\n\t\t\tuniforms: this.highPassUniforms,\n\t\t\tvertexShader: highPassShader.vertexShader,\n\t\t\tfragmentShader: highPassShader.fragmentShader\n\t\t} );\n\n\t\t// gaussian blur materials\n\n\t\tthis.separableBlurMaterials = [];\n\t\tconst kernelSizeArray = [ 3, 5, 7, 9, 11 ];\n\t\tresx = Math.round( this.resolution.x / 2 );\n\t\tresy = Math.round( this.resolution.y / 2 );\n\n\t\tfor ( let i = 0; i < this.nMips; i ++ ) {\n\n\t\t\tthis.separableBlurMaterials.push( this.getSeparableBlurMaterial( kernelSizeArray[ i ] ) );\n\n\t\t\tthis.separableBlurMaterials[ i ].uniforms[ 'invSize' ].value = new Vector2( 1 / resx, 1 / resy );\n\n\t\t\tresx = Math.round( resx / 2 );\n\n\t\t\tresy = Math.round( resy / 2 );\n\n\t\t}\n\n\t\t// composite material\n\n\t\tthis.compositeMaterial = this.getCompositeMaterial( this.nMips );\n\t\tthis.compositeMaterial.uniforms[ 'blurTexture1' ].value = this.renderTargetsVertical[ 0 ].texture;\n\t\tthis.compositeMaterial.uniforms[ 'blurTexture2' ].value = this.renderTargetsVertical[ 1 ].texture;\n\t\tthis.compositeMaterial.uniforms[ 'blurTexture3' ].value = this.renderTargetsVertical[ 2 ].texture;\n\t\tthis.compositeMaterial.uniforms[ 'blurTexture4' ].value = this.renderTargetsVertical[ 3 ].texture;\n\t\tthis.compositeMaterial.uniforms[ 'blurTexture5' ].value = this.renderTargetsVertical[ 4 ].texture;\n\t\tthis.compositeMaterial.uniforms[ 'bloomStrength' ].value = strength;\n\t\tthis.compositeMaterial.uniforms[ 'bloomRadius' ].value = 0.1;\n\n\t\tconst bloomFactors = [ 1.0, 0.8, 0.6, 0.4, 0.2 ];\n\t\tthis.compositeMaterial.uniforms[ 'bloomFactors' ].value = bloomFactors;\n\t\tthis.bloomTintColors = [ new Vector3( 1, 1, 1 ), new Vector3( 1, 1, 1 ), new Vector3( 1, 1, 1 ), new Vector3( 1, 1, 1 ), new Vector3( 1, 1, 1 ) ];\n\t\tthis.compositeMaterial.uniforms[ 'bloomTintColors' ].value = this.bloomTintColors;\n\n\t\t// blend material\n\n\t\tconst copyShader = CopyShader;\n\n\t\tthis.copyUniforms = UniformsUtils.clone( copyShader.uniforms );\n\n\t\tthis.blendMaterial = new ShaderMaterial( {\n\t\t\tuniforms: this.copyUniforms,\n\t\t\tvertexShader: copyShader.vertexShader,\n\t\t\tfragmentShader: copyShader.fragmentShader,\n\t\t\tblending: AdditiveBlending,\n\t\t\tdepthTest: false,\n\t\t\tdepthWrite: false,\n\t\t\ttransparent: true\n\t\t} );\n\n\t\tthis.enabled = true;\n\t\tthis.needsSwap = false;\n\n\t\tthis._oldClearColor = new Color();\n\t\tthis.oldClearAlpha = 1;\n\n\t\tthis.basic = new MeshBasicMaterial();\n\n\t\tthis.fsQuad = new FullScreenQuad( null );\n\n\t}\n\n\tdispose() {\n\n\t\tfor ( let i = 0; i < this.renderTargetsHorizontal.length; i ++ ) {\n\n\t\t\tthis.renderTargetsHorizontal[ i ].dispose();\n\n\t\t}\n\n\t\tfor ( let i = 0; i < this.renderTargetsVertical.length; i ++ ) {\n\n\t\t\tthis.renderTargetsVertical[ i ].dispose();\n\n\t\t}\n\n\t\tthis.renderTargetBright.dispose();\n\n\t\t//\n\n\t\tfor ( let i = 0; i < this.separableBlurMaterials.length; i ++ ) {\n\n\t\t\tthis.separableBlurMaterials[ i ].dispose();\n\n\t\t}\n\n\t\tthis.compositeMaterial.dispose();\n\t\tthis.blendMaterial.dispose();\n\t\tthis.basic.dispose();\n\n\t\t//\n\n\t\tthis.fsQuad.dispose();\n\n\t}\n\n\tsetSize( width, height ) {\n\n\t\tlet resx = Math.round( width / 2 );\n\t\tlet resy = Math.round( height / 2 );\n\n\t\tthis.renderTargetBright.setSize( resx, resy );\n\n\t\tfor ( let i = 0; i < this.nMips; i ++ ) {\n\n\t\t\tthis.renderTargetsHorizontal[ i ].setSize( resx, resy );\n\t\t\tthis.renderTargetsVertical[ i ].setSize( resx, resy );\n\n\t\t\tthis.separableBlurMaterials[ i ].uniforms[ 'invSize' ].value = new Vector2( 1 / resx, 1 / resy );\n\n\t\t\tresx = Math.round( resx / 2 );\n\t\t\tresy = Math.round( resy / 2 );\n\n\t\t}\n\n\t}\n\n\trender( renderer, writeBuffer, readBuffer, deltaTime, maskActive ) {\n\n\t\trenderer.getClearColor( this._oldClearColor );\n\t\tthis.oldClearAlpha = renderer.getClearAlpha();\n\t\tconst oldAutoClear = renderer.autoClear;\n\t\trenderer.autoClear = false;\n\n\t\trenderer.setClearColor( this.clearColor, 0 );\n\n\t\tif ( maskActive ) renderer.state.buffers.stencil.setTest( false );\n\n\t\t// Render input to screen\n\n\t\tif ( this.renderToScreen ) {\n\n\t\t\tthis.fsQuad.material = this.basic;\n\t\t\tthis.basic.map = readBuffer.texture;\n\n\t\t\trenderer.setRenderTarget( null );\n\t\t\trenderer.clear();\n\t\t\tthis.fsQuad.render( renderer );\n\n\t\t}\n\n\t\t// 1. Extract Bright Areas\n\n\t\tthis.highPassUniforms[ 'tDiffuse' ].value = readBuffer.texture;\n\t\tthis.highPassUniforms[ 'luminosityThreshold' ].value = this.threshold;\n\t\tthis.fsQuad.material = this.materialHighPassFilter;\n\n\t\trenderer.setRenderTarget( this.renderTargetBright );\n\t\trenderer.clear();\n\t\tthis.fsQuad.render( renderer );\n\n\t\t// 2. Blur All the mips progressively\n\n\t\tlet inputRenderTarget = this.renderTargetBright;\n\n\t\tfor ( let i = 0; i < this.nMips; i ++ ) {\n\n\t\t\tthis.fsQuad.material = this.separableBlurMaterials[ i ];\n\n\t\t\tthis.separableBlurMaterials[ i ].uniforms[ 'colorTexture' ].value = inputRenderTarget.texture;\n\t\t\tthis.separableBlurMaterials[ i ].uniforms[ 'direction' ].value = UnrealBloomPass.BlurDirectionX;\n\t\t\trenderer.setRenderTarget( this.renderTargetsHorizontal[ i ] );\n\t\t\trenderer.clear();\n\t\t\tthis.fsQuad.render( renderer );\n\n\t\t\tthis.separableBlurMaterials[ i ].uniforms[ 'colorTexture' ].value = this.renderTargetsHorizontal[ i ].texture;\n\t\t\tthis.separableBlurMaterials[ i ].uniforms[ 'direction' ].value = UnrealBloomPass.BlurDirectionY;\n\t\t\trenderer.setRenderTarget( this.renderTargetsVertical[ i ] );\n\t\t\trenderer.clear();\n\t\t\tthis.fsQuad.render( renderer );\n\n\t\t\tinputRenderTarget = this.renderTargetsVertical[ i ];\n\n\t\t}\n\n\t\t// Composite All the mips\n\n\t\tthis.fsQuad.material = this.compositeMaterial;\n\t\tthis.compositeMaterial.uniforms[ 'bloomStrength' ].value = this.strength;\n\t\tthis.compositeMaterial.uniforms[ 'bloomRadius' ].value = this.radius;\n\t\tthis.compositeMaterial.uniforms[ 'bloomTintColors' ].value = this.bloomTintColors;\n\n\t\trenderer.setRenderTarget( this.renderTargetsHorizontal[ 0 ] );\n\t\trenderer.clear();\n\t\tthis.fsQuad.render( renderer );\n\n\t\t// Blend it additively over the input texture\n\n\t\tthis.fsQuad.material = this.blendMaterial;\n\t\tthis.copyUniforms[ 'tDiffuse' ].value = this.renderTargetsHorizontal[ 0 ].texture;\n\n\t\tif ( maskActive ) renderer.state.buffers.stencil.setTest( true );\n\n\t\tif ( this.renderToScreen ) {\n\n\t\t\trenderer.setRenderTarget( null );\n\t\t\tthis.fsQuad.render( renderer );\n\n\t\t} else {\n\n\t\t\trenderer.setRenderTarget( readBuffer );\n\t\t\tthis.fsQuad.render( renderer );\n\n\t\t}\n\n\t\t// Restore renderer settings\n\n\t\trenderer.setClearColor( this._oldClearColor, this.oldClearAlpha );\n\t\trenderer.autoClear = oldAutoClear;\n\n\t}\n\n\tgetSeparableBlurMaterial( kernelRadius ) {\n\n\t\tconst coefficients = [];\n\n\t\tfor ( let i = 0; i < kernelRadius; i ++ ) {\n\n\t\t\tcoefficients.push( 0.39894 * Math.exp( - 0.5 * i * i / ( kernelRadius * kernelRadius ) ) / kernelRadius );\n\n\t\t}\n\n\t\treturn new ShaderMaterial( {\n\n\t\t\tdefines: {\n\t\t\t\t'KERNEL_RADIUS': kernelRadius\n\t\t\t},\n\n\t\t\tuniforms: {\n\t\t\t\t'colorTexture': { value: null },\n\t\t\t\t'invSize': { value: new Vector2( 0.5, 0.5 ) }, // inverse texture size\n\t\t\t\t'direction': { value: new Vector2( 0.5, 0.5 ) },\n\t\t\t\t'gaussianCoefficients': { value: coefficients } // precomputed Gaussian coefficients\n\t\t\t},\n\n\t\t\tvertexShader:\n\t\t\t\t`varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}`,\n\n\t\t\tfragmentShader:\n\t\t\t\t`#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 invSize;\n\t\t\t\tuniform vec2 direction;\n\t\t\t\tuniform float gaussianCoefficients[KERNEL_RADIUS];\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tfloat weightSum = gaussianCoefficients[0];\n\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv ).rgb * weightSum;\n\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = float(i);\n\t\t\t\t\t\tfloat w = gaussianCoefficients[i];\n\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\n\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset ).rgb;\n\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset ).rgb;\n\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\n\t\t\t\t\t\tweightSum += 2.0 * w;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}`\n\t\t} );\n\n\t}\n\n\tgetCompositeMaterial( nMips ) {\n\n\t\treturn new ShaderMaterial( {\n\n\t\t\tdefines: {\n\t\t\t\t'NUM_MIPS': nMips\n\t\t\t},\n\n\t\t\tuniforms: {\n\t\t\t\t'blurTexture1': { value: null },\n\t\t\t\t'blurTexture2': { value: null },\n\t\t\t\t'blurTexture3': { value: null },\n\t\t\t\t'blurTexture4': { value: null },\n\t\t\t\t'blurTexture5': { value: null },\n\t\t\t\t'bloomStrength': { value: 1.0 },\n\t\t\t\t'bloomFactors': { value: null },\n\t\t\t\t'bloomTintColors': { value: null },\n\t\t\t\t'bloomRadius': { value: 0.0 }\n\t\t\t},\n\n\t\t\tvertexShader:\n\t\t\t\t`varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}`,\n\n\t\t\tfragmentShader:\n\t\t\t\t`varying vec2 vUv;\n\t\t\t\tuniform sampler2D blurTexture1;\n\t\t\t\tuniform sampler2D blurTexture2;\n\t\t\t\tuniform sampler2D blurTexture3;\n\t\t\t\tuniform sampler2D blurTexture4;\n\t\t\t\tuniform sampler2D blurTexture5;\n\t\t\t\tuniform float bloomStrength;\n\t\t\t\tuniform float bloomRadius;\n\t\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\n\t\t\t\tfloat lerpBloomFactor(const in float factor) {\n\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\n\t\t\t\t}`\n\t\t} );\n\n\t}\n\n}\n\nUnrealBloomPass.BlurDirectionX = new Vector2( 1.0, 0.0 );\nUnrealBloomPass.BlurDirectionY = new Vector2( 0.0, 1.0 );\n\nexport { UnrealBloomPass };\n","import {\n\tMatrix4,\n\tObject3D,\n\tVector2,\n\tVector3\n} from 'three';\n\nclass CSS2DObject extends Object3D {\n\n\tconstructor( element = document.createElement( 'div' ) ) {\n\n\t\tsuper();\n\n\t\tthis.isCSS2DObject = true;\n\n\t\tthis.element = element;\n\n\t\tthis.element.style.position = 'absolute';\n\t\tthis.element.style.userSelect = 'none';\n\n\t\tthis.element.setAttribute( 'draggable', false );\n\n\t\tthis.center = new Vector2( 0.5, 0.5 ); // ( 0, 0 ) is the lower left; ( 1, 1 ) is the top right\n\n\t\tthis.addEventListener( 'removed', function () {\n\n\t\t\tthis.traverse( function ( object ) {\n\n\t\t\t\tif (\n\t\t\t\t\tobject.element instanceof object.element.ownerDocument.defaultView.Element &&\n\t\t\t\t\tobject.element.parentNode !== null\n\t\t\t\t) {\n\n\t\t\t\t\tobject.element.remove();\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.element = source.element.cloneNode( true );\n\n\t\tthis.center = source.center;\n\n\t\treturn this;\n\n\t}\n\n}\n\n//\n\nconst _vector = new Vector3();\nconst _viewMatrix = new Matrix4();\nconst _viewProjectionMatrix = new Matrix4();\nconst _a = new Vector3();\nconst _b = new Vector3();\n\nclass CSS2DRenderer {\n\n\tconstructor( parameters = {} ) {\n\n\t\tconst _this = this;\n\n\t\tlet _width, _height;\n\t\tlet _widthHalf, _heightHalf;\n\n\t\tconst cache = {\n\t\t\tobjects: new WeakMap()\n\t\t};\n\n\t\tconst domElement = parameters.element !== undefined ? parameters.element : document.createElement( 'div' );\n\n\t\tdomElement.style.overflow = 'hidden';\n\n\t\tthis.domElement = domElement;\n\n\t\tthis.getSize = function () {\n\n\t\t\treturn {\n\t\t\t\twidth: _width,\n\t\t\t\theight: _height\n\t\t\t};\n\n\t\t};\n\n\t\tthis.render = function ( scene, camera ) {\n\n\t\t\tif ( scene.matrixWorldAutoUpdate === true ) scene.updateMatrixWorld();\n\t\t\tif ( camera.parent === null && camera.matrixWorldAutoUpdate === true ) camera.updateMatrixWorld();\n\n\t\t\t_viewMatrix.copy( camera.matrixWorldInverse );\n\t\t\t_viewProjectionMatrix.multiplyMatrices( camera.projectionMatrix, _viewMatrix );\n\n\t\t\trenderObject( scene, scene, camera );\n\t\t\tzOrder( scene );\n\n\t\t};\n\n\t\tthis.setSize = function ( width, height ) {\n\n\t\t\t_width = width;\n\t\t\t_height = height;\n\n\t\t\t_widthHalf = _width / 2;\n\t\t\t_heightHalf = _height / 2;\n\n\t\t\tdomElement.style.width = width + 'px';\n\t\t\tdomElement.style.height = height + 'px';\n\n\t\t};\n\n\t\tfunction hideObject( object ) {\n\n\t\t\tif ( object.isCSS2DObject ) object.element.style.display = 'none';\n\n\t\t\tfor ( let i = 0, l = object.children.length; i < l; i ++ ) {\n\n\t\t\t\thideObject( object.children[ i ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction renderObject( object, scene, camera ) {\n\n\t\t\tif ( object.visible === false ) {\n\n\t\t\t\thideObject( object );\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( object.isCSS2DObject ) {\n\n\t\t\t\t_vector.setFromMatrixPosition( object.matrixWorld );\n\t\t\t\t_vector.applyMatrix4( _viewProjectionMatrix );\n\n\t\t\t\tconst visible = ( _vector.z >= - 1 && _vector.z <= 1 ) && ( object.layers.test( camera.layers ) === true );\n\n\t\t\t\tconst element = object.element;\n\t\t\t\telement.style.display = visible === true ? '' : 'none';\n\n\t\t\t\tif ( visible === true ) {\n\n\t\t\t\t\tobject.onBeforeRender( _this, scene, camera );\n\n\t\t\t\t\telement.style.transform = 'translate(' + ( - 100 * object.center.x ) + '%,' + ( - 100 * object.center.y ) + '%)' + 'translate(' + ( _vector.x * _widthHalf + _widthHalf ) + 'px,' + ( - _vector.y * _heightHalf + _heightHalf ) + 'px)';\n\n\t\t\t\t\tif ( element.parentNode !== domElement ) {\n\n\t\t\t\t\t\tdomElement.appendChild( element );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tobject.onAfterRender( _this, scene, camera );\n\n\t\t\t\t}\n\n\t\t\t\tconst objectData = {\n\t\t\t\t\tdistanceToCameraSquared: getDistanceToSquared( camera, object )\n\t\t\t\t};\n\n\t\t\t\tcache.objects.set( object, objectData );\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, l = object.children.length; i < l; i ++ ) {\n\n\t\t\t\trenderObject( object.children[ i ], scene, camera );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction getDistanceToSquared( object1, object2 ) {\n\n\t\t\t_a.setFromMatrixPosition( object1.matrixWorld );\n\t\t\t_b.setFromMatrixPosition( object2.matrixWorld );\n\n\t\t\treturn _a.distanceToSquared( _b );\n\n\t\t}\n\n\t\tfunction filterAndFlatten( scene ) {\n\n\t\t\tconst result = [];\n\n\t\t\tscene.traverseVisible( function ( object ) {\n\n\t\t\t\tif ( object.isCSS2DObject ) result.push( object );\n\n\t\t\t} );\n\n\t\t\treturn result;\n\n\t\t}\n\n\t\tfunction zOrder( scene ) {\n\n\t\t\tconst sorted = filterAndFlatten( scene ).sort( function ( a, b ) {\n\n\t\t\t\tif ( a.renderOrder !== b.renderOrder ) {\n\n\t\t\t\t\treturn b.renderOrder - a.renderOrder;\n\n\t\t\t\t}\n\n\t\t\t\tconst distanceA = cache.objects.get( a ).distanceToCameraSquared;\n\t\t\t\tconst distanceB = cache.objects.get( b ).distanceToCameraSquared;\n\n\t\t\t\treturn distanceA - distanceB;\n\n\t\t\t} );\n\n\t\t\tconst zMax = sorted.length;\n\n\t\t\tfor ( let i = 0, l = sorted.length; i < l; i ++ ) {\n\n\t\t\t\tsorted[ i ].element.style.zIndex = zMax - i;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nexport { CSS2DObject, CSS2DRenderer };\n","import { CSS2DRenderer, UnrealBloomPass } from 'three/examples/jsm/Addons.js';\nimport { EffectComposer } from 'three/examples/jsm/Addons.js';\nimport { RenderPass } from 'three/examples/jsm/Addons.js';\nimport { OutputPass } from 'three/examples/jsm/Addons.js';\nimport { THREE } from '.';\n\nexport class AppRenderer {\n    webgl_renderer;\n    css_renderer;\n    composer;\n\n    constructor(incoming_parent, incoming_camera) {\n        this.parent = incoming_parent;\n        this.camera = incoming_camera;\n        // Html rendering\n        this.css_renderer = new CSS2DRenderer();\n        this.css_renderer.setSize(window.innerWidth, window.innerHeight);\n        this.css_renderer.domElement.style.position = 'absolute';\n        this.css_renderer.domElement.style.top = '0';\n        this.css_renderer.domElement.style.zIndex = '1'; // On top of WebGL canvas\n        document.body.appendChild(this.css_renderer.domElement);\n        // 3D rendering\n        this.webgl_renderer = new THREE.WebGLRenderer({ antialias: true });\n        this.webgl_renderer.setSize(window.innerWidth, window.innerHeight);\n        this.webgl_renderer.shadowMap.enabled = true;\n        this.webgl_renderer.shadowMap.type = THREE.VSMShadowMap;\n        this. webgl_renderer.domElement.style.position = 'absolute';\n        this. webgl_renderer.domElement.style.top = '0';\n        this.webgl_renderer.domElement.style.zIndex = '0';\n        document.body.appendChild(this.webgl_renderer.domElement);\n        // After effects\n        this.composer = new EffectComposer(this.webgl_renderer);\n        const output_pass = new OutputPass();\n        const render_scene = new RenderPass(this.parent, this.camera);\n        const bloom_pass = new UnrealBloomPass( \n            new THREE.Vector2(window.innerWidth, window.innerHeight), // Resolution\n            1.5, // Strength\n            0.4, // Radius\n            1 // Threshold\n        );\n        this.composer.addPass(render_scene);\n        this.composer.addPass(bloom_pass);\n        this.composer.addPass(output_pass);\n\n    }\n\n    // ----- Functions\n\n    add_event_listener(incoming_event_name, handler_method) {\n        this.webgl_renderer.domElement.addEventListener(incoming_event_name, handler_method);\n        this.css_renderer.domElement.addEventListener(incoming_event_name, handler_method);\n    }\n\n    render() {\n        this.composer.render();\n        this.css_renderer.render(this.parent, this.camera);\n    }\n\n    resize() {\n        this.webgl_renderer.setSize(window.innerWidth, window.innerHeight);\n        this.css_renderer.setSize(window.innerWidth, window.innerHeight);\n        // Update bloom pass resolution\n        const bloomPass = this.composer.passes.find(pass => pass instanceof UnrealBloomPass);\n        if (bloomPass) {\n            bloomPass.resolution.set(window.innerWidth, window.innerHeight);\n        }\n    }\n\n    \n    // ----- Setters\n\n    set_animation_loop(incoming_function) {\n        this.webgl_renderer.setAnimationLoop(incoming_function);\n    }\n}","export const TYPES = Object.freeze({\n    ANY: \"any_\",\n    CONATINER: \"container_\",\n    LABEL: \"label_\",\n    TEXT: \"text_\",\n    TEXT_BLOCK: \"textblock_\",\n    BACKGROUND: \"background_\",\n    GLTF_MESH: \"gltf_\",\n    LINK: \"link_\",\n    HIDE: \"hide_\",\n    FLOOR: \"floor_\",\n    BALL: \"ball_\",\n    INTERACTABLE: \"interactable_\",\n    SIGN: \"sign_\"\n})","\n// TODO Refactor into ASSET_MANAGER configs\nexport const NAMES = Object.freeze({\n    PRIMARY: \"primary\",\n    SECONDARY: \"secondary\",\n    UNIQUE: \"unique\",\n    AXE: \"axe\",\n    DIPLOMA: \"diploma\",\n    DESK: \"desk\"\n})","import { GLTFLoader } from \"three/examples/jsm/Addons.js\";\nimport { Easing, Tween, RAPIER, THREE, NAMES } from \".\";\nimport { CATEGORIES, TYPES } from \"../viewport/overlay/overlay_common\";\nimport { FLAGS } from \"./flags\";\n\n// Define all possible asset types that can be loaded and spawned\nexport const ASSET_TYPE = {\n    AXE: 'AXE',\n    DIPLOMA: 'education',\n    DESK: 'DESK',\n    CHAIR: 'CHAIR',\n    BOOK: 'BOOK',\n    ROOM: 'ROOM',\n    TABLET: 'TABLET',\n    DESKPHOTO: 'DESK_PHOTO',\n    CUBE: 'CUBE'  // Simple geometric primitive for testing\n};\nObject.freeze(ASSET_TYPE);\n\n// Configuration for each asset type, including model paths, physics properties, and scaling\nexport const ASSET_CONFIGS = {\n    [ASSET_TYPE.AXE]: {\n        PATH: \"assets/Axe.glb\",\n        name: \"axe\",\n        scale: 20,\n        mass: 5,\n        restitution: .1,\n    },\n    [ASSET_TYPE.DIPLOMA]: {\n        PATH: \"assets/diploma_bot.glb\",\n        name: \"education\",\n        scale: 10,\n        mass: 1,\n        restitution: .2,\n    },\n    [ASSET_TYPE.DESK]: {\n        PATH: \"assets/desk.glb\",\n        name: \"desk\",\n        scale: 2,\n        mass: 1,\n        restitution: .5,\n    },\n    // Load in room\n    [ASSET_TYPE.ROOM]: {\n        PATH: \"assets/room.glb\",\n        name: \"room\",\n        scale: 5,\n        mass: 1,\n        restituation: .2\n    },\n    // Load in book\n    [ASSET_TYPE.BOOK]: {\n        PATH: \"assets/book.glb\",\n        name: \"book\",\n        scale: 5,\n        mass: 1,\n        restituation: 1\n    },\n    // Load in chair\n    [ASSET_TYPE.CHAIR]: {\n        PATH: \"assets/chair.glb\",\n        name: \"chair\",\n        scale: 5,\n        mass: 1.2,\n        restituation: 1\n    },\n    [ASSET_TYPE.TABLET]: {\n        PATH: \"assets/tablet.glb\",\n        name: \"tablet\",\n        scale: 5,\n        mass: 1,\n        restituation: 1\n    },\n    [ASSET_TYPE.DESKPHOTO]: {\n        PATH: \"assets/deskphoto.glb\",\n        name: \"desk_photo\",\n        scale: 5,\n        mass: 1,\n        restituation: 1\n    },\n    [ASSET_TYPE.CUBE]: {\n        // No PATH needed as it's a primitive\n        name: \"cube\",\n        scale: 1,\n        mass: 1,\n        restitution: 1.1,\n        geometry: new THREE.BoxGeometry(1, 1, 1),\n        // Function to create material - allows for dynamic color assignment\n        create_material: (color) => new THREE.MeshStandardMaterial({ color: color })\n    }\n};\n\nexport class AssetManager {\n    static instance = null;\n    static instance_counter = 0;\n    currently_activated_name = \"\";  // Add this to track the currently activated object\n    emission_states = new Map(); // Track emission states of objects\n    name = \"[AssetManager]\";\n    \n    constructor() {\n        if (AssetManager.instance) {\n            return AssetManager.instance;\n        }\n        this.loader = new GLTFLoader();\n        this.loaded_assets = new Map();  // Stores the raw GLTF data\n        this.dynamic_bodies = new Map(); // Stores [mesh, physicsBody] pairs\n        this.static_meshes = new Map();  // Stores static meshes without physics\n        this.loading_promises = new Map();\n        AssetManager.instance = this;\n    }\n\n    static get_instance() {\n        if (!AssetManager.instance) {\n            AssetManager.instance = new AssetManager();\n        }\n        return AssetManager.instance;\n    }\n\n    async load_asset_type(asset_type) {\n        const asset_config = ASSET_CONFIGS[asset_type];\n        if (!asset_config) throw new Error(`Unknown asset type: ${asset_type}`);\n        if (this.loaded_assets.has(asset_type)) {\n            return this.loaded_assets.get(asset_type);\n        }\n        if (this.loading_promises.has(asset_type)) {\n            return this.loading_promises.get(asset_type);\n        }\n        const loading_promise = new Promise((resolve, reject) => {\n            this.loader.load(\n                asset_config.PATH,\n                (gltf) => {\n                    this.loaded_assets.set(asset_type, gltf);\n                    this.loading_promises.delete(asset_type);\n                    resolve(gltf);\n                },\n                undefined,\n                reject\n            );\n        });\n        this.loading_promises.set(asset_type, loading_promise);\n        return loading_promise;\n    }\n\n    get_new_instance_id() {\n        return AssetManager.instance_counter++;\n    }\n\n    /**\n     * Spawns a physics-enabled asset of the specified type\n     * @param {string} asset_type - Type of asset from ASSET_TYPE enum\n     * @param {THREE.Object3D} parent - Parent object to add the mesh to\n     * @param {RAPIER.World} world - Physics world to create the body in\n     * @param {Object} options - Additional options (e.g., color for cubes)\n     * @param {THREE.Vector3} position_offset - Position offset from parent\n     * @returns {Array} [mesh, body] pair for physics updates\n     */\n    async spawn_asset(asset_type, parent, world, options = {}, position_offset = new THREE.Vector3(0, 0, 0)) {\n        if (!Object.values(ASSET_TYPE).includes(asset_type)) {\n            throw new Error(`Invalid asset type: ${asset_type}`);\n        }\n        const asset_config = ASSET_CONFIGS[asset_type];\n        let mesh;\n        // Create physics body first\n        const body = world.createRigidBody(\n            RAPIER.RigidBodyDesc.dynamic()\n                .setTranslation(position_offset.x, position_offset.y, position_offset.z)\n                .setCanSleep(false)\n        );\n\n        if(FLAGS.ASSET_LOGS) console.log(`Created rigid body for ${asset_type}:`, body);\n\n        if (asset_type === ASSET_TYPE.CUBE) {\n            mesh = new THREE.Mesh(\n                asset_config.geometry,\n                asset_config.create_material(options.color || 0xffffff)\n            );\n            mesh.position.copy(position_offset);\n            mesh.castShadow = true;\n            // Add name for cube\n            mesh.name = `${TYPES.INTERACTABLE}${asset_config.name}`;\n            const collider = RAPIER.ColliderDesc.cuboid(0.5, 0.5, 0.5)\n                .setMass(asset_config.mass)\n                .setRestitution(asset_config.restitution);\n            const created_collider = world.createCollider(collider, body);\n            if(FLAGS.ASSET_LOGS) console.log(`Created cube collider:`, created_collider);\n        } else {\n            // Normal GLB asset loading path\n            if (!this.loaded_assets.has(asset_type)) await this.load_asset_type(asset_type);\n            const gltf = this.loaded_assets.get(asset_type);\n            mesh = gltf.scene.clone();\n            mesh.position.copy(position_offset);\n            mesh.scale.set(asset_config.scale, asset_config.scale, asset_config.scale);\n            \n            // Look for ALL collision meshes using the 'col_' prefix\n            let collision_meshes = [];\n            mesh.traverse((child) => {\n                if (child.isMesh) {\n                    if (child.name.startsWith('col_')) {\n                        collision_meshes.push(child);\n                        child.visible = false;  // Hide collision mesh\n                        if(FLAGS.ASSET_LOGS) console.log(`Found collision mesh for ${asset_type}:`, {\n                            name: child.name,\n                            vertices: child.geometry.attributes.position.count,\n                            hasIndices: !!child.geometry.index,\n                            position: child.position,\n                            scale: asset_config.scale\n                        });\n                    } else {\n                        // Regular mesh handling\n                        child.material = child.material.clone();\n                        child.material.depthTest = true;\n                        child.material.transparent = false;\n                        child.name = `${TYPES.INTERACTABLE}${asset_config.name}`;\n                        child.castShadow = true;\n                    }\n                }\n            });\n\n            // Create physics body with all collision meshes if found\n            if (collision_meshes.length > 0) {\n                if(FLAGS.ASSET_LOGS) console.log(`Creating compound collider for ${asset_type} with ${collision_meshes.length} collision meshes`);\n                \n                // Create colliders for each collision mesh\n                collision_meshes.forEach((collision_mesh) => {\n                    const geometry = collision_mesh.geometry;\n                    \n                    // Scale the vertices by the asset's scale\n                    const originalVertices = geometry.attributes.position.array;\n                    const scaledVertices = new Float32Array(originalVertices.length);\n                    for (let i = 0; i < originalVertices.length; i++) {\n                        scaledVertices[i] = originalVertices[i] * asset_config.scale;\n                    }\n                    \n                    const indices = geometry.index ? geometry.index.array : undefined;\n                    \n                    if(FLAGS.ASSET_LOGS) console.log(`Creating collider component for ${collision_mesh.name}:`, {\n                        vertexCount: scaledVertices.length / 3,\n                        indexCount: indices ? indices.length : 'none',\n                        scale: asset_config.scale,\n                        position: collision_mesh.position\n                    });\n\n                    let collider;\n                    if (indices) {\n                        collider = RAPIER.ColliderDesc.trimesh(scaledVertices, indices)\n                            .setMass(asset_config.mass)\n                            .setRestitution(asset_config.restitution);\n                    } else {\n                        collider = RAPIER.ColliderDesc.convexHull(scaledVertices)\n                            .setMass(asset_config.mass)\n                            .setRestitution(asset_config.restitution);\n                    }\n\n                    // Get the collision mesh's position relative to the model\n                    const meshPosition = new THREE.Vector3();\n                    collision_mesh.getWorldPosition(meshPosition);\n                    const relativePosition = meshPosition.sub(mesh.position);\n                    \n                    // Apply the relative position to the collider\n                    collider.setTranslation(\n                        relativePosition.x * asset_config.scale,\n                        relativePosition.y * asset_config.scale,\n                        relativePosition.z * asset_config.scale\n                    );\n                    \n                    world.createCollider(collider, body);\n                });\n            } else {\n                if(FLAGS.ASSET_LOGS) console.warn(`No collision mesh found for ${asset_type}, falling back to bounding box`);\n                let geometry;\n                mesh.traverse((child) => {\n                    if (child.isMesh && !child.name.startsWith('col_')) geometry = child.geometry;\n                });\n                if (geometry) {\n                    geometry.computeBoundingBox();\n                    const bounding_box = geometry.boundingBox;\n                    const dimensions = new THREE.Vector3();\n                    bounding_box.getSize(dimensions);\n\n                    const half_width = (dimensions.x * asset_config.scale) / 2;\n                    const half_height = (dimensions.y * asset_config.scale) / 2;\n                    const half_depth = (dimensions.z * asset_config.scale) / 2;\n\n                    const collider = RAPIER.ColliderDesc.cuboid(half_width, half_height, half_depth)\n                        .setMass(asset_config.mass)\n                        .setRestitution(asset_config.restitution);\n\n                    const created_collider = world.createCollider(collider, body);\n                    if(FLAGS.ASSET_LOGS) console.log(`Created bounding box collider:`, created_collider);\n                    if(FLAGS.ASSET_LOGS) console.log(`Collider dimensions:`, {\n                        width: half_width,\n                        height: half_height,\n                        depth: half_depth,\n                        mass: asset_config.mass,\n                        restitution: asset_config.restitution\n                    });\n                }\n            }\n        }\n        // Add mesh to parent\n        parent.add(mesh);\n        // Generate a truly unique ID using counter instead of timestamp\n        const instance_id = `${asset_type}_${this.get_new_instance_id()}`;\n        const body_pair = [mesh, body];\n        this.dynamic_bodies.set(instance_id, body_pair);\n        \n        // Add the instance_id to the mesh's userData for reference\n        mesh.userData.instance_id = instance_id;\n        \n        return body_pair;\n    }\n\n\n    /**\n     * Adds the incoming object to the dynamic bodies map\n     * Also assigns a unique identifier to the mesh for retrieval\n     * @param {*} incoming_object \n     */\n    add_object(incoming_mesh, incoming_body) {\n        if (!incoming_mesh) {\n            console.error('Cannot add object: incoming_mesh is undefined');\n            return;\n        }\n        if(incoming_mesh.name) {\n            const incoming_name = incoming_mesh.name;\n            const instance_id = `${incoming_name}_${this.get_new_instance_id()}`;\n            const incoming_pair = [incoming_mesh, incoming_body];\n            this.dynamic_bodies.set(instance_id, incoming_pair);\n            incoming_mesh.userData.instance_id = instance_id;\n        } else {\n            console.error(`${incoming_mesh} ${incoming_body} mesh body combo could not be added because the mesh didn't have a name`);\n        }\n    }\n\n    /**\n     * Creates a static (non-physics) mesh of the specified asset type\n     * @param {string} asset_type - Type of asset from ASSET_TYPE enum\n     * @param {THREE.Object3D} parent - Parent object to add the mesh to\n     * @param {THREE.Vector3} position_offset - Position offset from parent\n     * @param {THREE.Quaternion} rotation - Rotation of the mesh\n     * @returns {THREE.Object3D} The created mesh\n     */\n    async create_static_mesh(asset_type, parent, position_offset = new THREE.Vector3(0, 0, 0), rotation = null) {\n        if (!Object.values(ASSET_TYPE).includes(asset_type)) throw new Error(`Invalid asset type: ${asset_type}`);\n        const asset_config = ASSET_CONFIGS[asset_type];\n        let mesh;\n        if (asset_type === ASSET_TYPE.CUBE) {\n            mesh = new THREE.Mesh(asset_config.geometry, asset_config.create_material(0xffffff));\n            mesh.castShadow = true;\n        } else {\n            if (!this.loaded_assets.has(asset_type)) await this.load_asset_type(asset_type);\n            const gltf = this.loaded_assets.get(asset_type);\n            mesh = gltf.scene.clone();\n            mesh.scale.set(asset_config.scale, asset_config.scale, asset_config.scale);\n            \n            if(FLAGS.ASSET_LOGS) console.log('Creating static mesh for UI:', {\n                assetType: asset_type,\n                parentType: parent.type,\n                parentName: parent.name,\n                isOverlay: parent.parent?.parent?.name?.includes('overlay')\n            });\n\n            mesh.traverse((child) => {\n                if (child.isMesh) {\n                    if(FLAGS.ASSET_LOGS) console.log('Original material properties:', {\n                        hasMap: !!child.material.map,\n                        color: child.material.color,\n                        type: child.material.type\n                    });\n\n                    // Force UI rendering properties\n                    child.material = new THREE.MeshBasicMaterial({\n                        map: child.material.map,\n                        color: child.material.color,\n                        transparent: true,\n                        depthTest: false,\n                        side: THREE.DoubleSide,\n                        opacity: 1\n                    });\n                    child.renderOrder = 999; // Ensure it renders on top\n\n                    if(FLAGS.ASSET_LOGS) console.log('New material properties:', {\n                        hasMap: !!child.material.map,\n                        color: child.material.color,\n                        type: child.material.type,\n                        transparent: child.material.transparent,\n                        depthTest: child.material.depthTest,\n                        renderOrder: child.renderOrder\n                    });\n                }\n            });\n        }\n        mesh.position.copy(position_offset);\n        if (rotation) mesh.rotation.copy(rotation);\n        mesh.renderOrder = 999;\n        parent.add(mesh);\n        const instance_id = `${asset_type}_static_${Date.now()}`;\n        this.static_meshes.set(instance_id, mesh);\n        return mesh;\n    }\n\n    update() {\n        this.get_all_dynamic_bodies().forEach(([mesh, body]) => {\n            if (body) {\n                const position = body.translation();\n                mesh.position.set(position.x, position.y, position.z);\n                const rotation = body.rotation();\n                mesh.quaternion.set(rotation.x, rotation.y, rotation.z, rotation.w);\n            }\n        });\n    }\n\n    get_all_dynamic_bodies() {\n        return Array.from(this.dynamic_bodies.values());\n    }\n\n    get_all_static_meshes() {\n        return Array.from(this.static_meshes.values());\n    }\n\n    // Update method to get body pair by mesh\n    get_body_pair_by_mesh(mesh) {\n        // First check if the current mesh has the instance_id\n        let instance_id = mesh.userData.instance_id;\n        // If not found, traverse up the parent hierarchy\n        let current = mesh;\n        while (!instance_id && current.parent) {\n            current = current.parent;\n            instance_id = current.userData.instance_id;\n        }\n        return instance_id ? this.dynamic_bodies.get(instance_id) : null;\n    }\n\n    // Add helper method to check if a mesh is actually emissive\n    is_mesh_emissive(mesh) {\n        if (!mesh) return false;\n        let has_emissive = false;\n        \n        const check_material = (material) => {\n            return material && \n                   material.emissive && \n                   material.emissiveIntensity > 0 &&\n                   material.emissiveIntensity === 9; // Our target intensity\n        };\n        \n        if (mesh.isGroup || mesh.isObject3D) {\n            mesh.traverse((child) => {\n                if (child.isMesh && !child.name.startsWith('col_')) {\n                    if (check_material(child.material)) {\n                        has_emissive = true;\n                    }\n                }\n            });\n        } else if (mesh.isMesh) {\n            has_emissive = check_material(mesh.material);\n        }\n        \n        return has_emissive;\n    }\n\n    activate_object(object_name) {        \n        // First check if we think it's active\n        if(object_name === this.currently_activated_name) {\n            if (this.emission_states.get(object_name) === 'active') {\n                // Verify the actual material state\n                let found_and_verified = false;\n                for (const [instance_id, [mesh, _body]] of this.dynamic_bodies) {\n                    const mesh_category = mesh.name.split(\"_\")[1];\n                    if (mesh_category === object_name.split(\"_\")[1]) {\n                        // If we find the mesh but it's not actually emissive, we need to reapply\n                        if (this.is_mesh_emissive(mesh)) {\n                            found_and_verified = true;\n                            return;\n                        } else {\n                            if (FLAGS.ACTIVATE_LOGS) console.log(`${this.name} Object ${object_name} claims to be active but isn't emissive - reapplying`);\n                            this.emission_states.delete(object_name);\n                            break;\n                        }\n                    }\n                }\n                if (!found_and_verified) {\n                    if (FLAGS.ACTIVATE_LOGS) console.log(`${this.name} Object ${object_name} not found for verification - resetting state`);\n                    this.emission_states.delete(object_name);\n                }\n            }\n        }\n        \n        // Rest of the activation logic remains the same...\n        // Deactivate previously activated object if it's different\n        if (this.currently_activated_name !== object_name) {\n            if (FLAGS.ACTIVATE_LOGS) console.log(`${this.name} Deactivating previous: ${this.currently_activated_name}`);\n            this.deactivate_object(this.currently_activated_name);\n        }\n        \n        this.currently_activated_name = object_name;\n        \n        // Extract the category name from the incoming object name\n        const requested_category = object_name.split(\"_\")[1];\n        if (FLAGS.ACTIVATE_LOGS) console.log(`${this.name} Looking for category: ${requested_category}`);\n        \n        let found = false;\n        for (const [instance_id, [mesh, _body]] of this.dynamic_bodies) {\n            const mesh_category = mesh.name.split(\"_\")[1];\n            \n            if (mesh_category === requested_category) {\n                found = true;\n                if (FLAGS.ACTIVATE_LOGS) console.log(`${this.name} Found matching mesh by category: ${mesh_category}`);\n                \n                const category = Object.values(CATEGORIES).find(cat => \n                    typeof cat !== 'function' && cat.value === requested_category\n                );\n                \n                if (category) {\n                    if (FLAGS.ACTIVATE_LOGS) console.log(`${this.name} Applying emission material with color: ${category.color}`);\n                    \n                    // Set the emission state to 'applying'\n                    this.emission_states.set(object_name, 'applying');\n                    \n                    // Function to create emission material\n                    const createEmissionMaterial = (originalMaterial) => {\n                        return new THREE.MeshStandardMaterial({ \n                            color: category.color,\n                            emissive: category.color,\n                            emissiveIntensity: 9,\n                            map: originalMaterial?.map || null,\n                            transparent: originalMaterial?.transparent || false,\n                            opacity: originalMaterial?.opacity || 1,\n                        });\n                    };\n\n                    let meshesProcessed = 0;\n                    let totalMeshes = 0;\n\n                    // Count total meshes first\n                    if (mesh.isGroup || mesh.isObject3D) {\n                        mesh.traverse((child) => {\n                            if (child.isMesh && !child.name.startsWith('col_')) totalMeshes++;\n                        });\n                    } else if (mesh.isMesh) {\n                        totalMeshes = 1;\n                    }\n\n                    // For GLB models, we need to traverse all meshes\n                    if (mesh.isGroup || mesh.isObject3D) {\n                        mesh.traverse((child) => {\n                            if (child.isMesh && !child.name.startsWith('col_')) {\n                                // Store the original material for deactivation\n                                if (!child.userData.originalMaterial) {\n                                    child.userData.originalMaterial = child.material.clone();\n                                }\n                                // Apply new emission material while preserving textures\n                                if (child.material) child.material.dispose();\n                                child.material = createEmissionMaterial(child.userData.originalMaterial);\n                                meshesProcessed++;\n                                \n                                // Check if all meshes are processed and verify emission\n                                if (meshesProcessed === totalMeshes) {\n                                    if (this.is_mesh_emissive(mesh)) {\n                                        this.emission_states.set(object_name, 'active');\n                                        if (FLAGS.ACTIVATE_LOGS) console.log(`${this.name} Object ${object_name} is now fully activated and verified`);\n                                    } else {\n                                        if (FLAGS.ACTIVATE_LOGS) console.warn(`[${this.name} Failed to apply emission to ${object_name}`);\n                                        this.emission_states.delete(object_name);\n                                    }\n                                }\n                            }\n                        });\n                    } else if (mesh.isMesh) {\n                        // For primitive objects like cubes\n                        if (!mesh.userData.originalMaterial) {\n                            mesh.userData.originalMaterial = mesh.material.clone();\n                        }\n                        if (mesh.material) mesh.material.dispose();\n                        mesh.material = createEmissionMaterial(mesh.userData.originalMaterial);\n                        \n                        // Verify emission for primitive mesh\n                        if (this.is_mesh_emissive(mesh)) {\n                            this.emission_states.set(object_name, 'active');\n                            if (FLAGS.ACTIVATE_LOGS) console.log(`${this.name} Object ${object_name} is now fully activated and verified`);\n                        } else {\n                            if (FLAGS.ACTIVATE_LOGS) console.warn(`${this.name} Failed to apply emission to ${object_name}`);\n                            this.emission_states.delete(object_name);\n                        }\n                    }\n                }\n                break;\n            }\n        }\n        if (!found && FLAGS.ACTIVATE_LOGS) {\n            console.warn(`${this.name} No mesh found for category: ${requested_category}`);\n            this.emission_states.delete(object_name);\n        }\n    }\n\n    /**\n     * Deactivates an object by tweening its emission to zero\n     * @param {string} object_name - Name of the object to deactivate\n     */\n    deactivate_object(object_name) {\n        if (!object_name) return;\n        \n        const requested_category = object_name.split(\"_\")[1];\n        let found = false;\n        \n        for (const [instance_id, [mesh, _body]] of this.dynamic_bodies) {\n            const mesh_category = mesh.name.split(\"_\")[1];\n            \n            if (mesh_category === requested_category) {\n                found = true;\n                if (FLAGS.ACTIVATE_LOGS) console.log(`${this.name} Found mesh to deactivate: ${mesh.name}`);\n                \n                // Set deactivation state\n                this.emission_states.set(object_name, 'deactivating');\n                \n                let meshesProcessed = 0;\n                let totalMeshes = 0;\n\n                // Count total meshes first\n                if (mesh.isGroup || mesh.isObject3D) {\n                    mesh.traverse((child) => {\n                        if (child.isMesh && !child.name.startsWith('col_')) totalMeshes++;\n                    });\n                } else if (mesh.isMesh) {\n                    totalMeshes = 1;\n                }\n\n                const deactivateMesh = (targetMesh) => {\n                    // Only proceed if we have an original material to restore to\n                    if (targetMesh.userData.originalMaterial) {\n                        // Create a new tween for the emission fade out\n                        if (targetMesh.material && targetMesh.material.emissiveIntensity > 0) {\n                            // Clone the current material to avoid affecting other instances\n                            const tweenMaterial = targetMesh.material.clone();\n                            targetMesh.material = tweenMaterial;\n\n                            new Tween(tweenMaterial)\n                                .to({ emissiveIntensity: 0 }, 500) // 500ms duration for smooth transition\n                                .easing(Easing.Quadratic.Out)\n                                .onComplete(() => {\n                                    // Cleanup the tween material\n                                    if (tweenMaterial) tweenMaterial.dispose();\n                                    \n                                    // Restore the original material\n                                    const restoredMaterial = targetMesh.userData.originalMaterial.clone();\n                                    targetMesh.material = restoredMaterial;\n                                    \n                                    meshesProcessed++;\n                                    if (meshesProcessed === totalMeshes) {\n                                        this.emission_states.delete(object_name);\n                                        if (FLAGS.ACTIVATE_LOGS) console.log(`${this.name} Object ${object_name} is now fully deactivated`);\n                                    }\n                                    \n                                    if (FLAGS.ACTIVATE_LOGS) console.log(`${this.name} Restored original material for: ${targetMesh.name}`);\n                                })\n                                .start();\n                        }\n                    } else if (FLAGS.ACTIVATE_LOGS) {\n                        console.warn(`${this.name} No original material found for: ${targetMesh.name}`);\n                        meshesProcessed++;\n                        if (meshesProcessed === totalMeshes) {\n                            this.emission_states.delete(object_name);\n                        }\n                    }\n                };\n\n                // Handle both GLB models and primitive objects\n                if (mesh.isGroup || mesh.isObject3D) {\n                    mesh.traverse((child) => {\n                        if (child.isMesh && !child.name.startsWith('col_')) {\n                            deactivateMesh(child);\n                        }\n                    });\n                } else if (mesh.isMesh) {\n                    deactivateMesh(mesh);\n                }\n                break;\n            }\n        }\n        if (!found && FLAGS.ACTIVATE_LOGS) {\n            console.warn(`${this.name} No active mesh found for category: ${requested_category}`);\n            this.emission_states.delete(object_name);\n        }\n    }\n\n    /**\n     * Deactivates all objects that match the given type prefix, or all objects if no prefix provided\n     * @param {string} [type_prefix] - Optional prefix to match object names against\n     */\n    deactivate_all_objects(type_prefix = null) {\n        // Only proceed if we have an active object\n        if (!this.currently_activated_name) return;\n        \n        if (FLAGS.ACTIVATE_LOGS) console.log(`${this.name} Deactivating all objects${type_prefix ? ` with prefix: ${type_prefix}` : ''}`);\n        let deactivation_count = 0;\n        \n        const deactivateMesh = (targetMesh) => {\n            if (targetMesh.material && \n                targetMesh.material.emissive && \n                targetMesh.material.emissiveIntensity > 0) {\n                if (FLAGS.ACTIVATE_LOGS) console.log(`${this.name} Deactivating emissive mesh: ${targetMesh.name}`);\n                \n                // Clone the current material to avoid affecting other instances\n                const tweenMaterial = targetMesh.material.clone();\n                targetMesh.material = tweenMaterial;\n\n                new Tween(tweenMaterial)\n                    .to({ emissiveIntensity: 0 }, 500)\n                    .easing(Easing.Quadratic.Out)\n                    .onComplete(() => {\n                        // Cleanup the tween material\n                        if (tweenMaterial) tweenMaterial.dispose();\n                        \n                        // Restore the original material if it exists\n                        if (targetMesh.userData.originalMaterial) {\n                            const restoredMaterial = targetMesh.userData.originalMaterial.clone();\n                            targetMesh.material = restoredMaterial;\n                        }\n                    })\n                    .start();\n                deactivation_count++;\n            }\n        };\n\n        for (const [instance_id, [mesh, _body]] of this.dynamic_bodies) {\n            if (type_prefix && !mesh.name.startsWith(type_prefix)) {\n                continue;\n            }\n            \n            // Handle both GLB models and primitive objects\n            if (mesh.isGroup || mesh.isObject3D) {\n                mesh.traverse((child) => {\n                    if (child.isMesh && !child.name.startsWith('col_')) {\n                        deactivateMesh(child);\n                    }\n                });\n            } else if (mesh.isMesh) {\n                deactivateMesh(mesh);\n            }\n        }\n        \n        if (deactivation_count > 0 && FLAGS.ACTIVATE_LOGS) {\n            console.log(`[AssetManager] Deactivated ${deactivation_count} objects`);\n        }\n        \n        // Reset the currently activated name since we've deactivated everything\n        this.currently_activated_name = \"\";\n    }\n\n    /**\n     * Checks if an object with the given name exists\n     * @param {string} object_name - Name of the object to check\n     * @returns {boolean} True if the object exists\n     */\n    contains_object(object_name) {\n        for (const [_, [mesh, _body]] of this.dynamic_bodies) {\n            if (mesh.name === object_name) return true;\n        }\n        return false;\n    }\n}","import { THREE } from \"../../../common\";\n\nexport const TEXTURE_LOADER = new THREE.TextureLoader();\n// Constants\nexport const PAN_SPEED = 800;\nexport const ROTATE_SPEED = 300;\nexport const FOCUS_ROTATION = .7;\nexport const LINK_RADIUS = .44;\nexport const HIDE_WIDTH = 1;\nexport const HIDE_HEIGHT = 1;\n\n/**\n * Takes a named object and returns the substring before '_' character\n * @param {*} incoming_object any named object\n * @returns Extracts the substring before '_' character\n */\nexport function extract_type(incoming_object) {\n    if (!incoming_object || !incoming_object.name) {\n        return \"\";\n    }\n    const split_intersected_name = incoming_object.name.split(\"_\");\n    const name_type = split_intersected_name[0] + \"_\";\n    return name_type;\n}\n\n// Mouse detection\nconst raycaster = new THREE.Raycaster();\nconst mouse_location = new THREE.Vector2();\n\n/** Converts screen coordinates to Normalized Device Coordinates (NDC) */\nexport function get_ndc_from_event(e) {\n    return {\n        x: (e.clientX / window.innerWidth) * 2 - 1,\n        y: -(e.clientY / window.innerHeight) * 2 + 1\n    };\n}\n\n/** Retrieves objects mouse is intersecting with from the given event */\nexport function get_intersect_list(e, incoming_camera, incoming_scene) {\n    const ndc = get_ndc_from_event(e);\n    mouse_location.x = ndc.x;\n    mouse_location.y = ndc.y;\n    raycaster.setFromCamera(mouse_location, incoming_camera);\n    return raycaster.intersectObject(incoming_scene, true);\n}","import { THREE } from \"../../../common\";\n\n// Directions\nexport const NORTH = \"north\";\nexport const SOUTH = \"south\";\nexport const EAST = \"east\";\nexport const WEST = \"west\";\nexport const VALID_DIRECTIONS =[\n    NORTH,\n    SOUTH,\n    EAST,\n    WEST\n]\n\n/** Calculates screen size based off a distance of 15 */\nexport function get_screen_size(incoming_camera) {\n    const screen_size = new THREE.Vector2();\n    incoming_camera.getViewSize(15, screen_size);\n    return screen_size;\n}\n\n/** Gets final location of assicated direction given current camera \n ** incoming_direction must be a member of DIRECTIONS\n*/\nexport function get_associated_position(incoming_direction, incoming_camera) {\n    if(VALID_DIRECTIONS.includes(incoming_direction)) {\n        const screen_size = get_screen_size(incoming_camera);\n        switch(incoming_direction) {\n            case NORTH:\n                return screen_size.y;\n            case SOUTH:\n                return -screen_size.y;\n            case EAST:\n                return screen_size.x;\n            case WEST:\n                return -screen_size.x;\n        }\n    }\n}","export const CATEGORIES = {\n    CONTACT: {\n        value: \"contact\",\n        icon: \"categories/contact_raised.svg\",\n        color: 0xe5ce38,\n        html: \"pages/contact.html\"\n    },\n    PROJECTS: {\n        value: \"projects\",\n        icon: \"categories/projects_raised.svg\",\n        color: 0x834eb4,\n        html: \"pages/projects.html\"\n    },\n    WORK: {\n        value: \"work\",\n        icon: \"categories/work_raised.svg\",\n        color: 0xb44444,\n        html: \"pages/work.html\"\n    },\n    EDUCATION: {\n        value: \"education\",\n        icon: \"categories/education_raised.svg\",\n        color: 0x25973a,\n        html: \"pages/education.html\"\n    },\n    ABOUT: {\n        value: \"about\",\n        icon: \"categories/about_raised.svg\",\n        color: 0x3851e5,\n        html: \"pages/about.html\"\n    }\n};\n\n// Helper methods\nObject.defineProperty(CATEGORIES, \"getValues\", {\n    value: function() {\n        return Object.values(this).map(cat => cat.value);\n    },\n    enumerable: false\n});\n\nObject.defineProperty(CATEGORIES, \"getIcons\", {\n    value: function() {\n        return Object.values(this).map(cat => cat.icon);\n    },\n    enumerable: false\n});\n\nObject.defineProperty(CATEGORIES, \"getColors\", {\n    value: function() {\n        return Object.values(this).map(cat => cat.color);\n    },\n    enumerable: false\n});\n\nObject.defineProperty(CATEGORIES, \"getHtmlPaths\", {\n    value: function() {\n        return Object.values(this).map(cat => cat.html);\n    },\n    enumerable: false\n});\n\nObject.freeze(CATEGORIES);","export const LINKS = {\n    GITHUB: {\n        value: \"github\",\n        url: \"https://github.com/blooooork\",\n        icon_path: \"links/github_link.svg\"\n    },\n    TWITCH: {\n        value: \"twitch\",\n        url: \"https://www.twitch.tv/blooooork\",\n        icon_path: \"links/twitch_link.svg\"\n    },\n    LINKEDIN: {\n        value: \"linkedin\",\n        url: \"https://www.linkedin.com/in/meiersteven\",\n        icon_path: \"links/linkedin_link.svg\"\n    },\n    TIKTOK: {\n        value: \"tiktok\",\n        url: \"https://www.tiktok.com/@blooooork\",\n        icon_path: \"links/tiktok_link.svg\"\n    }\n};\n\n// Attach the function as a non-enumerable property.\nObject.defineProperty(LINKS, \"get_link\", {\n    value: function(incoming_string) {\n        for (const key in this) {\n            // Ensure we only process objects that represent links\n            if (this[key] && typeof this[key] === \"object\" && this[key].value === incoming_string) {\n                return this[key].url;\n            }\n        }\n        return null;\n    },\n    enumerable: false  // so that get_link is not included in iterations\n});\n\nObject.freeze(LINKS);","import { TYPES } from '../viewport/overlay/overlay_common';\nimport { NAMES, RAPIER, THREE } from '../common';\n\nexport class BackgroundFloor {\n\n    constructor(incoming_world, incoming_parent, incoming_camera) {\n        this.world = incoming_world;\n        this.parent = incoming_parent;\n        this.camera = incoming_camera;\n        const floor_geometry = new THREE.BoxGeometry(100, 1, 100);\n        const floor_material = new THREE.MeshStandardMaterial({ color: 0x808080 });\n        this.floor_mesh = new THREE.Mesh(floor_geometry, floor_material);\n        this.floor_mesh.receiveShadow = true;\n        this.floor_mesh.position.y = -10.2;\n        this.floor_mesh.name = `${TYPES.FLOOR}${NAMES.UNIQUE}`;\n        // TODO Make this a toggleable feature\n        // Disable raycasting for this mesh\n        this.floor_mesh.raycast = () => null;\n        this.parent.add(this.floor_mesh);\n        const floor_body = this.world.createRigidBody(RAPIER.RigidBodyDesc.fixed().setTranslation(0, this.floor_mesh.position.y, 0));\n        const floor_shape = RAPIER.ColliderDesc.cuboid(50, 0.5, 50);\n        this.world.createCollider(floor_shape, floor_body);\n    }\n}","const _lut = [ '00', '01', '02', '03', '04', '05', '06', '07', '08', '09', '0a', '0b', '0c', '0d', '0e', '0f', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '1a', '1b', '1c', '1d', '1e', '1f', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '2a', '2b', '2c', '2d', '2e', '2f', '30', '31', '32', '33', '34', '35', '36', '37', '38', '39', '3a', '3b', '3c', '3d', '3e', '3f', '40', '41', '42', '43', '44', '45', '46', '47', '48', '49', '4a', '4b', '4c', '4d', '4e', '4f', '50', '51', '52', '53', '54', '55', '56', '57', '58', '59', '5a', '5b', '5c', '5d', '5e', '5f', '60', '61', '62', '63', '64', '65', '66', '67', '68', '69', '6a', '6b', '6c', '6d', '6e', '6f', '70', '71', '72', '73', '74', '75', '76', '77', '78', '79', '7a', '7b', '7c', '7d', '7e', '7f', '80', '81', '82', '83', '84', '85', '86', '87', '88', '89', '8a', '8b', '8c', '8d', '8e', '8f', '90', '91', '92', '93', '94', '95', '96', '97', '98', '99', '9a', '9b', '9c', '9d', '9e', '9f', 'a0', 'a1', 'a2', 'a3', 'a4', 'a5', 'a6', 'a7', 'a8', 'a9', 'aa', 'ab', 'ac', 'ad', 'ae', 'af', 'b0', 'b1', 'b2', 'b3', 'b4', 'b5', 'b6', 'b7', 'b8', 'b9', 'ba', 'bb', 'bc', 'bd', 'be', 'bf', 'c0', 'c1', 'c2', 'c3', 'c4', 'c5', 'c6', 'c7', 'c8', 'c9', 'ca', 'cb', 'cc', 'cd', 'ce', 'cf', 'd0', 'd1', 'd2', 'd3', 'd4', 'd5', 'd6', 'd7', 'd8', 'd9', 'da', 'db', 'dc', 'dd', 'de', 'df', 'e0', 'e1', 'e2', 'e3', 'e4', 'e5', 'e6', 'e7', 'e8', 'e9', 'ea', 'eb', 'ec', 'ed', 'ee', 'ef', 'f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9', 'fa', 'fb', 'fc', 'fd', 'fe', 'ff' ];\n\nlet _seed = 1234567;\n\n\nconst DEG2RAD = Math.PI / 180;\nconst RAD2DEG = 180 / Math.PI;\n\n// http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136\nfunction generateUUID() {\n\n\tconst d0 = Math.random() * 0xffffffff | 0;\n\tconst d1 = Math.random() * 0xffffffff | 0;\n\tconst d2 = Math.random() * 0xffffffff | 0;\n\tconst d3 = Math.random() * 0xffffffff | 0;\n\tconst uuid = _lut[ d0 & 0xff ] + _lut[ d0 >> 8 & 0xff ] + _lut[ d0 >> 16 & 0xff ] + _lut[ d0 >> 24 & 0xff ] + '-' +\n\t\t\t_lut[ d1 & 0xff ] + _lut[ d1 >> 8 & 0xff ] + '-' + _lut[ d1 >> 16 & 0x0f | 0x40 ] + _lut[ d1 >> 24 & 0xff ] + '-' +\n\t\t\t_lut[ d2 & 0x3f | 0x80 ] + _lut[ d2 >> 8 & 0xff ] + '-' + _lut[ d2 >> 16 & 0xff ] + _lut[ d2 >> 24 & 0xff ] +\n\t\t\t_lut[ d3 & 0xff ] + _lut[ d3 >> 8 & 0xff ] + _lut[ d3 >> 16 & 0xff ] + _lut[ d3 >> 24 & 0xff ];\n\n\t// .toLowerCase() here flattens concatenated strings to save heap memory space.\n\treturn uuid.toLowerCase();\n\n}\n\nfunction clamp( value, min, max ) {\n\n\treturn Math.max( min, Math.min( max, value ) );\n\n}\n\n// compute euclidean modulo of m % n\n// https://en.wikipedia.org/wiki/Modulo_operation\nfunction euclideanModulo( n, m ) {\n\n\treturn ( ( n % m ) + m ) % m;\n\n}\n\n// Linear mapping from range <a1, a2> to range <b1, b2>\nfunction mapLinear( x, a1, a2, b1, b2 ) {\n\n\treturn b1 + ( x - a1 ) * ( b2 - b1 ) / ( a2 - a1 );\n\n}\n\n// https://www.gamedev.net/tutorials/programming/general-and-gameplay-programming/inverse-lerp-a-super-useful-yet-often-overlooked-function-r5230/\nfunction inverseLerp( x, y, value ) {\n\n\tif ( x !== y ) {\n\n\t\treturn ( value - x ) / ( y - x );\n\n\t} else {\n\n\t\treturn 0;\n\n\t}\n\n}\n\n// https://en.wikipedia.org/wiki/Linear_interpolation\nfunction lerp( x, y, t ) {\n\n\treturn ( 1 - t ) * x + t * y;\n\n}\n\n// http://www.rorydriscoll.com/2016/03/07/frame-rate-independent-damping-using-lerp/\nfunction damp( x, y, lambda, dt ) {\n\n\treturn lerp( x, y, 1 - Math.exp( - lambda * dt ) );\n\n}\n\n// https://www.desmos.com/calculator/vcsjnyz7x4\nfunction pingpong( x, length = 1 ) {\n\n\treturn length - Math.abs( euclideanModulo( x, length * 2 ) - length );\n\n}\n\n// http://en.wikipedia.org/wiki/Smoothstep\nfunction smoothstep( x, min, max ) {\n\n\tif ( x <= min ) return 0;\n\tif ( x >= max ) return 1;\n\n\tx = ( x - min ) / ( max - min );\n\n\treturn x * x * ( 3 - 2 * x );\n\n}\n\nfunction smootherstep( x, min, max ) {\n\n\tif ( x <= min ) return 0;\n\tif ( x >= max ) return 1;\n\n\tx = ( x - min ) / ( max - min );\n\n\treturn x * x * x * ( x * ( x * 6 - 15 ) + 10 );\n\n}\n\n// Random integer from <low, high> interval\nfunction randInt( low, high ) {\n\n\treturn low + Math.floor( Math.random() * ( high - low + 1 ) );\n\n}\n\n// Random float from <low, high> interval\nfunction randFloat( low, high ) {\n\n\treturn low + Math.random() * ( high - low );\n\n}\n\n// Random float from <-range/2, range/2> interval\nfunction randFloatSpread( range ) {\n\n\treturn range * ( 0.5 - Math.random() );\n\n}\n\n// Deterministic pseudo-random float in the interval [ 0, 1 ]\nfunction seededRandom( s ) {\n\n\tif ( s !== undefined ) _seed = s;\n\n\t// Mulberry32 generator\n\n\tlet t = _seed += 0x6D2B79F5;\n\n\tt = Math.imul( t ^ t >>> 15, t | 1 );\n\n\tt ^= t + Math.imul( t ^ t >>> 7, t | 61 );\n\n\treturn ( ( t ^ t >>> 14 ) >>> 0 ) / 4294967296;\n\n}\n\nfunction degToRad( degrees ) {\n\n\treturn degrees * DEG2RAD;\n\n}\n\nfunction radToDeg( radians ) {\n\n\treturn radians * RAD2DEG;\n\n}\n\nfunction isPowerOfTwo( value ) {\n\n\treturn ( value & ( value - 1 ) ) === 0 && value !== 0;\n\n}\n\nfunction ceilPowerOfTwo( value ) {\n\n\treturn Math.pow( 2, Math.ceil( Math.log( value ) / Math.LN2 ) );\n\n}\n\nfunction floorPowerOfTwo( value ) {\n\n\treturn Math.pow( 2, Math.floor( Math.log( value ) / Math.LN2 ) );\n\n}\n\nfunction setQuaternionFromProperEuler( q, a, b, c, order ) {\n\n\t// Intrinsic Proper Euler Angles - see https://en.wikipedia.org/wiki/Euler_angles\n\n\t// rotations are applied to the axes in the order specified by 'order'\n\t// rotation by angle 'a' is applied first, then by angle 'b', then by angle 'c'\n\t// angles are in radians\n\n\tconst cos = Math.cos;\n\tconst sin = Math.sin;\n\n\tconst c2 = cos( b / 2 );\n\tconst s2 = sin( b / 2 );\n\n\tconst c13 = cos( ( a + c ) / 2 );\n\tconst s13 = sin( ( a + c ) / 2 );\n\n\tconst c1_3 = cos( ( a - c ) / 2 );\n\tconst s1_3 = sin( ( a - c ) / 2 );\n\n\tconst c3_1 = cos( ( c - a ) / 2 );\n\tconst s3_1 = sin( ( c - a ) / 2 );\n\n\tswitch ( order ) {\n\n\t\tcase 'XYX':\n\t\t\tq.set( c2 * s13, s2 * c1_3, s2 * s1_3, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'YZY':\n\t\t\tq.set( s2 * s1_3, c2 * s13, s2 * c1_3, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'ZXZ':\n\t\t\tq.set( s2 * c1_3, s2 * s1_3, c2 * s13, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'XZX':\n\t\t\tq.set( c2 * s13, s2 * s3_1, s2 * c3_1, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'YXY':\n\t\t\tq.set( s2 * c3_1, c2 * s13, s2 * s3_1, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'ZYZ':\n\t\t\tq.set( s2 * s3_1, s2 * c3_1, c2 * s13, c2 * c13 );\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tconsole.warn( 'THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: ' + order );\n\n\t}\n\n}\n\nfunction denormalize( value, array ) {\n\n\tswitch ( array.constructor ) {\n\n\t\tcase Float32Array:\n\n\t\t\treturn value;\n\n\t\tcase Uint32Array:\n\n\t\t\treturn value / 4294967295.0;\n\n\t\tcase Uint16Array:\n\n\t\t\treturn value / 65535.0;\n\n\t\tcase Uint8Array:\n\n\t\t\treturn value / 255.0;\n\n\t\tcase Int32Array:\n\n\t\t\treturn Math.max( value / 2147483647.0, - 1.0 );\n\n\t\tcase Int16Array:\n\n\t\t\treturn Math.max( value / 32767.0, - 1.0 );\n\n\t\tcase Int8Array:\n\n\t\t\treturn Math.max( value / 127.0, - 1.0 );\n\n\t\tdefault:\n\n\t\t\tthrow new Error( 'Invalid component type.' );\n\n\t}\n\n}\n\nfunction normalize( value, array ) {\n\n\tswitch ( array.constructor ) {\n\n\t\tcase Float32Array:\n\n\t\t\treturn value;\n\n\t\tcase Uint32Array:\n\n\t\t\treturn Math.round( value * 4294967295.0 );\n\n\t\tcase Uint16Array:\n\n\t\t\treturn Math.round( value * 65535.0 );\n\n\t\tcase Uint8Array:\n\n\t\t\treturn Math.round( value * 255.0 );\n\n\t\tcase Int32Array:\n\n\t\t\treturn Math.round( value * 2147483647.0 );\n\n\t\tcase Int16Array:\n\n\t\t\treturn Math.round( value * 32767.0 );\n\n\t\tcase Int8Array:\n\n\t\t\treturn Math.round( value * 127.0 );\n\n\t\tdefault:\n\n\t\t\tthrow new Error( 'Invalid component type.' );\n\n\t}\n\n}\n\nconst MathUtils = {\n\tDEG2RAD: DEG2RAD,\n\tRAD2DEG: RAD2DEG,\n\tgenerateUUID: generateUUID,\n\tclamp: clamp,\n\teuclideanModulo: euclideanModulo,\n\tmapLinear: mapLinear,\n\tinverseLerp: inverseLerp,\n\tlerp: lerp,\n\tdamp: damp,\n\tpingpong: pingpong,\n\tsmoothstep: smoothstep,\n\tsmootherstep: smootherstep,\n\trandInt: randInt,\n\trandFloat: randFloat,\n\trandFloatSpread: randFloatSpread,\n\tseededRandom: seededRandom,\n\tdegToRad: degToRad,\n\tradToDeg: radToDeg,\n\tisPowerOfTwo: isPowerOfTwo,\n\tceilPowerOfTwo: ceilPowerOfTwo,\n\tfloorPowerOfTwo: floorPowerOfTwo,\n\tsetQuaternionFromProperEuler: setQuaternionFromProperEuler,\n\tnormalize: normalize,\n\tdenormalize: denormalize\n};\n\nexport {\n\tDEG2RAD,\n\tRAD2DEG,\n\tgenerateUUID,\n\tclamp,\n\teuclideanModulo,\n\tmapLinear,\n\tinverseLerp,\n\tlerp,\n\tdamp,\n\tpingpong,\n\tsmoothstep,\n\tsmootherstep,\n\trandInt,\n\trandFloat,\n\trandFloatSpread,\n\tseededRandom,\n\tdegToRad,\n\tradToDeg,\n\tisPowerOfTwo,\n\tceilPowerOfTwo,\n\tfloorPowerOfTwo,\n\tsetQuaternionFromProperEuler,\n\tnormalize,\n\tdenormalize,\n\tMathUtils\n};\n","import { clamp } from \"three/src/math/MathUtils.js\";\nimport { get_screen_size, get_associated_position, NORTH } from './overlay_common';\nimport { Easing, FLAGS, THREE, Tween } from '../../common';\n\nexport const TITLE = \"title_\"\nconst TITLE_HEIGHT = 2.75;\nconst TITLE_Y = 9;\nconst TITLE_X = -4;\nconst TITLE_THICKNESS = .2\n\nexport class TitleBlock {\n    constructor(incoming_parent, incoming_camera) {\n        // Set variables\n        this.parent = incoming_parent;\n        this.camera = incoming_camera;\n        this.title_width = this.get_title_width();\n        this.title_height = TITLE_HEIGHT;\n        // Set shape and material\n        const title_geometry = new THREE.BoxGeometry(this.title_width, this.title_height, TITLE_THICKNESS);\n        const title_material = new THREE.MeshBasicMaterial({ \n            color: 0xffffff,\n            wireframe: true\n         });\n        this.title_box = new THREE.Mesh(title_geometry, title_material);\n        // Set name and position\n        this.title_box.name = `${TITLE}`;\n        this.title_box.position.y = TITLE_Y;\n        this.title_box.position.x = TITLE_X;\n        this.parent.add(this.title_box);\n    }\n\n    /** Calculates the titles width given the camera position and window size*/\n    get_title_width() {\n        return clamp(get_screen_size(this.camera).x * .5, 12, 18);\n    }\n\n    /** Hides/reveals the title block based off overlay status */\n    trigger_overlay(is_overlay_hidden, tween_map) {\n        const current_pos = this.title_box.position.clone();\n        const title_y = is_overlay_hidden ? get_associated_position(NORTH, this.camera) : TITLE_Y;\n        \n        if(FLAGS.TWEEN_LOGS) {\n            console.log(`Title Block - Starting overlay animation:\n                Hidden: ${is_overlay_hidden}\n                Current Position: (${current_pos.x.toFixed(2)}, ${current_pos.y.toFixed(2)}, ${current_pos.z.toFixed(2)})\n                Target Y: ${title_y.toFixed(2)}\n                Map Size: ${tween_map.size}`);\n        }\n        \n        if(!is_overlay_hidden && FLAGS.LAYER) {\n            this.title_box.layers.set(0);\n        }\n        \n        const new_tween = new Tween(this.title_box.position)\n            .to({ y: title_y })\n            .easing(Easing.Elastic.InOut)\n            .start()\n            .onComplete(() => {\n                const final_pos = this.title_box.position.clone();\n                if(FLAGS.TWEEN_LOGS) {\n                    console.log(`Title Block - Completed overlay animation:\n                        Hidden: ${is_overlay_hidden}\n                        Final Position: (${final_pos.x.toFixed(2)}, ${final_pos.y.toFixed(2)}, ${final_pos.z.toFixed(2)})`);\n                }\n                if(is_overlay_hidden && FLAGS.LAYER) {\n                    this.title_box.layers.set(1);\n                }\n                tween_map.delete(this.title_box.name);\n            });\n        tween_map.set(this.title_box.name, new_tween);\n    }\n\n    /** Resizes title box based off camera position and window size */\n    resize(){\n        // Move/resize title\n        this.title_box.geometry.dispose();\n        this.title_box.geometry = new THREE.BoxGeometry(this.get_title_width(this.camera), TITLE_HEIGHT, TITLE_THICKNESS);            \n    }\n\n    reposition() {\n        new Tween(this.title_box.position)\n        .to({ y: TITLE_Y})\n        .easing(Easing.Elastic.Out)\n        .start();\n    }\n\n    offscreen_reposition() {\n        this.title_box.position.y = get_associated_position(NORTH, this.camera)\n    }\n\n}\n","import { CSS2DObject } from \"three/examples/jsm/Addons.js\";\nimport { CATEGORIES } from \"./overlay_common/categories.js\";\n\nconst WIDTH_OFFSET = .5;\nconst HEIGHT_OFFSET = .5;\nconst PLACEHOLDER_PATH = '/pages/placeholder.html';\nexport const IFRAME = \"iframe_\";\nexport const DIV = \"div_\"\n\nexport class TextFrame {\n    camera;\n    parent;\n    frame_width;\n    pixel_width;\n    frame_height;\n    pixel_height;\n    div;\n    iframe;\n    css_div;\n    particles = [];\n    \n    constructor(incoming_parent, incoming_camera, incoming_width, incoming_height) {\n        this.parent = incoming_parent;\n        this.camera = incoming_camera;\n        this.div = document.createElement('div');\n        this.div.name = `${DIV}${incoming_parent.simple_name}`;\n        this.iframe = document.createElement('iframe');\n        this.iframe.name = `${IFRAME}${incoming_parent.simple_name}`;\n        // Look up the HTML path from CATEGORIES based on simple_name\n        const category = Object.values(CATEGORIES).find(cat => cat.value === incoming_parent.simple_name);\n        this.iframe.src = category ? category.html : PLACEHOLDER_PATH;\n        this.div.appendChild(this.iframe);\n        // Position and add to scene\n        this.css_div = new CSS2DObject(this.div);\n        this.css_div.simple_name = `${incoming_parent.simple_name}`;\n        this.css_div.name = `${IFRAME}${this.css_div.simple_name}`;\n        this.parent.add(this.css_div);\n        // Set initial size\n        this.update_size(incoming_width, incoming_height);\n    }\n\n    update_size(incoming_width, incoming_height) {\n        this.frame_width = incoming_width - WIDTH_OFFSET;\n        this.frame_height = incoming_height - HEIGHT_OFFSET;\n        // Convert world units to pixels using the same scale as Three.js\n        const fov = this.camera.fov * Math.PI / 180;\n        const height_at_distance = 2 * Math.tan(fov / 2) * 15;\n        const pixels_per_unit = window.innerHeight / height_at_distance;\n        // Apply conversions\n        this.pixel_width = Math.round(this.frame_width * pixels_per_unit);\n        this.pixel_height = Math.round(this.frame_height * pixels_per_unit);\n        // Apply to both div and iframe\n        this.div.style.width = `${this.pixel_width}px`;\n        this.div.style.height = `${this.pixel_height}px`;\n        this.iframe.style.width = `${this.pixel_width}px`;\n        this.iframe.style.height = `${this.pixel_height}px`;\n        this.iframe.style.border = '0px';\n    }\n}","import { clamp } from 'three/src/math/MathUtils.js';\nimport { TextFrame, IFRAME } from './text_frame';\nimport { get_screen_size, get_associated_position, NORTH, SOUTH, EAST, WEST, CATEGORIES, extract_type, PAN_SPEED, TYPES, VALID_DIRECTIONS } from './overlay_common';\nimport { Easing, FLAGS, NAMES, THREE, Tween, AssetManager, ASSET_TYPE, ASSET_CONFIGS } from '../../common';\n\nexport class TextContainer {\n    container_width;\n    container_height;\n    text_frames = new Map();\n    focused_text_name = \"\";\n    particles = [];\n    asset_manager;\n\n    constructor(incoming_parent, incoming_camera) {\n        this.parent = incoming_parent;\n        this.camera = incoming_camera;\n        this.text_box_container = new THREE.Object3D();\n        this.asset_manager = AssetManager.get_instance();\n        // Create text displays\n        this.parent.add(this.text_box_container);\n        // Creat background private method\n        const create_background = (incoming_category, incoming_box) => {\n            this.container_width = this.get_text_box_width();\n            this.container_height = this.get_text_box_height();\n            const box_geometry = new THREE.BoxGeometry(this.container_width, this.container_height, .01);\n            const box_material = new THREE.MeshBasicMaterial({ \n                color: incoming_category.color,\n                depthTest: false,\n                transparent: true\n            });\n            const text_box_background = new THREE.Mesh(box_geometry, box_material);\n            text_box_background.name = `${TYPES.BACKGROUND}${incoming_category.value}`;\n            text_box_background.renderOrder = -1;\n            incoming_box.add(text_box_background);\n        };\n        // Create frame private method\n        const create_text_frame = (incoming_category, incoming_box) => {\n            const new_frame = new TextFrame(incoming_box, this.camera, this.container_width, this.container_height);\n            new_frame.simple_name = incoming_category.value;\n            new_frame.name = `${TYPES.TEXT_BLOCK}${incoming_category.value}`;\n            this.text_frames.set(new_frame.name, new_frame);\n        };\n        Object.values(CATEGORIES).forEach((category, i) => {\n            if (typeof category === 'function') return; // Skip helper methods\n            const text_box = new THREE.Object3D();\n            text_box.position.x = get_associated_position(WEST, this.camera) * 2;\n            text_box.position.y = this.get_text_box_y();\n            text_box.simple_name = category.value;\n            text_box.name = `${TYPES.TEXT}${category.value}`;\n            if(FLAGS.LAYER){\n                text_box.layers.set(1);\n            }\n            this.text_box_container.add(text_box);\n            switch(category.value) {\n                case CATEGORIES.EDUCATION.value:\n                    const rotation = new THREE.Euler(-Math.PI/2, 0, Math.PI, 'XYZ');\n                    const position_one_offset = new THREE.Vector3(0, 3, 0);\n                    const position_two_offset = new THREE.Vector3(0, -3, 0);\n                    \n                    // Create diplomas with specific UI handling\n                    (async () => {\n                        // Load the diploma asset first\n                        const asset_config = ASSET_CONFIGS[ASSET_TYPE.DIPLOMA];\n                        const gltf = await this.asset_manager.loader.loadAsync(asset_config.PATH);\n                        \n                        // Create two instances\n                        [position_one_offset, position_two_offset].forEach(position => {\n                            const diploma = gltf.scene.clone();\n                            diploma.scale.set(asset_config.scale, asset_config.scale, asset_config.scale);\n                            diploma.position.copy(position);\n                            diploma.rotation.copy(rotation);\n                            \n                            // Handle materials\n                            diploma.traverse((child) => {\n                                if (child.isMesh) {\n                                    // Hide collision mesh\n                                    if (child.name.startsWith('col_')) {\n                                        child.visible = false;\n                                        return;\n                                    }\n\n                                    // Get the original material's properties\n                                    const originalMaterial = child.material;\n                                    if(FLAGS.ASSET_LOGS) console.log('Original material:', {\n                                        name: child.name,\n                                        map: originalMaterial.map?.image?.src,\n                                        color: originalMaterial.color.getHexString()\n                                    });\n\n                                    // Try using the original material but with basic properties\n                                    child.material = new THREE.MeshBasicMaterial();\n                                    child.material.copy(originalMaterial);\n                                    child.material.needsUpdate = true;\n                                    \n                                    // Force some UI-specific properties\n                                    child.material.transparent = true;\n                                    child.material.depthTest = false;\n                                    child.material.side = THREE.DoubleSide;\n                                    child.renderOrder = 999;\n\n                                    if(FLAGS.ASSET_LOGS) console.log('New material:', {\n                                        name: child.name,\n                                        map: child.material.map?.image?.src,\n                                        color: child.material.color.getHexString()\n                                    });\n                                }\n                            });\n                            \n                            text_box.add(diploma);\n                        });\n                    })();\n                    \n                    create_background(category, text_box);\n                    break;\n                case CATEGORIES.ABOUT.value:\n                    // About doesn't want any background asset or box\n                    create_text_frame(category, text_box);\n                    break;\n                default:\n                    create_background(category, text_box);\n                    create_text_frame(category, text_box);\n                    break;\n            }\n        });\n    }\n\n    /** Brings the text box associated with the given name into focus\n     ** container column MUST be on the right side\n    */\n    focus_text_box(incoming_name, is_column_left) {\n        if(!is_column_left) {\n            // Get text box name\n            const found_index = incoming_name.indexOf('_');\n            const new_name = TYPES.TEXT + incoming_name.substring(found_index + 1);\n            if(FLAGS.SELECT_LOGS) {\n                console.log('Focusing text box:', {\n                    incoming_name,\n                    new_name,\n                    category: incoming_name.substring(found_index + 1),\n                    available_frames: Array.from(this.text_frames.keys())\n                });\n            }\n\n            if(new_name != this.focused_text_name) {\n                // If existing focus text box move it\n                if(this.focused_text_name != \"\") {\n                    // Stop any running animations in the current frame before switching\n                    const currentCategory = this.focused_text_name.replace(TYPES.TEXT, '');\n                    const currentFrame = this.text_frames.get(`${TYPES.TEXT_BLOCK}${currentCategory}`);\n                    if (currentFrame && currentFrame.iframe.contentWindow) {\n                        // Only trigger visibility change for education page\n                        if (currentFrame.simple_name === CATEGORIES.EDUCATION.value) {\n                            const visibilityEvent = new Event('visibilitychange');\n                            Object.defineProperty(currentFrame.iframe.contentDocument, 'hidden', {\n                                value: true,\n                                writable: false\n                            });\n                            currentFrame.iframe.contentDocument.dispatchEvent(visibilityEvent);\n                        }\n                    }\n                    this.lose_focus_text_box(SOUTH);\n                }\n                this.focused_text_name = new_name;\n                \n                // Get the category and find corresponding frame\n                const category = incoming_name.substring(found_index + 1);\n                const frame = this.text_frames.get(`${TYPES.TEXT_BLOCK}${category}`);\n                \n                if(FLAGS.SELECT_LOGS) {\n                    console.log('Frame lookup:', {\n                        category,\n                        frameKey: `${TYPES.TEXT_BLOCK}${category}`,\n                        frameFound: !!frame,\n                        frameWindow: frame?.iframe?.contentWindow ? 'exists' : 'missing',\n                        hasAnimation: frame?.iframe?.contentWindow?.trigger_frame_animation ? 'yes' : 'no'\n                    });\n                }\n\n                // Trigger frame animation\n                if (frame && frame.iframe.contentWindow && \n                    typeof frame.iframe.contentWindow.trigger_frame_animation === 'function') {\n                    frame.iframe.contentWindow.trigger_frame_animation();\n                }\n            }\n            // Get and move text box\n            const selected_text_box = this.text_box_container.getObjectByName(this.focused_text_name);\n            if(FLAGS.LAYER){\n                this.set_content_layer(this.focused_text_name, 0);\n            }\n            new Tween(selected_text_box.position)\n            .to({ x: this.get_focused_text_x() }, 285)\n            .easing(Easing.Sinusoidal.Out)\n            .start()\n        } else {\n            this.lose_focus_text_box(WEST);\n        }\n    }\n\n    // Method to tween focused_text_name to offscreen and set to empty string\n    lose_focus_text_box(move_direction = \"\") {\n        if(this.focused_text_name != \"\") {\n            if(move_direction == \"\" || VALID_DIRECTIONS.includes(move_direction)) {\n                const existing_focus_box = this.text_box_container.getObjectByName(this.focused_text_name);\n                if(move_direction == \"\") {\n                    existing_focus_box.position.x = get_associated_position(WEST, this.camera);\n                } else {\n                    // Tween in given direction off screen\n                    const move_position = get_associated_position(move_direction, this.camera);\n                    const determined_speed = PAN_SPEED * .2;\n                    switch(move_direction) {\n                        case NORTH:\n                            new Tween(existing_focus_box.position)\n                            .to({ y: move_position }, determined_speed)\n                            .easing(Easing.Sinusoidal.Out)\n                            .start()\n                            .onComplete(() => {\n                                if(FLAGS.LAYER){\n                                    this.set_content_layer(existing_focus_box.name, 1);\n                                }\n                                existing_focus_box.position.y = this.get_text_box_y();\n                                existing_focus_box.position.x = get_associated_position(WEST, this.camera);\n                            });\n                            break;\n                        case SOUTH:\n                            new Tween(existing_focus_box.position)\n                            .to({ y: move_position }, determined_speed)\n                            .easing(Easing.Sinusoidal.Out)\n                            .start()\n                            .onComplete(() => {\n                                if(FLAGS.LAYER){\n                                    this.set_content_layer(existing_focus_box.name, 1);\n                                }\n                                existing_focus_box.position.y = this.get_text_box_y();\n                                existing_focus_box.position.x = 2 * get_associated_position(WEST, this.camera);\n                            });\n                            break;\n                        case EAST:\n                            new Tween(existing_focus_box.position)\n                            .to({ x: move_position }, determined_speed)\n                            .easing(Easing.Sinusoidal.Out)\n                            .start()\n                            .onComplete(() => {\n                                if(FLAGS.LAYER){\n                                    this.set_content_layer(existing_focus_box.name, 1);\n                                }\n                                existing_focus_box.position.x = (get_associated_position(WEST, this.camera))\n                            });\n                            break;\n                        case WEST:\n                            new Tween(existing_focus_box.position)\n                            .to({ x: move_position }, determined_speed)\n                            .easing(Easing.Sinusoidal.Out)\n                            .start().onComplete(() => {\n                                if(FLAGS.LAYER){\n                                    this.set_content_layer(existing_focus_box.name, 1);\n                                }\n                            });                        \n                            break;\n                    }\n                }\n                // Lose focus on box\n                this.focused_text_name = \"\";\n            }\n        }\n    }\n\n    resize() {\n        this.container_width = this.get_text_box_width(this.camera);\n        this.container_height = this.get_text_box_height(this.camera);\n        const new_text_geometry = new THREE.BoxGeometry(this.container_width, this.container_height, 0);\n        this.text_box_container.children.forEach(c => {\n            c.children.forEach(inner_c => {\n                if (!inner_c || !inner_c.name) return;\n                const type = extract_type(inner_c);\n                switch(type) {\n                    case TYPES.BACKGROUND:\n                        inner_c.geometry.dispose();\n                        inner_c.geometry = new_text_geometry;\n                        break;\n                    case IFRAME:\n                        if (inner_c.simple_name) {\n                            this.update_iframe_size(inner_c.simple_name, this.container_width, this.container_height);\n                        }\n                        break;\n                }\n            })\n        });\n    }\n\n    update_iframe_size(incoming_simple_name, incoming_width, incoming_height) {\n        const matched_frame = Array.from(this.text_frames.values()).find(frame => (frame.simple_name == incoming_simple_name));\n        if(matched_frame) {\n            matched_frame.update_size(incoming_width, incoming_height);\n        }\n    }\n\n    reposition(is_column_left) {\n        if(this.focused_text_name != \"\"){\n            this.focus_text_box(this.focused_text_name, is_column_left);\n        }\n        this.text_box_container.children.forEach(c => {\n            if(c.name != this.focused_text_name) {\n                c.position.x = get_associated_position(WEST, this.camera) * 2;\n                c.position.y = this.get_text_box_y(this.camera);\n            }\n        });\n    }\n\n    offscreen_reposition() {\n        this.text_box_container.children.forEach(c => {\n            c.position.x = -(this.container_width * 3);\n            c.position.y = this.get_text_box_y(this.camera);\n        })\n    }\n\n    set_content_layer(incoming_object_name, incoming_layer) {\n        const existing_object = this.text_box_container.getObjectByName(incoming_object_name);\n        existing_object.children.forEach(c => {\n            c.layers.set(incoming_layer);\n        });\n    }\n\n    // Text box getters\n    /** Calculates the selected text boxes x position based off camera position and window size */\n    get_focused_text_x() {\n        return -(get_screen_size(this.camera).x / 2 * .36)\n    }\n    \n    /** Calculates the text boxes y position based off camera position and window size */\n    get_text_box_y() {\n        return -(get_screen_size(this.camera).y * 0.05);\n    }\n    /** Calculates the text boxes height based off camera position and window size */\n    get_text_box_height() {\n        return get_screen_size(this.camera).y * .6;\n    }\n    \n    /** Calculates the text boxes width based off camera position and window size */\n    get_text_box_width() {\n        return clamp(get_screen_size(this.camera).x * .5, 12, 18);\n    }\n\n    /** Returns if there is an active text box or not */\n    is_text_box_active() {\n        return this.focused_text_name != \"\";\n    }\n\n    /** Returns active text box */\n    get_active_text_box() {\n        return this.text_box_container.getObjectByName(this.focused_text_name);\n    }\n\n    trigger_overlay(is_overlay_hidden, tween_map) {\n        const current_pos = this.text_box_container.position.clone();\n        const target_y = is_overlay_hidden ? get_associated_position(SOUTH, this.camera) : this.get_text_box_y();\n        \n        if(FLAGS.TWEEN_LOGS) {\n            console.log(`Text Container - Starting overlay animation:\n                Hidden: ${is_overlay_hidden}\n                Current Position: (${current_pos.x.toFixed(2)}, ${current_pos.y.toFixed(2)}, ${current_pos.z.toFixed(2)})\n                Target Y: ${target_y.toFixed(2)}\n                Map Size: ${tween_map.size}`);\n        }\n        \n        if(!is_overlay_hidden && FLAGS.LAYER) {\n            this.set_content_layer(0);\n        }\n        \n        const new_tween = new Tween(this.text_box_container.position)\n            .to({ y: target_y }, 680)\n            .easing(Easing.Elastic.InOut)\n            .start()\n            .onComplete(() => {\n                const final_pos = this.text_box_container.position.clone();\n                if(FLAGS.TWEEN_LOGS) {\n                    console.log(`Text Container - Completed overlay animation:\n                        Hidden: ${is_overlay_hidden}\n                        Final Position: (${final_pos.x.toFixed(2)}, ${final_pos.y.toFixed(2)}, ${final_pos.z.toFixed(2)})`);\n                }\n                this.current_tween = null;\n                if(is_overlay_hidden && FLAGS.LAYER) {\n                    this.set_content_layer(1);\n                }\n                tween_map.delete(this.text_box_container.name);\n            });\n        tween_map.set(this.text_box_container.name, new_tween); \n    }\n}","import { get_screen_size, get_associated_position, WEST } from \"./overlay_common/screen\";\nimport { CATEGORIES } from './overlay_common/categories';\nimport { TEXTURE_LOADER, TYPES, PAN_SPEED, ROTATE_SPEED, FOCUS_ROTATION } from './overlay_common/index'\nimport { Easing, FLAGS, THREE, Tween } from '../../common';\n\nexport class LabelContainer {\n    in_tween_map = new Map();\n    swapping_column_sides = false;\n    is_column_left = true;\n    current_intersected = null;\n\n    constructor(incoming_parent, incoming_camera) {\n        this.parent = incoming_parent;\n        this.camera = incoming_camera;\n        this.container_column = new THREE.Object3D();\n        this.container_column.name = `${TYPES.CONATINER}column`\n        this.parent.add(this.container_column);\n        // Create section labels\n        Object.values(CATEGORIES).forEach((category, i) => {\n            if (typeof category === 'function') return; // Skip helper methods\n            const button_container = new THREE.Object3D();\n            button_container.simple_name = category.value;\n            button_container.name = `${TYPES.CONATINER}${category.value}`\n            this.container_column.add(button_container);\n            const button_texture = TEXTURE_LOADER.load(category.icon);\n            button_texture.colorSpace = THREE.SRGBColorSpace;\n            const button_option = new THREE.Mesh(\n                // TODO Get demensions to constants\n                new THREE.BoxGeometry(5, 3, 0),\n                new THREE.MeshBasicMaterial({\n                    map: button_texture,\n                    transparent: true,\n                    depthTest: false\n                }));\n            button_option.simple_name = category.value;\n            button_option.name = `${TYPES.LABEL}${category.value}`\n            button_option.position.y = i * 3;\n            button_container.add(button_option);\n        });\n        this.container_column.position.x = this.get_column_x_position(true);\n        this.container_column.position.y = this.get_column_y_position(true);\n        this.container_column.rotation.y = this.get_column_y_rotation(true);\n    }\n\n    trigger_overlay(is_overlay_hidden, tween_map) {\n        if(!is_overlay_hidden && FLAGS.LAYER) {\n            this.set_content_layer(0);\n        }\n        const container_column_x = is_overlay_hidden ? get_associated_position(WEST, this.camera) : this.get_column_x_position(true);\n        const new_tween = new Tween(this.container_column.position)\n        .to({ x: container_column_x })\n        .easing(Easing.Elastic.InOut)\n        .start()\n        .onComplete(() => {\n            if(is_overlay_hidden && FLAGS.LAYER) {\n                this.set_content_layer(1);\n            }\n            tween_map.delete(this.container_column.name);\n        });\n        tween_map.set(this.container_column.name, new_tween);\n    }\n\n    swap_sides() {\n        this.is_column_left = !this.is_column_left;\n        const x_position = this.get_column_x_position(this.is_column_left);\n        const y_position = this.get_column_y_position(this.is_column_left);\n        const y_rotation = this.get_column_y_rotation(this.is_column_left);\n        // Move column across the screen\n        this.swapping_column_sides = true;\n        new Tween(this.container_column.position)\n        .to({ x: x_position, y: y_position}, PAN_SPEED)\n        .easing(Easing.Elastic.Out)\n        .start()\n        .onComplete(() => {\n            this.swapping_column_sides = false;\n        });\n        // Rotate the column as it moves\n        new Tween(this.container_column.rotation)\n        .to({ y: y_rotation}, ROTATE_SPEED)\n        .easing(Easing.Exponential.Out)\n        .start();\n    }\n\n    reposition() {\n        let x_position = this.get_column_x_position(this.is_column_left);\n        // Move button column across the screen\n        new Tween(this.container_column.position)\n        .to({ x: x_position})\n        .easing(Easing.Elastic.Out)\n        .start();\n    }\n\n    offscreen_reposition() {\n        this.container_column.position.x = get_associated_position(WEST, this.camera);        \n    }\n\n    handle_hover(intersected_object) {\n        if (!intersected_object || !intersected_object.rotation) {\n            if (FLAGS.ROTATION_TWEEN_LOGS) {\n                console.log('[RotationTween] Invalid hover object received');\n            }\n            return;\n        }\n\n        if (FLAGS.ROTATION_TWEEN_LOGS) {\n            console.log(`[RotationTween] Hover detected on object: ${intersected_object.name}`);\n            console.log(`[RotationTween] Current rotation: ${JSON.stringify(intersected_object.rotation)}`);\n            console.log(`[RotationTween] Swapping sides status: ${this.swapping_column_sides}`);\n        }\n\n        // Don't process hovers while swapping sides\n        if (this.swapping_column_sides) {\n            if (FLAGS.ROTATION_TWEEN_LOGS) {\n                console.log('[RotationTween] Ignoring hover while swapping sides');\n            }\n            return;\n        }\n\n        // Check if tween exists for this object already\n        const object_name = intersected_object.name;\n        let in_tween = this.in_tween_map.get(object_name);\n        if (FLAGS.ROTATION_TWEEN_LOGS) {\n            console.log(`[RotationTween] Existing tween for ${object_name}:`, in_tween ? 'yes' : 'no');\n            if (in_tween) {\n                console.log(`[RotationTween] Current tween progress:`, in_tween._elapsed / in_tween._duration);\n            }\n        }\n        \n        if(in_tween == null) {\n            if(this.current_intersected !== intersected_object) {\n                if (FLAGS.ROTATION_TWEEN_LOGS) {\n                    console.log(`[RotationTween] New intersection detected. Previous:`, this.current_intersected ? this.current_intersected.name : 'none');\n                }\n                \n                // Reset previously intersected object if one existed\n                this.reset_previous_intersected();\n                \n                // Set intersected object to current\n                this.current_intersected = intersected_object;\n                \n                // Apply rotation to current\n                let final_rotation = this.is_column_left ? -(FOCUS_ROTATION) : (FOCUS_ROTATION);\n                if (FLAGS.ROTATION_TWEEN_LOGS) {\n                    console.log(`[RotationTween] Starting rotation tween to ${final_rotation} (is_column_left: ${this.is_column_left})`);\n                }\n                \n                // Create rotation tween and set it in the map\n                in_tween = new Tween(this.current_intersected.rotation)\n                .to({ y: final_rotation}, 400)\n                .easing(Easing.Sinusoidal.In)\n                .start()\n                .onComplete(() => {\n                    if (FLAGS.ROTATION_TWEEN_LOGS) {\n                        console.log(`[RotationTween] Tween complete for ${object_name}. Final rotation:`, intersected_object.rotation.y);\n                    }\n                    // Ensure we're at exactly the final rotation\n                    intersected_object.rotation.y = final_rotation;\n                    this.in_tween_map.delete(object_name);\n                });\n                this.in_tween_map.set(object_name, in_tween);\n            }\n        }\n    }\n\n    /** Resets the previous intersected objects orientation */\n    reset_previous_intersected() {\n        if(this.current_intersected) {\n            if (FLAGS.ROTATION_TWEEN_LOGS) {\n                console.log(`[RotationTween] Resetting rotation for ${this.current_intersected.name}. Current rotation:`, this.current_intersected.rotation.y);\n            }\n            // Store reference to current object before nulling it\n            const object_to_reset = this.current_intersected;\n            \n            // Remove any existing tweens for this object\n            const existing_tween = this.in_tween_map.get(object_to_reset.name);\n            if (existing_tween) {\n                if (FLAGS.ROTATION_TWEEN_LOGS) {\n                    console.log(`[RotationTween] Stopping existing tween for ${object_to_reset.name} at progress:`, existing_tween._elapsed / existing_tween._duration);\n                }\n                existing_tween.stop();\n                this.in_tween_map.delete(object_to_reset.name);\n            }\n            \n            // Reset rotation\n            let deselected_rotation = 0;\n            const reset_tween = new Tween(object_to_reset.rotation)\n            .to({ y: deselected_rotation}, 400)\n            .easing(Easing.Elastic.Out)\n            .start()\n            .onComplete(() => {\n                if (FLAGS.ROTATION_TWEEN_LOGS) {\n                    console.log(`[RotationTween] Reset complete for ${object_to_reset.name}. Final rotation:`, object_to_reset.rotation.y);\n                }\n                // Ensure the rotation is exactly 0\n                object_to_reset.rotation.y = 0;\n            });\n            \n            // Clear the current intersected after creating tween\n            this.current_intersected = null;\n        }\n    }\n\n    // Column setters\n    set_content_layer(incoming_layer) {\n        this.container_column.layers.set(0);\n        Object.values(CATEGORIES).forEach(category => {\n            if (typeof category === 'function') return; // Skip helper methods\n            const label_name = `${TYPES.CONATINER}${category.value}`;\n            const button_name = `${TYPES.LABEL}${category.value}`;\n            const existing_label_container = this.container_column.getObjectByName(label_name);\n            const existing_label = existing_label_container.getObjectByName(button_name);\n            existing_label.layers.set(incoming_layer);\n        });\n    }\n\n    // Column getters\n    /** Calculates the x position of the container column given it and the cameras position along with window size */\n    get_column_x_position(is_column_left) {\n        return (is_column_left ? -1 : 1) * (get_screen_size(this.camera).x / 2) * 0.6;\n    }\n    \n    /** Calculates the y position of the container column given it and the cameras position along with window size */\n    get_column_y_position(is_column_left) {\n        return (is_column_left ? -1 : -.6) * (get_screen_size(this.camera).y / 2) * 0.6;\n    }\n    \n    /** Calculates the y rotation of the container column given its position along with window size */\n    get_column_y_rotation(is_column_left) {\n        return (is_column_left ? 1 : -1);\n    }\n}","import { clamp } from 'three/src/math/MathUtils.js';\nimport { get_screen_size, get_associated_position, SOUTH, TYPES, LINKS, TEXTURE_LOADER } from './overlay_common';\nimport { Easing, FLAGS, THREE, Tween } from '../../common';\n\nconst LINK_CONTAINER = {\n    DIMENSIONS: {\n        RADIUS: 0.44,\n        SPACING: 3.5 // Multiplier for horizontal spacing between links\n    },\n    POSITION: {\n        X_OFFSET: 7, // Distance from right edge\n        Y_SCALE: 0.45, // Percent based\n        Z: 0\n    }\n};\n\nexport class LinkContainer {\n    constructor(incoming_parent, incoming_camera) {\n        this.parent = incoming_parent;\n        this.camera = incoming_camera;\n        this.link_container = new THREE.Object3D();       \n        this.link_container.position.x = this.get_link_container_x();\n        this.link_container.position.y = this.get_link_container_y();\n        this.parent.add(this.link_container);\n        // Create the link icons\n        Object.values(LINKS).forEach((link, l) => {\n            const circle_geometry = new THREE.CircleGeometry(LINK_CONTAINER.DIMENSIONS.RADIUS);\n            const circle_texture = TEXTURE_LOADER.load(link.icon_path);\n            circle_texture.colorSpace = THREE.SRGBColorSpace;\n            const link_button = new THREE.Mesh(\n                circle_geometry,\n                new THREE.MeshBasicMaterial({\n                    map: circle_texture,\n                    transparent: true,\n                    depthTest: false\n                }));\n            link_button.name = `${TYPES.LINK}${link.value}`;\n            link_button.position.x += LINK_CONTAINER.DIMENSIONS.RADIUS * (LINK_CONTAINER.DIMENSIONS.SPACING * l);\n            this.link_container.add(link_button);\n        });\n    }\n\n    /** Open a new tab of the associated link */\n    open_link(new_link) {\n        const found_url = LINKS.get_link(new_link);\n        if(found_url) {\n            window.open(found_url, \"_blank\");\n        } else {\n            console.log(`Given label \\\"${new_link}\\\" does not have a stored path`);\n        }\n    }\n\n    trigger_overlay(is_overlay_hidden, tween_map) {\n        const current_pos = this.link_container.position.clone();\n        const target_y = is_overlay_hidden ? get_associated_position(SOUTH, this.camera) : this.get_link_container_y();\n        \n        if(FLAGS.TWEEN_LOGS) {\n            console.log(`Link Container - Starting overlay animation:\n                Hidden: ${is_overlay_hidden}\n                Current Position: (${current_pos.x.toFixed(2)}, ${current_pos.y.toFixed(2)}, ${current_pos.z.toFixed(2)})\n                Target Y: ${target_y.toFixed(2)}\n                Map Size: ${tween_map.size}`);\n        }\n        \n        if(!is_overlay_hidden && FLAGS.LAYER) {\n            this.set_content_layers(0);\n        }\n        \n        const new_tween = new Tween(this.link_container.position)\n            .to({ y: target_y }, 680)\n            .easing(Easing.Elastic.InOut)\n            .start()\n            .onComplete(() => {\n                const final_pos = this.link_container.position.clone();\n                if(FLAGS.TWEEN_LOGS) {\n                    console.log(`Link Container - Completed overlay animation:\n                        Hidden: ${is_overlay_hidden}\n                        Final Position: (${final_pos.x.toFixed(2)}, ${final_pos.y.toFixed(2)}, ${final_pos.z.toFixed(2)})`);\n                }\n                this.current_tween = null;\n                if(is_overlay_hidden && FLAGS.LAYER) {\n                    this.set_content_layers(1);\n                }\n                tween_map.delete(this.link_container.name);\n            });\n        tween_map.set(this.link_container.name, new_tween);\n    }\n\n    reposition() {\n        new Tween(this.link_container.position)\n        .to({ \n            x: this.get_link_container_x(),\n            y: this.get_link_container_y()\n        })\n        .easing(Easing.Elastic.Out)\n        .start();\n    }\n\n    offscreen_reposition() {\n        this.link_container.position.y = get_associated_position(SOUTH, this.camera)\n        this.link_container.position.x = this.get_link_container_x();      \n    }\n\n    // Link setters\n    set_content_layers(incoming_layer) {\n        this.link_container.layers.set(incoming_layer);\n        Object.values(LINKS).forEach(link => {\n            const link_name = `${TYPES.LINK}${link.value}`;\n            const existing_link = this.link_container.getObjectByName(link_name);\n            existing_link.layers.set(incoming_layer);\n        });\n    }\n\n    // Link getters\n    /** Calculates the link containers x position based off camera position and window size*/\n    get_link_container_x() {\n        return (get_screen_size(this.camera).x / 2) - LINK_CONTAINER.POSITION.X_OFFSET;\n    }\n    \n    /** Calculates the link containers y position based off camera position and window size*/\n    get_link_container_y() {\n        return -(LINK_CONTAINER.POSITION.Y_SCALE * get_screen_size(this.camera).y);\n    }\n    \n    /** Calculates the links radius based off camera position and window size*/\n    get_link_radius() {\n        return clamp(get_screen_size(this.camera).x * .02, Number.MIN_SAFE_INTEGER, LINK_CONTAINER.DIMENSIONS.RADIUS);\n    }\n}","import { get_screen_size, get_associated_position, EAST, TYPES, HIDE_HEIGHT, HIDE_WIDTH } from './overlay_common';\nimport { Easing, NAMES, THREE, Tween } from '../../common';\n\nexport class HideButton {\n    is_overlay_hidden = false;\n\n    constructor(incoming_parent, incoming_camera) {\n        this.parent = incoming_parent;\n        this.camera = incoming_camera;\n        const hide_button_width = HIDE_WIDTH;\n        const hide_button_height = HIDE_HEIGHT;\n        const hide_button_geometry = new THREE.BoxGeometry(hide_button_width, hide_button_height, 0);\n        const hide_button_material = this.get_hide_button_material();\n        this.hide_button = new THREE.Mesh(hide_button_geometry, hide_button_material);\n        this.hide_button.position.y = this.get_hide_button_y(this.camera);\n        this.hide_button.position.x = this.get_hide_button_x(true, this.camera);\n        this.hide_button.name = `${TYPES.HIDE}${NAMES.UNIQUE}`;\n        this.parent.add(this.hide_button);\n    }\n\n    // Hide button getters\n    /** Determines the material for the hide button based off scene state */\n    get_hide_button_material() {\n        return new THREE.MeshBasicMaterial({ \n            color: this.is_overlay_hidden ? 0x689f38 : 0x777981,\n            toneMapped: false\n        });\n    }\n    \n    /** Calculates hide button x position based off camera position and window size*/\n    get_hide_button_x(is_column_left) {\n        return is_column_left ? (get_screen_size(this.camera).x / 2) - 2.5 : get_associated_position(EAST, this.camera);\n    }\n    \n    /** Calculates hide button y position based off camera position and window size */\n    get_hide_button_y() {\n        return (get_screen_size(this.camera).y / 2) - 2.5;\n    }\n\n    /** Resets the internal material based off the buttons state */\n    update_material() {\n        if (this.hide_button.material) {\n            this.hide_button.material.dispose();\n        }\n        this.hide_button.material = this.get_hide_button_material();\n    }\n\n    swap_sides(is_column_left) {\n        if(is_column_left) {\n            this.hide_button.layers.set(0);\n        }\n        const hide_x = this.get_hide_button_x(is_column_left, this.camera);\n        new Tween(this.hide_button.position)\n        .to({ x: hide_x }, 250)\n        .easing(Easing.Sinusoidal.Out)\n        .start()\n        .onComplete(() => {\n            if(!is_column_left) {\n                this.hide_button.layers.set(1);\n            }\n        });\n    }\n\n    reposition(is_column_left) {\n        new Tween(this.hide_button.position)\n        .to({ \n            x: this.get_hide_button_x(is_column_left),\n            y: this.get_hide_button_y()\n        })\n        .easing(Easing.Elastic.Out)\n        .start();\n    }\n\n    offscreen_reposition() {\n        this.hide_button.position.y = this.get_hide_button_y();\n        this.hide_button.position.x = this.get_hide_button_x(false);\n    }\n\n    swap_hide_status() {\n        this.is_overlay_hidden = !this.is_overlay_hidden;\n        this.update_material();\n    }\n}","import { get_screen_size, get_associated_position, SOUTH } from './overlay_common';\nimport { Easing, FLAGS, THREE, Tween, TYPES } from '../../common';\nimport { clamp } from 'three/src/math/MathUtils.js';\n\nconst ARTIST_BLOCK = {\n    DIMENSIONS: {\n        MIN_WIDTH: 6,\n        MAX_WIDTH: 8,\n        WIDTH_SCALE: 0.2, // Percent based\n        HEIGHT: 1,\n        DEPTH: 0.2\n    },\n    POSITION: {\n        X_OFFSET: 1,\n        Y_SCALE: 0.45, // Percent based\n        Z: 0,\n        MIN_PADDING: 3\n    }\n};\n\nexport class ArtistBlock {\n    constructor(incoming_parent, incoming_camera) {\n        this.parent = incoming_parent;\n        this.camera = incoming_camera;\n        // Create wireframe box with calculated width\n        const artist_geometry = new THREE.BoxGeometry(\n            this.get_artist_width(),\n            ARTIST_BLOCK.DIMENSIONS.HEIGHT,\n            ARTIST_BLOCK.DIMENSIONS.DEPTH\n        );\n        const artist_material = new THREE.MeshBasicMaterial({ \n            color: 0xffffff,\n            wireframe: true\n        });\n        this.artist_box = new THREE.Mesh(artist_geometry, artist_material);\n        // Initial position calculation without padding\n        const screen_size = get_screen_size(this.camera);\n        const initial_width = this.get_artist_width();\n        this.artist_box.position.set(\n            -(screen_size.x / 2) + ARTIST_BLOCK.POSITION.X_OFFSET + (initial_width / 2),\n            -(ARTIST_BLOCK.POSITION.Y_SCALE * screen_size.y),\n            ARTIST_BLOCK.POSITION.Z\n        );\n        // Ensure it renders on top\n        this.artist_box.renderOrder = 999;\n        this.artist_box.material.depthTest = false;\n        this.parent.add(this.artist_box);\n        // Trigger reposition animation to move to proper padded position\n        this.reposition();\n    }\n\n    get_artist_width() {\n        return clamp(\n            get_screen_size(this.camera).x * ARTIST_BLOCK.DIMENSIONS.WIDTH_SCALE,\n            ARTIST_BLOCK.DIMENSIONS.MIN_WIDTH,\n            ARTIST_BLOCK.DIMENSIONS.MAX_WIDTH\n        );\n    }\n\n    resize() {\n        // Dispose of old geometry and create new one\n        this.artist_box.geometry.dispose();\n        this.artist_box.geometry = new THREE.BoxGeometry(\n            this.get_artist_width(),\n            ARTIST_BLOCK.DIMENSIONS.HEIGHT,\n            ARTIST_BLOCK.DIMENSIONS.DEPTH\n        );\n    }\n\n    trigger_overlay(is_overlay_hidden, tween_map) {\n        const target_y = is_overlay_hidden ? \n            get_associated_position(SOUTH, this.camera) : \n            -(ARTIST_BLOCK.POSITION.Y_SCALE * get_screen_size(this.camera).y);\n        \n        if(!is_overlay_hidden && FLAGS.LAYER) {\n            this.artist_box.layers.set(0);\n        }\n        \n        const new_tween = new Tween(this.artist_box.position)\n            .to({ y: target_y }, 680)  // Same duration as link container\n            .easing(Easing.Elastic.InOut)\n            .start()\n            .onComplete(() => {\n                if(is_overlay_hidden && FLAGS.LAYER) {\n                    this.artist_box.layers.set(1);\n                }\n                tween_map.delete(this.artist_box.name);\n            });\n        \n        tween_map.set(this.artist_box.name, new_tween);\n    }\n\n    reposition() {\n        const screen_size = get_screen_size(this.camera);\n        const current_width = this.get_artist_width();\n        \n        // Get link container's x position (it's positioned from right edge)\n        const link_x = (screen_size.x / 2) - 7;  // This matches LinkContainer's calculation\n        \n        // Calculate our x position from left edge, ensuring minimum padding from link container\n        const max_x = link_x - ARTIST_BLOCK.POSITION.MIN_PADDING - (current_width / 2);\n        const desired_x = Math.min(\n            max_x,\n            -(screen_size.x / 2) + ARTIST_BLOCK.POSITION.X_OFFSET + (current_width / 2)\n        );\n        \n        new Tween(this.artist_box.position)\n            .to({ \n                x: desired_x,\n                y: -(ARTIST_BLOCK.POSITION.Y_SCALE * screen_size.y)\n            })\n            .easing(Easing.Elastic.Out)\n            .start();\n    }\n\n    offscreen_reposition() {\n        const screen_size = get_screen_size(this.camera);\n        const current_width = this.get_artist_width();\n        this.artist_box.position.y = get_associated_position(SOUTH, this.camera);\n        this.artist_box.position.x = -(screen_size.x / 2) + ARTIST_BLOCK.POSITION.X_OFFSET + (current_width / 2);\n    }\n}","import { TitleBlock } from './title_block';\nimport { TextContainer } from './text_container';\nimport { LabelContainer } from './label_container';\nimport { LinkContainer } from './link_container';\nimport { HideButton } from './hide_button';\nimport { Easing, FLAGS, THREE, Tween } from '../../common';\nimport { ArtistBlock } from './artist_block';\nimport { CATEGORIES } from './overlay_common';\n\n// Confetti constants\nconst PARTICLE_COUNT = 200;\nconst COLORS = [0xff0000, 0x00ff00, 0x0000ff, 0xffff00, 0xff00ff, 0x00ffff];\nconst PARTICLE_SIZE = 0.05;\nconst GRAVITY = 0.004;\nconst DRAG = 0.995;\n\n// For a fountain effect:\nconst LEFT_BURST_ANGLE = -80;\nconst RIGHT_BURST_ANGLE = -100; \nconst SPREAD_ANGLE = 45;        // How much the particles can spread from the base angle\n\n// For a v-shaped burst:\n// const LEFT_BURST_ANGLE = -45;\n// const RIGHT_BURST_ANGLE = -135;\n\n// For a horizontal spray:\n// const LEFT_BURST_ANGLE = 0;\n// const RIGHT_BURST_ANGLE = 180; \n\nexport class OverlayContainer {\n    overlay_container;\n    title_block;\n    text_box_container;\n    label_container;\n    link_container;\n    hide_button;\n    hide_transition_map = new Map();\n    party_popped = false;\n    particles = [];\n    // Set this to true when hide is clicked the first time\n    primary_control_trigger = false;\n    // Set this to true when the first object is grabbed, camera is frist moved, or first object is pushed\n    secondary_control_trigger = false;\n    artist_block;\n    \n    constructor(incoming_parent, incoming_camera) {\n        this.parent = incoming_parent;\n        this.camera = incoming_camera;\n        // Overlay creation\n        this.overlay_container = new THREE.Object3D();\n        // Make sure all children also render last so they're on top\n        this.overlay_container.renderOrder = 999;\n        this.overlay_container.traverse((child) => {\n            child.renderOrder = 999;\n        });\n        this.title_block = new TitleBlock(this.overlay_container, this.camera);\n        this.text_box_container = new TextContainer(this.overlay_container, this.camera);\n        this.label_container = new LabelContainer(this.overlay_container, this.camera);\n        this.link_container = new LinkContainer(this.overlay_container, this.camera);\n        this.artist_block = new ArtistBlock(this.overlay_container, this.camera);\n        this.hide_button = new HideButton(this.overlay_container, this.camera);\n        this.overlay_container.position.z = this.camera.position.z - 15;\n        this.parent.add(this.overlay_container);\n    }\n\n    create_confetti_burst() {\n        if(FLAGS.PHYSICS_LOGS) {\n            const cam_pos = this.camera.position;\n            const overlay_pos = this.overlay_container.position;\n            console.log(`Camera Position: (${cam_pos.x.toFixed(2)}, ${cam_pos.y.toFixed(2)}, ${cam_pos.z.toFixed(2)})`);\n            console.log(`Overlay Position: (${overlay_pos.x.toFixed(2)}, ${overlay_pos.y.toFixed(2)}, ${overlay_pos.z.toFixed(2)})`);\n        }\n\n        // Calculate burst position in front of camera (similar to overlay positioning)\n        const forward = new THREE.Vector3(0, 0, -3);\n        forward.applyQuaternion(this.camera.quaternion);\n        const burst_position = this.camera.position.clone().add(forward);\n        \n        if(FLAGS.PHYSICS_LOGS) {\n            console.log(`Burst Position: (${burst_position.x.toFixed(2)}, ${burst_position.y.toFixed(2)}, ${burst_position.z.toFixed(2)})`);\n        }\n\n        // Convert angles to radians\n        const burst_angles = [\n            LEFT_BURST_ANGLE * Math.PI / 180,\n            RIGHT_BURST_ANGLE * Math.PI / 180\n        ];\n\n        // Create two fountain bursts\n        burst_angles.forEach((base_angle, index) => {\n            const xOffset = index === 0 ? -1 : 1;  // Offset the bursts slightly left and right\n            \n            for (let i = 0; i < PARTICLE_COUNT / 2; i++) {\n                const geometry = new THREE.PlaneGeometry(PARTICLE_SIZE, PARTICLE_SIZE);\n                const material = new THREE.MeshBasicMaterial({\n                    color: COLORS[Math.floor(Math.random() * COLORS.length)],\n                    side: THREE.DoubleSide,\n                    depthTest: false,\n                    transparent: true,\n                    opacity: 1\n                });\n\n                const particle = new THREE.Mesh(geometry, material);\n                \n                // Position particle with slight offset\n                const offset_position = burst_position.clone().add(\n                    new THREE.Vector3(\n                        (Math.random() - 0.5) * 0.2 - xOffset * 0.5,\n                        (Math.random() - 0.5) * 0.2,\n                        (Math.random() - 0.5) * 0.2\n                    )\n                );\n                particle.position.copy(offset_position);\n                this.parent.add(particle);\n                particle.renderOrder = 999;\n\n                // Calculate spread from base angle\n                const spread = (Math.random() - 0.5) * SPREAD_ANGLE * Math.PI / 180;\n                const angle = base_angle + spread;\n\n                // Create velocity relative to camera orientation\n                const direction = new THREE.Vector3();\n                const camera_right = new THREE.Vector3(1, 0, 0).applyQuaternion(this.camera.quaternion);\n                const camera_up = new THREE.Vector3(0, 1, 0).applyQuaternion(this.camera.quaternion);\n                \n                direction.addScaledVector(camera_right, Math.cos(angle));\n                direction.addScaledVector(camera_up, Math.sin(angle));\n                \n                const speed = 0.08 + Math.random() * 0.12;\n                const upward_force = 0.15 + Math.random() * 0.1;\n                \n                particle.velocity = new THREE.Vector3(\n                    direction.x * speed,\n                    direction.y * speed + upward_force,\n                    direction.z * speed\n                );\n\n                // Orient particle to face camera\n                particle.lookAt(this.camera.position);\n                particle.rotation.z = Math.random() * Math.PI * 2;\n                particle.rotationSpeed = (Math.random() - 0.5) * 0.2;\n\n                this.particles.push(particle);\n\n                new Tween(particle.material)\n                    .to({ opacity: 0 }, 2000)\n                    .easing(Easing.Quadratic.Out)\n                    .start()\n                    .onComplete(() => {\n                        this.parent.remove(particle);\n                        particle.geometry.dispose();\n                        particle.material.dispose();\n                        const index = this.particles.indexOf(particle);\n                        if (index > -1) {\n                            this.particles.splice(index, 1);\n                        }\n                    });\n            }\n        });\n    }\n\n    update_confetti() {\n        if (this.particles.length > 0 && FLAGS.PHYSICS_LOGS) {\n            // Only log first particle every 10 frames to reduce spam\n            if (Math.random() < 0.1) {\n                const particle = this.particles[0];\n                console.log(`First Particle - Position: (${particle.position.x.toFixed(2)}, ${particle.position.y.toFixed(2)}, ${particle.position.z.toFixed(2)}), Velocity: (${particle.velocity.x.toFixed(3)}, ${particle.velocity.y.toFixed(3)}, ${particle.velocity.z.toFixed(3)})`);\n            }\n        }\n        for (const particle of this.particles) {\n            // Convert velocity to local space for gravity\n            const local_velocity = particle.velocity.clone();\n            local_velocity.applyQuaternion(this.overlay_container.quaternion.clone().invert());\n            // Apply gravity in local space\n            local_velocity.y -= GRAVITY;\n            local_velocity.multiplyScalar(DRAG);\n            // Convert back to world space\n            particle.velocity.copy(local_velocity);\n            particle.velocity.applyQuaternion(this.overlay_container.quaternion);\n            particle.position.add(particle.velocity);\n            particle.rotation.z += particle.rotationSpeed;\n        }\n    }\n\n    trigger_overlay() {\n        if(FLAGS.TWEEN_LOGS) {\n            console.log(`OverlayContainer - Triggering overlay animation:\n                Current Map Size: ${this.hide_transition_map.size}\n                Current Position: (${this.overlay_container.position.x.toFixed(2)}, ${this.overlay_container.position.y.toFixed(2)}, ${this.overlay_container.position.z.toFixed(2)})`);\n        }\n        if(this.hide_transition_map.size == 0) {\n            this.hide_button.swap_hide_status();\n            if(FLAGS.TWEEN_LOGS) {\n                console.log(`OverlayContainer - Starting animations:\n                    Is overlay hidden: ${this.hide_button.is_overlay_hidden}\n                    Active tweens before: ${this.hide_transition_map.size}`);\n            }\n            // Move overlay objects\n            this.title_block.trigger_overlay(this.hide_button.is_overlay_hidden, this.hide_transition_map);\n            this.label_container.trigger_overlay(this.hide_button.is_overlay_hidden, this.hide_transition_map);\n            this.link_container.trigger_overlay(this.hide_button.is_overlay_hidden, this.hide_transition_map);\n            this.artist_block.trigger_overlay(this.hide_button.is_overlay_hidden, this.hide_transition_map);\n            // Set the control menu to appear in animate\n            if(this.primary_control_trigger && !this.secondary_control_trigger && this.hide_button.is_overlay_hidden) {\n                this.secondary_control_trigger = true;\n            }\n            this.primary_control_trigger = true;\n            if(FLAGS.TWEEN_LOGS) {\n                console.log(`OverlayContainer - Animations started:\n                    Active tweens after: ${this.hide_transition_map.size}`);\n            }\n        } else {\n            if(FLAGS.TWEEN_LOGS) {\n                console.log(`OverlayContainer - Animation skipped:\n                    Current active tweens: ${this.hide_transition_map.size}\n                    Active tween names: ${Array.from(this.hide_transition_map.keys()).join(', ')}`);\n            }\n        }\n    }\n\n    swap_column_sides() {\n        this.label_container.swap_sides();\n        this.hide_button.swap_sides(this.label_container.is_column_left);\n    }\n\n    /**\n     * Resize and repositions the overlay\n     * FOR USE WHEN ONSCREEN ONLY\n     */\n    resize_reposition() {\n        this.text_box_container.resize();\n        this.text_box_container.reposition(this.label_container.is_column_left);\n        this.label_container.reposition();\n        this.link_container.reposition();\n        this.title_block.resize();\n        this.title_block.reposition();\n        this.hide_button.reposition(this.label_container.is_column_left);\n        this.artist_block.resize();\n        this.artist_block.reposition();\n    }\n\n    /**\n     * Resize and repositions the overlay\n     * FOR USE WHEN OFFSCREEN ONLY\n     */\n    resize_reposition_offscreen() {\n        this.text_box_container.resize();\n        this.text_box_container.offscreen_reposition();\n        this.label_container.offscreen_reposition();\n        this.link_container.offscreen_reposition();\n        this.title_block.resize();\n        this.title_block.offscreen_reposition();\n        this.artist_block.resize();\n    }\n\n    handle_hover(intersected_object) {\n        this.label_container.handle_hover(intersected_object);\n    }\n\n    reset_hover() {\n        this.label_container.reset_previous_intersected();\n    }\n\n    focus_text_box(incoming_name) {\n        const simple_name = incoming_name.split('_')[1];\n        if(simple_name == CATEGORIES.EDUCATION.value && !this.party_popped) {\n            // Create a dummy object for the delay tween\n            const dummy = { value: 0 };\n            new Tween(dummy)\n                .to({ value: 1 }, 200) // Match the text box tween duration\n                .easing(Easing.Sinusoidal.Out)\n                .start()\n                .onComplete(() => {\n                    this.create_confetti_burst();\n                });\n            this.party_popped = true;\n        }\n        this.text_box_container.focus_text_box(simple_name, this.label_container.is_column_left);\n    }\n\n    lose_focus_text_box(incoming_direction) {\n        this.text_box_container.lose_focus_text_box(incoming_direction);\n    }\n\n    open_link(incoming_name) {\n        this.link_container.open_link(incoming_name);\n    }\n\n    // Overlay getters\n    is_label_container_left_side() {\n        return this.label_container.is_column_left;\n    }\n\n    is_intersected() {\n        return this.label_container.current_intersected;\n    }\n\n    intersected_name() {\n        return this.label_container.current_intersected.name;\n    }\n\n    is_swapping_sides() {\n        return this.label_container.swapping_column_sides;\n    }\n\n    is_text_active() {\n        return this.text_box_container.is_text_box_active();\n    }\n\n    get_active_box() {\n        if(this.is_text_active()) {\n            return this.text_box_container.get_active_text_box();\n        }\n    }\n}","import { FLAGS, THREE } from \"../common\";\n\nexport class CameraManager {\n    constructor(camera, distance = 15) {\n        this.camera = camera;\n        this.distance = distance;\n        this.target = new THREE.Vector3(0, 0, 0);\n        // Spherical coordinates (starting position)\n        this.phi = 0;    // vertical angle (degrees)\n        this.theta = 0;  // horizontal angle (degrees)\n        // Add constraints\n        this.min_phi = -60;  // minimum vertical angle\n        this.max_phi = 60;   // maximum vertical angle\n        this.min_dist = 5;\n        this.max_dist = 30;\n        // Add callback for position updates\n        this.on_update_callbacks = new Set();\n        // Add reference to overlay container\n        this.overlay_container = null;\n        // Update the camera\n        this.update_camera();\n    }\n\n    add_update_callback(callback) {\n        this.on_update_callbacks.add(callback);\n    }\n\n    remove_update_callback(callback) {\n        this.on_update_callbacks.delete(callback);\n    }\n\n    rotate(delta_x, delta_y) {\n        // Convert the input to degrees (assuming input is in screen pixels)\n        this.theta -= delta_x;\n        this.phi = Math.max(this.min_phi, Math.min(this.max_phi, this.phi + delta_y));\n        \n        this.update_camera();\n    }\n\n    // Add zoom capability\n    zoom(delta) {\n        this.distance = Math.max(\n            this.min_dist,\n            Math.min(this.max_dist, this.distance + delta)\n        );\n        this.update_camera();\n    }\n\n    set_overlay_container(container) {\n        this.overlay_container = container;\n    }\n\n    update_camera() {\n        // Convert spherical coordinates to Cartesian\n        const phi_rad = THREE.MathUtils.degToRad(this.phi);\n        const theta_rad = THREE.MathUtils.degToRad(this.theta);\n        \n        // Update camera position\n        this.camera.position.x = this.distance * Math.cos(phi_rad) * Math.sin(theta_rad);\n        this.camera.position.y = this.distance * Math.sin(phi_rad);\n        this.camera.position.z = this.distance * Math.cos(phi_rad) * Math.cos(theta_rad);\n        \n        if(FLAGS.PHYSICS_LOGS) {\n            console.log('Camera Update:');\n            console.log(`Position: (${this.camera.position.x.toFixed(2)}, ${this.camera.position.y.toFixed(2)}, ${this.camera.position.z.toFixed(2)})`);\n            console.log(`Angles: phi=${this.phi.toFixed(2)}°, theta=${this.theta.toFixed(2)}°`);\n        }\n        \n        // Set camera target and udpate\n        this.camera.lookAt(this.target);\n        this.camera.updateMatrix();\n        // Update overlay position\n        if (this.overlay_container) {\n            // Calculate the position in front of the camera\n            const forward = new THREE.Vector3(0, 0, -15);\n            forward.applyQuaternion(this.camera.quaternion);\n            // Position overlay at camera position + forward vector\n            this.overlay_container.overlay_container.position.copy(this.camera.position);\n            this.overlay_container.overlay_container.position.add(forward);\n            // Make overlay face the camera\n            this.overlay_container.overlay_container.lookAt(this.camera.position);\n        }\n        // Notify callbacks\n        this.on_update_callbacks.forEach(callback => callback());\n    }\n} ","import { OverlayContainer } from \"./overlay/overlay_container\";\nimport { extract_type, TYPES, WEST} from './overlay/overlay_common';\nimport { CameraManager } from './camera_manager';\nimport { THREE } from \"../common\";\nimport { FLAGS } from \"../common\";\n\nexport const UI_Z_DIST = 25;\n\nexport class ViewableContainer {\n    detect_rotation = false;\n    overlay_container;\n    leftMouseDown = false;\n    rightMouseDown = false;\n    camera_manager;\n\n    constructor(incoming_parent, incoming_world) {\n        this.viewable_container_container = new THREE.Object3D();\n        this.parent = incoming_parent;\n        this.world = incoming_world;\n        this.camera = new THREE.PerspectiveCamera(\n            // FOV\n            75,\n            // Aspect ratio\n            window.innerWidth/window.innerHeight,\n            // Near clipping\n            0.1,\n            // Far clipping\n            1000\n        );\n        \n        // Initialize camera manager\n        this.camera_manager = new CameraManager(this.camera, UI_Z_DIST);\n        \n        // Create overlay and connect it to camera manager\n        this.overlay_container = new OverlayContainer(this.viewable_container_container, this.get_camera());\n        this.camera_manager.set_overlay_container(this.overlay_container);\n        \n        // Add callback for camera updates\n        this.camera_manager.add_update_callback(() => {\n            if (this.overlay_container) {\n                this.overlay_container.resize_reposition_offscreen();\n            }\n        });\n        this.viewable_container_container.add(this.camera);\n        // this.viewable_container_container.rotation.x = -0.261799;\n        this.parent.add(this.viewable_container_container);\n        // Add mouse button event listeners\n    }\n\n    // ----- Functions\n\n    swap_sides() {\n        this.get_overlay().swap_column_sides();\n    }\n\n    reset_hover() {\n        this.get_overlay().reset_hover();\n    }\n\n    focus_text_box(incoming_name) {\n        this.get_overlay().focus_text_box(incoming_name);\n    }\n\n    open_link(incoming_url) {\n        this.get_overlay().open_link(incoming_url);\n    }\n\n    lose_focus_text_box(incoming_direction = null) {\n        this.get_overlay().lose_focus_text_box(incoming_direction);\n    }\n\n    reset_camera() {\n        this.get_camera().aspect = window.innerWidth / window.innerHeight;\n        this.get_camera().updateProjectionMatrix();\n    }\n\n    resize_reposition() {\n        if(this.is_overlay_hidden()){\n            this.get_overlay().resize_reposition_offscreen();\n        } else {\n            this.get_overlay().resize_reposition();\n        }\n    }\n\n    trigger_overlay() {\n        this.get_overlay().trigger_overlay();\n    }\n    \n    handle_mouse_up(found_intersections){\n        if(this.is_column_left_side()){\n            if(found_intersections.length > 0){\n                const intersected_object = found_intersections[0].object;\n                const object_name = intersected_object.name;\n                const name_type = extract_type(intersected_object);\n                switch(name_type) {\n                    case TYPES.LABEL:\n                        if(FLAGS.SELECT_LOGS) {\n                            console.log(object_name, \"clicked up\");\n                        }\n                        this.reset_hover();\n                        this.swap_sides();\n                        this.focus_text_box(object_name);\n                        break;\n                    case TYPES.HIDE:\n                        this.trigger_overlay();\n                        break;\n                    case TYPES.LINK:\n                        this.open_link(object_name.split(\"_\")[1].trim());\n                        break;\n                }\n            }\n        // Column is right\n        } else {\n            if(found_intersections.length > 0) {\n                const intersected_object = found_intersections[0].object;\n                const object_name = intersected_object.name;\n                const name_type = extract_type(intersected_object);\n                switch(name_type) {\n                    case TYPES.LABEL:\n                        if(FLAGS.SELECT_LOGS) {\n                            console.log(object_name, \"clicked up\");\n                        }\n                        this.focus_text_box(object_name);\n                        break;\n                    case TYPES.LINK:\n                        this.open_link(object_name.split(\"_\")[1].trim());\n                        break;\n                    default:\n                        this.swap_sides();\n                        this.lose_focus_text_box(WEST);\n                }\n            } else {\n                this.swap_sides();\n                this.lose_focus_text_box(WEST);\n            }\n        }\n    }\n\n    handle_mouse_down(found_intersections) {\n        if(found_intersections.length > 0) {\n            const intersected_object = found_intersections[0].object;\n            const object_name = intersected_object.name;\n            const name_type = extract_type(intersected_object);\n            switch(name_type) {\n                case TYPES.LABEL:\n                    if(FLAGS.SELECT_LOGS) {\n                        console.log(object_name, \"clicked down\");\n                    }\n                    break;\n            }\n        }\n    }\n\n    // ----- Getters\n\n    is_primary_triggered() {\n        return this.get_overlay().primary_control_trigger;\n    }\n\n    is_secondary_triggered() {\n        return this.get_overlay().secondary_control_trigger;\n    }\n\n    is_column_left_side() {\n        return this.get_overlay().is_label_container_left_side();\n    }\n\n    is_text_active() {\n        return this.overlay_container.is_text_active();\n    }\n\n    is_overlay_hidden() {\n        return this.get_overlay().hide_button.is_overlay_hidden;\n    }\n\n    get_hide_transition_map() {\n        return this.get_overlay().hide_transition_map;\n    }\n\n    get_camera() {\n        return this.camera;\n    }\n\n    get_camera_manager() {\n        return this.camera_manager;\n    }\n\n    get_overlay() {\n        return this.overlay_container;\n    }\n\n    get_active_name() {\n        return this.overlay_container.get_active_box().name;\n    }\n\n    get_viewable_container() {\n        return this.viewable_container_container;\n    }\n\n    get_intersected_name() {\n        return this.get_overlay().intersected_name();\n    }\n}","import { THREE } from \"../common\";\n\nexport const SPOTLIGHT_HEIGHT = 7;\nexport const SPOTLIGHT_COLOR = 0xfff9d8;\nexport const HEMISPHERE_SKY_COLOR = 0xffffff;\nexport const HEMISPHERE_GROUND_COLOR = 0x663c1f;\n\nexport class BackgroundLighting {\n\n    constructor(incoming_parent) {\n        this.parent = incoming_parent;\n        this.lighting_container = new THREE.Object3D();\n        this.parent.add(this.lighting_container);\n        // Spotlights\n        const spotlight_one = new THREE.SpotLight(SPOTLIGHT_COLOR, 150);\n        spotlight_one.position.set(2.5, SPOTLIGHT_HEIGHT, -5);\n        spotlight_one.angle = -Math.PI / 2;\n        spotlight_one.penumbra = 0.5;\n        spotlight_one.castShadow = true;\n        spotlight_one.shadow.blurSamples = 10;\n        spotlight_one.shadow.radius = 5;\n        this.lighting_container.add(spotlight_one);\n        const spotlight_two = spotlight_one.clone();\n        spotlight_two.position.set(-2.5, SPOTLIGHT_HEIGHT, -1);\n        this.lighting_container.add(spotlight_two);\n        // Hemisphere light\n        const hemisphere_light = new THREE.HemisphereLight(HEMISPHERE_SKY_COLOR, HEMISPHERE_GROUND_COLOR, 2);\n        hemisphere_light.position.z = 50;\n        hemisphere_light.position.y = 500;\n        this.lighting_container.add(hemisphere_light);\n    }\n}","import { FLAGS, RAPIER, THREE } from \"../../common\";\nimport { AssetManager } from \"../../common/asset_manager\";\n\nconst THROW_MULTIPLIER = 0.1; // Adjust this to control throw strength\nconst SHOVE_FORCE = 4; // Adjust this value to control the force of the shove\nconst ZOOM_AMOUNT = 2;  // Amount to move per scroll event\nlet current_mouse_pos = new THREE.Vector2();\nlet initial_grab_distance = 15; // Store initial distance when grabbed\nlet last_position = new THREE.Vector3();\nlet current_velocity = new THREE.Vector3();\nlet last_time = 0;\n\nexport function shove_object(incoming_object, incoming_source) {\n    // Get the body pair from AssetManager using the instance_id\n    const asset_manager = AssetManager.get_instance();\n    const body_pair = asset_manager.get_body_pair_by_mesh(incoming_object);\n    if (body_pair){\n        const [mesh, body] = body_pair;\n        // Calculate direction from camera to cube\n        const camera_position = new THREE.Vector3();\n        incoming_source.getWorldPosition(camera_position);\n        const cube_position = new THREE.Vector3();\n        incoming_object.getWorldPosition(cube_position);\n        const direction = new THREE.Vector3()\n            .subVectors(cube_position, camera_position)\n            .normalize();\n        // Apply the impulse force in the calculated direction\n        body.applyImpulse(\n            { x: direction.x * SHOVE_FORCE, y: direction.y * SHOVE_FORCE, z: direction.z * SHOVE_FORCE },\n            true\n        );\n    }\n}\n\n// Update this in the mousemove handler\nexport function update_mouse_position(e) {\n    current_mouse_pos.x = (e.clientX / window.innerWidth) * 2 - 1;\n    current_mouse_pos.y = -(e.clientY / window.innerHeight) * 2 + 1;\n}\n\nexport function translate_object(incoming_object, incoming_camera) {\n    const asset_manager = AssetManager.get_instance();\n    const body_pair = asset_manager.get_body_pair_by_mesh(incoming_object);\n    if (!body_pair) return;\n    const [_, body] = body_pair;\n    // Get ray from camera through mouse point\n    const ray_start = new THREE.Vector3();\n    const ray_end = new THREE.Vector3();\n    const ray_dir = new THREE.Vector3();\n    ray_start.setFromMatrixPosition(incoming_camera.matrixWorld);\n    ray_end.set(current_mouse_pos.x, current_mouse_pos.y, 1).unproject(incoming_camera);\n    ray_dir.subVectors(ray_end, ray_start).normalize();\n    // Use stored initial distance\n    const new_position = ray_start.clone().add(ray_dir.multiplyScalar(initial_grab_distance));\n    // Calculate velocity\n    const current_time = performance.now();\n    const delta_time = (current_time - last_time) / 1000; // Convert to seconds\n    current_velocity.subVectors(new_position, last_position).divideScalar(delta_time);\n    // Update tracking variables\n    last_position.copy(new_position);\n    last_time = current_time;\n    // Lock rotation when grabbed\n    const current_rot = body.rotation();\n    body.setTranslation(new_position);\n    body.setRotation(current_rot);\n}\n\nexport function zoom_object_in(incoming_object) {\n    const asset_manager = AssetManager.get_instance();\n    const body_pair = asset_manager.get_body_pair_by_mesh(incoming_object);\n    if (!body_pair) return;\n    // Adjust the grab distance\n    initial_grab_distance += ZOOM_AMOUNT;\n}\n\nexport function zoom_object_out(incoming_object) {\n    const asset_manager = AssetManager.get_instance();\n    const body_pair = asset_manager.get_body_pair_by_mesh(incoming_object);\n    if (!body_pair) return;\n    // Adjust the grab distance\n    initial_grab_distance -= ZOOM_AMOUNT;\n}\n\nexport function grab_object(incoming_object, incoming_camera) {\n    const asset_manager = AssetManager.get_instance();\n    if(FLAGS.ACTIVATE_LOGS) console.log(`Grabbing ${incoming_object.name}`);\n    const body_pair = asset_manager.get_body_pair_by_mesh(incoming_object);\n    if (!body_pair) return;\n    const [_, body] = body_pair;\n    // Store initial distance from camera when grabbed\n    const camera_pos = new THREE.Vector3();\n    incoming_camera.getWorldPosition(camera_pos);\n    const object_pos = new THREE.Vector3();\n    object_pos.copy(body.translation());\n    initial_grab_distance = camera_pos.distanceTo(object_pos);\n    // Reset velocity tracking\n    last_position.copy(object_pos);\n    last_time = performance.now();\n    current_velocity.set(0, 0, 0);\n    body.setBodyType(RAPIER.RigidBodyType.KinematicPositionBased);\n}\n\nexport function release_object(incoming_object) {\n    const asset_manager = AssetManager.get_instance();\n    const body_pair = asset_manager.get_body_pair_by_mesh(incoming_object);\n    if (!body_pair) return;\n    const [_, body] = body_pair;\n    // Change back to dynamic body\n    body.setBodyType(RAPIER.RigidBodyType.Dynamic);\n    // Apply velocity as impulse\n    body.applyImpulse(\n        { \n            x: current_velocity.x * THROW_MULTIPLIER, \n            y: current_velocity.y * THROW_MULTIPLIER, \n            z: current_velocity.z * THROW_MULTIPLIER \n        },\n        true\n    );\n}\n","import { TYPES } from '../../viewport/overlay/overlay_common';\nimport { FLAGS, NAMES, RAPIER, THREE } from '../../common';\n\nexport const IMAGE_PATH = 'images/MouseControlMenu.svg';\n\n// Combined configuration object for better organization\nexport const MENU_CONFIG = {\n    BEAM: {\n        DIMENSIONS: {\n            WIDTH: 10,\n            HEIGHT: 0.5,\n            DEPTH: 0.2\n        },\n        PHYSICS: {\n            MASS: 0,\n            RESTITUTION: 1.1\n        }\n    },\n    SIGN: {\n        DIMENSIONS: {\n            WIDTH: 10,\n            HEIGHT: 10,\n            DEPTH: 0.01\n        },\n        PHYSICS: {\n            LINEAR_DAMPING: 0.9,\n            ANGULAR_DAMPING: 0.9,\n            MASS: 5,\n            RESTITUTION: 0.2,\n            USE_CCD: true\n        }\n    },\n    SPACING: 1.5,\n    JOINT: {\n        SPREAD: 5,\n        LENGTH: 1,\n        LIMITS: {\n            MIN: -Math.PI / 6,  // -30 degrees in radians\n            MAX: Math.PI / 6    // +30 degrees in radians\n        }\n    },\n    POSITION: {\n        OFFSET: {\n            X: 0,\n            Y: 8,\n            Z: 400\n        },\n        Z_TARGET: 7\n    },\n    MOVEMENT: {\n        DEFAULT_SPEED: 80,\n        GRAVITY_DELAY: 266\n    }\n};\n\n// Joint anchor points - derived from configuration\nexport const JOINT_ANCHORS = {\n    BEAM: {\n        LEFT: { x: -MENU_CONFIG.JOINT.SPREAD, y: 0, z: 0 },\n        RIGHT: { x: MENU_CONFIG.JOINT.SPREAD, y: 0, z: 0 },\n        BOTTOM: { x: 0, y: -MENU_CONFIG.BEAM.DIMENSIONS.HEIGHT/2, z: 0 }\n    },\n    SIGN: {\n        LEFT: { x: -MENU_CONFIG.JOINT.SPREAD, y: MENU_CONFIG.SIGN.DIMENSIONS.HEIGHT/2, z: 0 },\n        RIGHT: { x: MENU_CONFIG.JOINT.SPREAD, y: MENU_CONFIG.SIGN.DIMENSIONS.HEIGHT/2, z: 0 },\n        BOTTOM: { x: 0, y: -MENU_CONFIG.SIGN.DIMENSIONS.HEIGHT/2, z: 0 },\n        TOP: { x: 0, y: MENU_CONFIG.SIGN.DIMENSIONS.HEIGHT/2, z: 0 }\n    }\n};\nexport const DEFAULT_SPEED = 250;\nexport const GRAVITY_DELAY = 266;\n\n// Physics configuration for the sign\nexport const SIGN_PHYSICS = {\n    LINEAR_DAMPING: .2,\n    ANGULAR_DAMPING: .9,\n    GRAVITY_SCALE: 2,\n    MASS: 10,\n    RESTITUTION: 1.1,\n    INITIAL_VELOCITY: {\n        LINEAR: { x: 0, y: 0, z: 0 },\n        ANGULAR: { x: 0, y: 0, z: 0 }\n    },\n    USE_CCD: true\n};\n\nexport class ControlMenu {\n    parent;\n    camera;\n    world;\n    // Top beam variables\n    top_beam_geometry;\n    top_beam_material;\n    top_beam_mesh;\n    top_beam_body;\n    top_beam_shape;\n    // Sign variables\n    sign_image;\n    sign_canvas;\n    sign_context;\n    sign_texture;\n    sign_material;\n    sign_geometry;\n    sign_mesh;\n    sign_body;\n    sign_shape;\n    // Assembly position\n    assembly_position;\n    sign_joint;\n    chains_broken = false;\n    reached_target = false;\n    last_log_time = 0;\n    log_interval = 500;\n\n    constructor(incoming_parent, incoming_camera, incoming_world, primary_container, incoming_speed = DEFAULT_SPEED) {\n        this.parent = incoming_parent;\n        this.camera = incoming_camera;\n        this.world = incoming_world;\n        // Calculate assembly position based on camera using MENU_CONFIG\n        this.assembly_position = {\n            x: this.camera.position.x + MENU_CONFIG.POSITION.OFFSET.X,\n            y: this.camera.position.y + MENU_CONFIG.POSITION.OFFSET.Y,\n            z: this.camera.position.z - MENU_CONFIG.POSITION.OFFSET.Z\n        };\n        // Top beam creation\n        this.top_beam_geometry = new THREE.BoxGeometry(\n            MENU_CONFIG.BEAM.DIMENSIONS.WIDTH, \n            MENU_CONFIG.BEAM.DIMENSIONS.HEIGHT, \n            MENU_CONFIG.BEAM.DIMENSIONS.DEPTH\n        );\n        this.top_beam_material = new THREE.MeshStandardMaterial({\n            color: 0xffffff,\n            transparent: true,\n            opacity: 0\n        });\n        this.top_beam_mesh = new THREE.Mesh(this.top_beam_geometry, this.top_beam_material);\n        this.parent.add(this.top_beam_mesh);\n        this.top_beam_body = this.world.createRigidBody(\n            RAPIER.RigidBodyDesc\n            .dynamic()\n            .setTranslation(\n                this.assembly_position.x,\n                this.assembly_position.y,\n                this.assembly_position.z\n            )\n            .setLinvel(0, 0, incoming_speed)\n            .setGravityScale(0)\n            .setCanSleep(false)\n        );\n        this.top_beam_shape = RAPIER.ColliderDesc.cuboid(\n            MENU_CONFIG.BEAM.DIMENSIONS.WIDTH/2, \n            MENU_CONFIG.BEAM.DIMENSIONS.HEIGHT/2, \n            MENU_CONFIG.BEAM.DIMENSIONS.DEPTH/2\n        )\n            .setMass(MENU_CONFIG.BEAM.PHYSICS.MASS)\n            .setRestitution(MENU_CONFIG.BEAM.PHYSICS.RESTITUTION);\n        this.world.createCollider(this.top_beam_shape, this.top_beam_body);\n        primary_container.dynamic_bodies.push([this.top_beam_mesh, this.top_beam_body]);\n        // Sign creation\n        this.sign_image = new Image();\n        this.sign_image.onload = () => {\n            // Create canvas and context\n            this.sign_canvas = document.createElement('canvas');\n            this.sign_canvas.width = this.sign_image.width;\n            this.sign_canvas.height = this.sign_image.height;\n            this.sign_context = this.sign_canvas.getContext('2d');\n            // Draw SVG to canvas\n            this.sign_context.drawImage(this.sign_image, 0, 0);\n            // Create texture from canvas\n            this.sign_texture = new THREE.CanvasTexture(this.sign_canvas);\n            // Create material with texture\n            this.sign_material = new THREE.MeshStandardMaterial({\n                map: this.sign_texture,\n                side: THREE.DoubleSide\n            });\n            // Create test object\n            this.sign_geometry = new THREE.BoxGeometry(\n                MENU_CONFIG.SIGN.DIMENSIONS.WIDTH, \n                MENU_CONFIG.SIGN.DIMENSIONS.HEIGHT, \n                MENU_CONFIG.SIGN.DIMENSIONS.DEPTH\n            );\n            this.sign_mesh = new THREE.Mesh(this.sign_geometry, this.sign_material);\n            this.sign_mesh.castShadow = true;\n            this.sign_mesh.name = `${TYPES.INTERACTABLE}${NAMES.PRIMARY}`;\n            this.parent.add(this.sign_mesh);\n            // Create test physics object with initial rotation\n            const initialRotation = new THREE.Quaternion().setFromAxisAngle(\n                new THREE.Vector3(1, 0, 0),\n                -Math.PI/2  // Start at 90 degrees down\n            );\n            \n            this.sign_body = this.world.createRigidBody(\n                RAPIER.RigidBodyDesc\n                .dynamic()\n                .setTranslation(\n                    this.assembly_position.x,\n                    this.top_beam_mesh.position.y - (MENU_CONFIG.SPACING + MENU_CONFIG.SIGN.DIMENSIONS.HEIGHT/2),\n                    this.top_beam_mesh.position.z\n                )\n                .setRotation(initialRotation)\n                .setAngvel({ x: 0, y: 0, z: 0 })  // Set initial angular velocity to 0\n                .setLinearDamping(MENU_CONFIG.SIGN.PHYSICS.LINEAR_DAMPING)\n                .setAngularDamping(2.0)  // Increased from 0.9\n                .setCcdEnabled(MENU_CONFIG.SIGN.PHYSICS.USE_CCD)\n                .setCanSleep(false)\n            );\n            this.sign_shape = RAPIER.ColliderDesc.cuboid(\n                MENU_CONFIG.SIGN.DIMENSIONS.WIDTH/2, \n                MENU_CONFIG.SIGN.DIMENSIONS.HEIGHT/2, \n                MENU_CONFIG.SIGN.DIMENSIONS.DEPTH/2\n            )\n                .setMass(MENU_CONFIG.SIGN.PHYSICS.MASS)\n                .setRestitution(MENU_CONFIG.SIGN.PHYSICS.RESTITUTION);\n            this.world.createCollider(this.sign_shape, this.sign_body);\n\n            // Create revolute joint\n            const sign_joint = RAPIER.JointData.revolute(\n                JOINT_ANCHORS.BEAM.BOTTOM,\n                {\n                    x: JOINT_ANCHORS.SIGN.TOP.x,\n                    y: JOINT_ANCHORS.SIGN.TOP.y + MENU_CONFIG.SPACING,\n                    z: JOINT_ANCHORS.SIGN.TOP.z\n                },\n                { x: 1, y: 0, z: 0 }\n            );\n\n            // Set limits for straight down\n            sign_joint.limits = [0, 0];\n            \n            // Create joint with correct method\n            this.sign_joint = this.world.createImpulseJoint(sign_joint, this.top_beam_body, this.sign_body);\n\n            // Configure the motor after joint creation\n            if (this.sign_joint) {\n                this.sign_joint.configureMotorPosition(0, 10000.0, 1000.0);\n            }\n\n            if(FLAGS.PHYSICS_LOGS) {\n                console.log(\"Joint created with motor configuration\");\n            }\n\n            primary_container.dynamic_bodies.push([this.sign_mesh, this.sign_body]);\n        };\n        this.sign_image.src = IMAGE_PATH;\n        this.reached_target = false;\n        this.last_log_time = 0;\n        this.log_interval = 5000;\n    }\n\n    break_chains() {\n        if(!this.chains_broken) {\n            this.sign_body.setGravityScale(1);\n            this.world.removeImpulseJoint(this.sign_joint);\n            this.sign_joint = null;\n            this.chains_broken = true;\n        }\n    }\n\n    // Add new update method\n    update() {\n        // Skip if sign_joint isn't created yet or has been removed\n        if (!this.sign_joint || this.chains_broken) return;\n\n        // Get current time\n        const currentTime = performance.now();\n        \n        // Log positions periodically\n        if (currentTime - this.last_log_time > this.log_interval) {\n            const beamPos = this.top_beam_mesh.position;\n            const beamVel = this.top_beam_body.linvel();\n            if(FLAGS.PHYSICS_LOGS) {\n                console.log('=== Position Update ===');\n                console.log(`Top Beam - Position: (${beamPos.x.toFixed(2)}, ${beamPos.y.toFixed(2)}, ${beamPos.z.toFixed(2)})`);\n                console.log(`Top Beam - Velocity: (${beamVel.x.toFixed(2)}, ${beamVel.y.toFixed(2)}, ${beamVel.z.toFixed(2)})`);\n                if (this.sign_mesh && this.sign_body) {\n                    const signPos = this.sign_mesh.position;\n                    const signVel = this.sign_body.linvel();\n                    const rotation = this.sign_body.rotation();\n                    // Convert quaternion to Euler angles (in radians)\n                    const euler = new THREE.Euler().setFromQuaternion(\n                        new THREE.Quaternion(rotation.x, rotation.y, rotation.z, rotation.w)\n                    );\n                    console.log(`Sign - Position: (${signPos.x.toFixed(2)}, ${signPos.y.toFixed(2)}, ${signPos.z.toFixed(2)})`);\n                    console.log(`Sign - Velocity: (${signVel.x.toFixed(2)}, ${signVel.y.toFixed(2)}, ${signVel.z.toFixed(2)})`);\n                    console.log(`Sign - Rotation (rad): x:${euler.x.toFixed(2)}, y:${euler.y.toFixed(2)}, z:${euler.z.toFixed(2)}`);\n                    console.log(`Sign - Rotation (deg): x:${(euler.x * 180/Math.PI).toFixed(2)}°, y:${(euler.y * 180/Math.PI).toFixed(2)}°, z:${(euler.z * 180/Math.PI).toFixed(2)}°`);\n                }\n            }\n            \n            this.last_log_time = currentTime;\n        }\n\n        // Check for stopping condition\n        if (!this.reached_target && this.top_beam_mesh.position.z >= MENU_CONFIG.POSITION.Z_TARGET) {\n            if(FLAGS.PHYSICS_LOGS) {\n                console.log('=== Attempting to Stop Beam ===');\n            }\n            this.reached_target = true;\n            \n            // Get current position before changing anything\n            const currentPos = this.top_beam_body.translation();\n            if(FLAGS.PHYSICS_LOGS) {\n                console.log(`Current Position before stop: (${currentPos.x.toFixed(2)}, ${currentPos.y.toFixed(2)}, ${currentPos.z.toFixed(2)})`);\n            }\n            \n            // First set velocity to 0\n            this.top_beam_body.setLinvel(0, 0, 0);\n            \n            // Moderate damping\n            this.sign_body.setAngularDamping(0.9);\n            \n            // Only configure joint if it exists and chains aren't broken\n            if (this.sign_joint && !this.chains_broken) {\n                // Start with strong motor to stop motion\n                this.sign_joint.configureMotorPosition(0, 1000.0, 200.0);\n                \n                // Rapidly reduce motor strength\n                setTimeout(() => {\n                    if (this.sign_joint && !this.chains_broken) {\n                        this.sign_joint.configureMotorPosition(0, 500.0, 100.0);\n                        setTimeout(() => {\n                            if (this.sign_joint && !this.chains_broken) {\n                                this.sign_joint.configureMotorPosition(0, 100.0, 20.0);\n                                setTimeout(() => {\n                                    if (this.sign_joint && !this.chains_broken) {\n                                        // Almost completely remove motor influence\n                                        this.sign_joint.configureMotorPosition(0, 10.0, 2.0);\n                                    }\n                                }, 100);\n                            }\n                        }, 100);\n                    }\n                }, 100);\n            }\n            \n            // Set gravity to something reasonable\n            setTimeout(() => {\n                this.sign_body.setGravityScale(1);\n            }, MENU_CONFIG.MOVEMENT.GRAVITY_DELAY);\n            \n            // Change the body type to fixed\n            this.top_beam_body.setBodyType(RAPIER.RigidBodyType.Fixed);\n            if(FLAGS.PHYSICS_LOGS) {\n                console.log('Changed body type to Fixed');\n                console.log(`Final Position: (${currentPos.x.toFixed(2)}, ${currentPos.y.toFixed(2)}, ${currentPos.z.toFixed(2)})`);\n            }\n        }\n    }\n}","import { TYPES } from '../../viewport/overlay/overlay_common';\nimport { FLAGS, NAMES, RAPIER, THREE } from '../../common';\nimport { AssetManager } from '../../common/asset_manager';\n\nexport class ScrollMenu {\n    parent;\n    camera;\n    world;\n    dynamic_bodies;\n    // Chain settings\n    CHAIN_CONFIG = {\n        POSITION: {\n            X: 0,\n            Y: 10,\n            Z: 0\n        },\n        SEGMENTS: {\n            COUNT: 6,\n            LENGTH: 0.5,\n            RADIUS: 0.1,\n            DAMPING: .2,\n            MASS: 0.05,\n            RESTITUTION: 0.1,\n            FRICTION: 0.8,\n            ANGULAR_DAMPING: 1.5,\n            GRAVITY_SCALE: 5.0\n        },\n        SIGN: {\n            LOCAL_OFFSET: {\n                X: 0,    \n                Y: 2,    \n                Z: 0\n            },\n            DIMENSIONS: {\n                WIDTH: 2,\n                HEIGHT: 2,\n                DEPTH: 0.01\n            },\n            DAMPING: 0.8,\n            MASS: 1,\n            RESTITUTION: 0.1,\n            FRICTION: 0.8,\n            ANGULAR_DAMPING: 0.8,\n            GRAVITY_SCALE: 1.5,\n            IMAGE_PATH: 'images/ScrollControlMenu.svg'\n        }\n    };\n    chain_joints = [];\n    chains_broken = false;\n    last_log_time = 0;\n    log_interval = 500;\n\n    constructor(incoming_parent, incoming_camera, incoming_world, incoming_container, spawn_position) {\n        this.parent = incoming_parent;\n        this.camera = incoming_camera;\n        this.world = incoming_world;\n        this.dynamic_bodies = incoming_container.dynamic_bodies;\n\n        // Use spawn position\n        this.CHAIN_CONFIG.POSITION.X = spawn_position.x;\n        this.CHAIN_CONFIG.POSITION.Y = spawn_position.y;\n        this.CHAIN_CONFIG.POSITION.Z = spawn_position.z;\n\n        // Calculate rotation based on camera position\n        const theta_rad = Math.atan2(\n            this.camera.position.x,\n            this.camera.position.z\n        );\n        const halfAngle = theta_rad / 2;\n        const rotation = {\n            x: 0,\n            y: Math.sin(halfAngle),\n            z: 0,\n            w: Math.cos(halfAngle)\n        };\n\n        // Create anchor with rotation\n        const anchor_body = this.world.createRigidBody(\n            RAPIER.RigidBodyDesc.fixed()\n            .setTranslation(\n                this.CHAIN_CONFIG.POSITION.X,\n                this.CHAIN_CONFIG.POSITION.Y,\n                this.CHAIN_CONFIG.POSITION.Z\n            )\n            .setRotation(rotation)  // Apply same rotation to anchor\n        );\n\n        // Create chain segments with same rotation\n        let previous_body = anchor_body;\n        for(let i = 0; i < this.CHAIN_CONFIG.SEGMENTS.COUNT; i++) {\n            const chain_body = this.world.createRigidBody(\n                RAPIER.RigidBodyDesc.dynamic()\n                .setTranslation(\n                    this.CHAIN_CONFIG.POSITION.X,\n                    this.CHAIN_CONFIG.POSITION.Y - (i + 1) * this.CHAIN_CONFIG.SEGMENTS.LENGTH,\n                    this.CHAIN_CONFIG.POSITION.Z\n                )\n                .setRotation(rotation)  // Apply same rotation to each chain segment\n                .setLinearDamping(this.CHAIN_CONFIG.SEGMENTS.DAMPING)\n                .setAngularDamping(this.CHAIN_CONFIG.SEGMENTS.ANGULAR_DAMPING)\n                .setAdditionalMass(this.CHAIN_CONFIG.SEGMENTS.MASS)\n                .setGravityScale(this.CHAIN_CONFIG.SEGMENTS.GRAVITY_SCALE)\n                .setCanSleep(false)\n            );\n            const collider = RAPIER.ColliderDesc.ball(this.CHAIN_CONFIG.SEGMENTS.RADIUS)\n                .setRestitution(this.CHAIN_CONFIG.SEGMENTS.RESTITUTION)\n                .setFriction(this.CHAIN_CONFIG.SEGMENTS.FRICTION);\n            this.world.createCollider(collider, chain_body);\n            this.dynamic_bodies.push([chain_body]);\n            let created_joint;\n            // Create spherical joint between segments\n            if (i > 0) {\n                const joint_desc = RAPIER.JointData.spherical(\n                    {x: 0, y: -this.CHAIN_CONFIG.SEGMENTS.LENGTH/2, z: 0},\n                    {x: 0, y: this.CHAIN_CONFIG.SEGMENTS.LENGTH/2, z: 0}\n                );\n                created_joint = this.world.createImpulseJoint(\n                    joint_desc,\n                    previous_body,\n                    chain_body,\n                    true\n                );\n            } else {\n                // Connect first segment to anchor\n                const joint_desc = RAPIER.JointData.spherical(\n                    {x: 0, y: 0, z: 0},\n                    {x: 0, y: this.CHAIN_CONFIG.SEGMENTS.LENGTH/2, z: 0}\n                );\n                created_joint = this.world.createImpulseJoint(\n                    joint_desc,\n                    anchor_body,\n                    chain_body,\n                    true\n                );\n            }\n            this.chain_joints.push(created_joint);\n            previous_body = chain_body;\n        }\n        // Create and load the sign\n        const sign_image = new Image();\n        sign_image.onload = () => {\n            const sign_canvas = document.createElement('canvas');\n            sign_canvas.width = sign_image.width;\n            sign_canvas.height = sign_image.height;\n            const signContext = sign_canvas.getContext('2d');\n            signContext.drawImage(sign_image, 0, 0);\n            \n            const sign_texture = new THREE.CanvasTexture(sign_canvas);\n            const sign_material = new THREE.MeshStandardMaterial({\n                map: sign_texture,\n                side: THREE.DoubleSide\n            });\n            \n            const sign_geometry = new THREE.BoxGeometry(\n                this.CHAIN_CONFIG.SIGN.DIMENSIONS.WIDTH,\n                this.CHAIN_CONFIG.SIGN.DIMENSIONS.HEIGHT,\n                this.CHAIN_CONFIG.SIGN.DIMENSIONS.DEPTH\n            );\n            const sign_mesh = new THREE.Mesh(sign_geometry, sign_material);\n            sign_mesh.castShadow = true;\n            sign_mesh.name = `${TYPES.INTERACTABLE}${NAMES.SECONDARY}`;\n            \n            // Rotate the sign 90 degrees around X axis\n            sign_mesh.rotation.x = Math.PI / 2;\n            \n            this.parent.add(sign_mesh);\n            \n            const sign_spawn_y = this.CHAIN_CONFIG.POSITION.Y - \n                (this.CHAIN_CONFIG.SEGMENTS.COUNT * this.CHAIN_CONFIG.SEGMENTS.LENGTH);\n            const theta_rad = Math.atan2(\n                this.camera.position.x,\n                this.camera.position.z\n            );\n            const halfAngle = theta_rad / 2;\n            const sign_body = this.world.createRigidBody(\n                RAPIER.RigidBodyDesc.dynamic()\n                .setTranslation(\n                    this.CHAIN_CONFIG.POSITION.X + this.CHAIN_CONFIG.SIGN.LOCAL_OFFSET.X,\n                    sign_spawn_y + this.CHAIN_CONFIG.SIGN.LOCAL_OFFSET.Y,\n                    this.CHAIN_CONFIG.POSITION.Z + this.CHAIN_CONFIG.SIGN.LOCAL_OFFSET.Z\n                )\n                .setRotation({\n                    x: 0,\n                    y: Math.sin(halfAngle),\n                    z: 0,\n                    w: Math.cos(halfAngle)\n                })\n                .setLinearDamping(this.CHAIN_CONFIG.SIGN.DAMPING)\n                .setAngularDamping(this.CHAIN_CONFIG.SIGN.ANGULAR_DAMPING)\n                .setAdditionalMass(this.CHAIN_CONFIG.SIGN.MASS)\n                .setGravityScale(this.CHAIN_CONFIG.SIGN.GRAVITY_SCALE)\n                .setCanSleep(false)\n            );\n            const sign_collider = RAPIER.ColliderDesc.cuboid(\n                this.CHAIN_CONFIG.SIGN.DIMENSIONS.WIDTH/2,\n                this.CHAIN_CONFIG.SIGN.DIMENSIONS.HEIGHT/2,\n                this.CHAIN_CONFIG.SIGN.DIMENSIONS.DEPTH/2\n            )\n                .setRestitution(this.CHAIN_CONFIG.SIGN.RESTITUTION)\n                .setFriction(this.CHAIN_CONFIG.SIGN.FRICTION);\n            this.world.createCollider(sign_collider, sign_body);\n            \n            // Connect sign to last chain segment\n            const finalJointDesc = RAPIER.JointData.spherical(\n                {x: 0, y: -this.CHAIN_CONFIG.SEGMENTS.LENGTH/2, z: 0},\n                {x: 0, y: this.CHAIN_CONFIG.SIGN.DIMENSIONS.HEIGHT/2, z: 0}\n            );\n            this.world.createImpulseJoint(\n                finalJointDesc,\n                previous_body,\n                sign_body,\n                true\n            );\n            const asset_loader = AssetManager.get_instance();\n            asset_loader.add_object(sign_mesh, sign_body);\n        };\n        sign_image.src = this.CHAIN_CONFIG.SIGN.IMAGE_PATH;\n        this.last_log_time = 0;\n        this.log_interval = 500;\n    }\n\n    break_chains() {\n        if (!this.chains_broken) {\n            // Remove all joints\n            this.chain_joints.forEach(joint => {\n                this.world.removeImpulseJoint(joint);\n            });\n            this.chain_joints = [];\n\n            // Find and update all chain segments and sign in dynamic_bodies\n            if (this.parent.children) {\n                // Handle chain segments\n                const chain_links = this.parent.children.filter(child => \n                    child.geometry instanceof THREE.CylinderGeometry\n                );\n                chain_links.forEach((link, index) => {\n                    // Find corresponding rigid body\n                    const bodyPair = this.dynamic_bodies.find(([mesh]) => mesh === link);\n                    if (bodyPair) {\n                        const [_, body] = bodyPair;\n                        body.setGravityScale(this.CHAIN_CONFIG.SEGMENTS.GRAVITY_SCALE);\n                    }\n                });\n\n                // Handle sign\n                const sign = this.parent.children.find(child => \n                    child.name === `${TYPES.INTERACTABLE}${NAMES.SECONDARY}`\n                );\n                if (sign) {\n                    const signBodyPair = this.dynamic_bodies.find(([mesh]) => mesh === sign);\n                    if (signBodyPair) {\n                        const [_, body] = signBodyPair;\n                        body.setGravityScale(this.CHAIN_CONFIG.SIGN.GRAVITY_SCALE);\n                    }\n                }\n            }\n\n            this.chains_broken = true;\n        }\n    }\n\n    update() {\n        const currentTime = performance.now();\n        \n        // Update sign rotation based on camera angles\n        if (this.parent.children) {\n            const sign = this.parent.children.find(child => \n                child.name === `${TYPES.INTERACTABLE}${NAMES.SECONDARY}`\n            );\n            if (sign) {\n                // Calculate rotation based on camera position\n                const direction = new THREE.Vector3();\n                direction.subVectors(this.camera.position, new THREE.Vector3(0, 0, 0));\n                direction.normalize();\n                \n                // Set sign rotation to face center\n                sign.position.normalize();\n                const rotationMatrix = new THREE.Matrix4();\n                rotationMatrix.lookAt(sign.position, new THREE.Vector3(0, 0, 0), new THREE.Vector3(0, 1, 0));\n                sign.quaternion.setFromRotationMatrix(rotationMatrix);\n                // Rotate 180 degrees to face outward instead of inward\n                sign.rotateY(Math.PI);\n            }\n        }\n        \n        // Log positions periodically\n        if (currentTime - this.last_log_time > this.log_interval) {\n            if(FLAGS.PHYSICS_LOGS) {\n                console.log('=== Position Update (Scroll Menu) ===');\n                // Log chain segment positions if they exist\n                if (this.parent.children) {\n                    const chainLinks = this.parent.children.filter(child => \n                        child.geometry instanceof THREE.CylinderGeometry\n                    );\n                    chainLinks.forEach((link, index) => {\n                        const linkPos = link.position;\n                        console.log(`Chain Link ${index} - Position: (${linkPos.x.toFixed(2)}, ${linkPos.y.toFixed(2)}, ${linkPos.z.toFixed(2)})`);\n                    });\n                }\n                // Log sign position if it exists\n                const sign = this.parent.children.find(child => \n                    child.name === `${TYPES.INTERACTABLE}${NAMES.SECONDARY}`\n                );\n                if (sign) {\n                    const signPos = sign.position;\n                    console.log(`Sign - Position: (${signPos.x.toFixed(2)}, ${signPos.y.toFixed(2)}, ${signPos.z.toFixed(2)})`);\n                }\n            }\n            this.last_log_time = currentTime;\n        }\n    }\n}","import { FLAGS, THREE, AssetManager, ASSET_TYPE, NAMES } from \"../common\";\nimport { ControlMenu } from \"./menus/control_menu\";\nimport { ScrollMenu } from \"./menus/scroll_menu\";\nimport { CATEGORIES, TYPES } from \"../viewport/overlay/overlay_common\";\n\nexport class BackgroundContainer {\n    name = \"[BackgroundContainer]\"\n    parent;\n    camera;\n    world;\n    object_container;\n    primary_instruction_sign = null;\n    secondary_instruction_sign = null;\n    dynamic_bodies = [];\n\n    constructor(incoming_parent, incoming_camera, incoming_world) {\n        this.parent = incoming_parent;\n        this.camera = incoming_camera;\n        this.world = incoming_world;\n        this.object_container = new THREE.Object3D();\n        this.parent.add(this.object_container);\n        const asset_loader = AssetManager.get_instance();\n        // Spawn assets\n        (async () => {\n            let [mesh, body] = await asset_loader.spawn_asset(ASSET_TYPE.DESKPHOTO, this.object_container, this.world, {},new THREE.Vector3(-5, 5, 5));\n            mesh.name = `${TYPES.INTERACTABLE}${ASSET_TYPE.DESKPHOTO}`;\n            if (FLAGS.ASSET_LOGS) console.log(`${this.name} Creating Desk photo with name: ${mesh.name}`);\n            [mesh, body] = await asset_loader.spawn_asset(ASSET_TYPE.TABLET, this.object_container, this.world, {}, new THREE.Vector3(-10, 5, 5));\n            mesh.name = `${TYPES.INTERACTABLE}${ASSET_TYPE.TABLET}`;\n            if (FLAGS.ASSET_LOGS) console.log(`${this.name} Creating Tablet with name: ${mesh.name}`);\n            [mesh, body] = await asset_loader.spawn_asset(ASSET_TYPE.DIPLOMA, this.object_container, this.world, {}, new THREE.Vector3(-10, 5, 0));\n            mesh.name = `${TYPES.INTERACTABLE}${ASSET_TYPE.DIPLOMA}`;\n            if (FLAGS.ASSET_LOGS) console.log(`${this.name} Creating Diploma with name: ${mesh.name}`);\n            [mesh, body] = await asset_loader.spawn_asset(ASSET_TYPE.DESK, this.object_container, this.world, {}, new THREE.Vector3(-5, 5, 0));\n            mesh.name = `${TYPES.INTERACTABLE}${ASSET_TYPE.DESK}`;\n            if (FLAGS.ASSET_LOGS) console.log(`${this.name} Creating Desk with name: ${mesh.name}`);\n            // Spawn a chair\n            [mesh, body] = await asset_loader.spawn_asset(ASSET_TYPE.CHAIR, this.object_container, this.world, {}, new THREE.Vector3(-0, 5, 0));\n            mesh.name = `${TYPES.INTERACTABLE}${ASSET_TYPE.CHAIR}`;\n            if (FLAGS.ASSET_LOGS) console.log(`${this.name} Creating Chair with name: ${mesh.name}`);\n            // Spawn a room\n            [mesh, body] = await asset_loader.spawn_asset(ASSET_TYPE.ROOM, this.object_container, this.world, {}, new THREE.Vector3(5, 5, 0));\n            mesh.name = `${TYPES.INTERACTABLE}${ASSET_TYPE.ROOM}`;\n            if (FLAGS.ASSET_LOGS) console.log(`${this.name} Creating Room with name: ${mesh.name}`);\n            // Spawn a book\n            [mesh, body] = await asset_loader.spawn_asset(ASSET_TYPE.BOOK, this.object_container, this.world, {}, new THREE.Vector3(10, 5, 0));\n            mesh.name = `${TYPES.INTERACTABLE}${ASSET_TYPE.BOOK}`;\n            if (FLAGS.ASSET_LOGS) console.log(`${this.name} Creating Book with name: ${mesh.name}`);\n        })();\n        // Create all cubes asynchronously but wait for all to complete\n        const asset_manager = AssetManager.get_instance();\n        const cube_promises = Object.values(CATEGORIES).map(async (category, i) => {\n            if (typeof category === 'function' || category == CATEGORIES.EDUCATION) return; // Skip helper methods\n            const position = new THREE.Vector3(((i * 2) - 3), -2, -5);\n            const [mesh, body] = await asset_manager.spawn_asset(\n                ASSET_TYPE.CUBE,\n                this.object_container,\n                this.world,\n                { color: category.color },\n                position\n            );\n            mesh.name = `${TYPES.INTERACTABLE}${category.value}`;\n            if (FLAGS.ASSET_LOGS) console.log(`${this.name} Creating cube with name: ${mesh.name}`);\n        });\n        // Wait for all cubes to be created\n        Promise.all(cube_promises).then(() => {\n            if (FLAGS.PHYSICS_LOGS) console.log('All cubes initialized');\n        });\n    }\n\n    update(grabbed_object, viewable_container) {\n        // Logic triggering spawning\n        let trigger_secondary = false;\n        if((grabbed_object != null  || viewable_container.is_secondary_triggered()) && !trigger_secondary) {\n            trigger_secondary = true;\n        }\n        // Deal with primary instructions\n        if(viewable_container.is_primary_triggered() && !this.is_primary_spawned()) {\n            this.spawn_primary_instructions().catch(err => {\n                console.error(\"Error spawning primary instructions:\", err);\n            });\n        } else if(!viewable_container.is_overlay_hidden() && this.is_primary_instructions_intact()) {\n            this.break_primary_chains();\n        // Deal with secondary instructions\n        } else if(trigger_secondary && !this.is_secondary_spawned()) {\n            this.break_primary_chains();\n            this.spawn_secondary_instructions();\n        } else if(this.is_secondary_spawned() && !viewable_container.is_overlay_hidden()) {\n            this.break_secondary_chains();\n        }\n        // Handle logic for what already exists\n        if(this.primary_instruction_sign) {\n            this.primary_instruction_sign.update();\n        }\n        if(this.secondary_instruction_sign) {\n            this.secondary_instruction_sign.update();\n        }\n        this.dynamic_bodies.forEach(([mesh, body]) => {\n            if(body != null) {\n                const position = body.translation();\n                mesh.position.set(position.x, position.y, position.z);\n                const rotation = body.rotation();\n                mesh.quaternion.set(rotation.x, rotation.y, rotation.z, rotation.w);\n            }\n        });\n    }\n\n    contains_object(incoming_name) {\n        this.getNodeChildren().forEach(child => {\n            if(child.name == incoming_name) return true;\n        })\n    }\n\n    async spawn_primary_instructions() {\n        // Wrap the menu creation in an async IIFE to prevent blocking\n        (async () => {\n            this.primary_instruction_sign = new ControlMenu(this.object_container, this.camera, this.world, this);\n            \n            // Wait for the sign to be fully initialized\n            await new Promise(resolve => {\n                const checkSignReady = () => {\n                    if (this.primary_instruction_sign.sign_mesh && this.primary_instruction_sign.sign_body) {\n                        resolve();\n                    } else {\n                        setTimeout(checkSignReady, 100);\n                    }\n                };\n                checkSignReady();\n            });\n            const asset_loader = AssetManager.get_instance();\n            // Now we know the sign_mesh and sign_body exist\n            this.primary_instruction_sign.sign_mesh.name = `${TYPES.INTERACTABLE}primary`;\n            this.primary_instruction_sign.sign_mesh.traverse((child) => {\n                if (child.isMesh) {\n                    child.name = `${TYPES.INTERACTABLE}primary`;\n                }\n            });\n            asset_loader.add_object(this.primary_instruction_sign.sign_mesh, this.primary_instruction_sign.sign_body);\n            if (FLAGS.PHYSICS_LOGS) {\n                console.log(\"Primary sign added to asset manager:\", {\n                    meshName: this.primary_instruction_sign.sign_mesh.name,\n                    hasBody: !!this.primary_instruction_sign.sign_body,\n                    bodyType: this.primary_instruction_sign.sign_body.bodyType()\n                });\n            }\n        })().catch(err => {\n            console.error(\"Error spawning primary instructions:\", err);\n        });\n    }\n\n    async spawn_secondary_instructions() {\n        if(FLAGS.PHYSICS_LOGS) {\n            console.log('Spawning Scroll Menu:');\n            console.log(`Camera Position: (${this.camera.position.x.toFixed(2)}, ${this.camera.position.y.toFixed(2)}, ${this.camera.position.z.toFixed(2)})`);\n        }\n        // Calculate spawn position in front of camera\n        const forward = new THREE.Vector3(0, 0, -5);  // 5 units in front\n        forward.applyQuaternion(this.camera.quaternion);\n        const spawn_position = {\n            x: this.camera.position.x + forward.x,\n            y: this.camera.position.y + forward.y + 4, // Additional Y offset\n            z: this.camera.position.z + forward.z\n        };\n        \n        // Wrap the menu creation in an async IIFE to prevent blocking\n        (async () => {\n            this.secondary_instruction_sign = new ScrollMenu(\n                this.object_container, \n                this.camera, \n                this.world, \n                this,\n                spawn_position\n            );\n\n            // Wait for the sign to be fully initialized\n            await new Promise(resolve => {\n                const checkSignReady = () => {\n                    if (this.secondary_instruction_sign.sign_mesh && this.secondary_instruction_sign.sign_body) {\n                        resolve();\n                    } else {\n                        setTimeout(checkSignReady, 100);\n                    }\n                };\n                checkSignReady();\n            });\n\n            const asset_loader = AssetManager.get_instance();\n            \n            // Now we know the sign_mesh and sign_body exist\n            this.secondary_instruction_sign.sign_mesh.name = `${TYPES.INTERACTABLE}secondary`;\n            this.secondary_instruction_sign.sign_mesh.traverse((child) => {\n                if (child.isMesh) {\n                    child.name = `${TYPES.INTERACTABLE}secondary`;\n                }\n            });\n            \n            asset_loader.add_object(this.secondary_instruction_sign.sign_mesh, this.secondary_instruction_sign.sign_body);\n            \n            if (FLAGS.PHYSICS_LOGS) {\n                console.log(\"Secondary sign added to asset manager:\", {\n                    meshName: this.secondary_instruction_sign.sign_mesh.name,\n                    hasBody: !!this.secondary_instruction_sign.sign_body,\n                    bodyType: this.secondary_instruction_sign.sign_body.bodyType()\n                });\n            }\n        })().catch(err => {\n            console.error(\"Error spawning secondary instructions:\", err);\n        });\n    }\n\n    break_primary_chains() {\n        if(this.is_primary_spawned) {\n            if(!this.primary_instruction_sign.chains_broken) {\n                this.primary_instruction_sign.break_chains();\n            } else {\n                console.log(\"Primary instruction chains are already broken\");\n            }\n        } else {\n            console.warn(\"Primary instruction chains cannot be broken as it has not spawned...\");\n        }\n    }\n\n    break_secondary_chains() {\n        if(this.is_secondary_spawned) {\n            if(!this.secondary_instruction_sign.chains_broken) {\n                this.secondary_instruction_sign.break_chains();\n            }\n        } else {\n            console.warn(\"Secondary instruction chains cannot be broken as it has not spawned...\");\n        }\n    }\n\n    // ----- Getters\n\n    is_primary_spawned() {\n        return this.primary_instruction_sign != null;\n    }\n\n    is_primary_chains_broken() {\n        if(!this.is_primary_spawned()) {\n            console.warn(\"Primary instruction chains don't exist yet to be broken; Returning false\");\n            return false;\n        } else {\n            return this.primary_instruction_sign.chains_broken;\n        }\n    }\n\n    is_primary_instructions_intact() {\n        if(this.is_primary_spawned()) {\n            return !this.is_primary_chains_broken();\n        }\n        return false;\n\n    }\n    \n    is_secondary_spawned() {\n        return this.secondary_instruction_sign != null;\n    }\n\n    is_secondary_chains_broken() {\n        if(!this.is_secondary_spawned) {\n            console.warn(\"Secondary instruction chains don't exist yet to be broken; Returning false\");\n            return false;\n        }\n        return this.secondary_instruction_sign.chains_broken;\n    }\n\n    is_secondary_instructions_intact() {\n        if(this.is_secondary_spawned) {\n            return !this.is_secondary_chains_broken();\n        }\n        return false;\n    }\n}","import { update as updateTween } from 'three/examples/jsm/libs/tween.module.js';\nimport { BackgroundFloor } from './background/background_floor';\nimport { ViewableContainer } from './viewport/viewable_container';\nimport { BackgroundLighting } from './background/background_lighting';\nimport { extract_type, get_intersect_list, TEXTURE_LOADER, TYPES } from './viewport/overlay/overlay_common';\nimport { AppRenderer } from './common/app_renderer';\nimport { shove_object, translate_object, update_mouse_position, zoom_object_in, zoom_object_out, grab_object, release_object } from './background/background_common';\nimport { FLAGS, RAPIER, THREE, AssetManager } from './common';\nimport { BackgroundContainer } from './background/background_container';\n\n// ----- Constants\nconst BACKGROUND_IMAGE = 'images/gradient.jpg';\n\n// ----- Variables\nlet resize_move = false;\nlet zoom_event = false;\nlet last_pixel_ratio = window.devicePixelRatio;\nlet scene;\nlet gravity;\nlet world;\nlet clock;\nlet viewable_container;\nlet app_renderer;\nlet background_container;\nlet resizeTimeout;\nlet hovered_cube_name = \"\";\nlet grabbed_object = null;\nlet left_mouse_down = false;\nlet right_mouse_down = false;\nlet construction_acknowledged = false;\nlet asset_manager;\n\n/** Initializes the main scene */\nasync function init() {\n    // Initialize RAPIER first\n    await RAPIER.init();\n    \n    asset_manager = AssetManager.get_instance();\n    if(FLAGS.CONSTRUCTION_GREETING) {\n        fetch('pages/under_construction.html')\n            .then(response => response.text())\n            .then(html => {\n                document.body.insertAdjacentHTML('beforeend', html);\n                const modal = document.getElementById('construction-modal');\n                const acknowledgeBtn = document.getElementById('acknowledge-btn');\n                // Show the modal\n                modal.style.display = 'block';\n                // Handle the acknowledge button click\n                acknowledgeBtn.addEventListener('click', () => {\n                    modal.style.display = 'none';\n                    construction_acknowledged = true;\n                });\n            });\n        }\n    // ----- Setup\n    scene = new THREE.Scene();\n    scene.background = TEXTURE_LOADER.load(BACKGROUND_IMAGE);\n    window.addEventListener('resize', handle_resize);\n    window.addEventListener('mousemove', handle_mouse_move);\n    window.addEventListener('mousedown', handle_mouse_down);\n    window.addEventListener('mouseup', handle_mouse_up);\n    window.addEventListener('contextmenu', handle_context_menu);\n    window.addEventListener('wheel', handle_wheel);\n    // Physics\n    gravity = new RAPIER.Vector3(0.0, -9.81, 0.0);\n    world = new RAPIER.World(gravity);\n    clock = new THREE.Clock();\n    // UI creation\n    viewable_container = new ViewableContainer(scene, world);\n    // Renderer\n    app_renderer = new AppRenderer(scene, viewable_container.get_camera());\n    // Background creation\n    new BackgroundLighting(scene);\n    background_container = new BackgroundContainer(scene, viewable_container.get_camera(), world);\n    new BackgroundFloor(world, scene, viewable_container.get_camera());\n    // Start animation loop after everything is initialized\n    app_renderer.set_animation_loop(animate);\n    app_renderer.add_event_listener('mouseout', () => {\n        if(viewable_container.is_column_left_side()) {\n            viewable_container.reset_hover();\n        }\n    });\n}\n\n/** Primary animation function run every frame by renderer */\nfunction animate() {\n    const delta = clock.getDelta();\n    // Handle the overlay\n    updateTween();\n    if(resize_move) {\n        if(!zoom_event) {\n            viewable_container.resize_reposition();\n        } else {\n            zoom_event = false;\n        }\n        resize_move = false;\n    }\n    // Handle the physics objects\n    if(viewable_container.get_overlay().is_intersected() != null) {\n        asset_manager.activate_object(viewable_container.get_intersected_name());\n    } else if(grabbed_object) {\n        translate_object(grabbed_object, viewable_container.get_camera());\n    } else if(hovered_cube_name != \"\") {\n        asset_manager.activate_object(hovered_cube_name);\n    } else if(viewable_container.is_text_active()) {\n        asset_manager.activate_object(viewable_container.get_active_name());\n    } else {\n        asset_manager.deactivate_all_objects();\n    }\n    world.timestep = Math.min(delta, 0.1);\n    world.step();\n    // Background object updates\n    background_container.update(grabbed_object, viewable_container);\n    asset_manager.update();\n    // Update confetti particles\n    viewable_container.get_overlay().update_confetti();\n    // Scene reload\n    app_renderer.render();\n}\n\n// ----- Handlers\n\n/** Handles resize events */\nfunction handle_resize() {\n    // Clear any existing timeout\n    if (resizeTimeout) {\n        clearTimeout(resizeTimeout);\n    }\n    // Set variables\n    resize_move = true;\n    // Determine if it was a zoom event\n    const current_pixel_ratio = window.devicePixelRatio;\n    if (last_pixel_ratio != current_pixel_ratio) {\n        last_pixel_ratio = current_pixel_ratio;\n        zoom_event = true;\n    }\n    // Immediate camera update\n    viewable_container.reset_camera();\n    app_renderer.resize();\n}\n\nfunction handle_mouse_move(e) {\n    update_mouse_position(e);\n    if(viewable_container.detect_rotation) {\n        const sensitivity = 0.02;  // Reduced sensitivity since we're not dividing by 1000 anymore\n        viewable_container.get_camera_manager().rotate(\n            e.movementX * sensitivity,\n            e.movementY * sensitivity\n        );\n    }\n    if(construction_acknowledged) {\n        // Handle intersections\n        const found_intersections = get_intersect_list(e, viewable_container.get_camera(), scene);\n        if(found_intersections.length > 0 && ! viewable_container.get_overlay().is_swapping_sides()) {\n            const intersected_object = found_intersections[0].object;\n            const object_name = intersected_object.name;\n            const name_type = object_name.split(\"_\")[0] + \"_\";\n            // Handle label hover\n            switch(name_type) {\n                case TYPES.LABEL:\n                    viewable_container.get_overlay().handle_hover(intersected_object);\n                    break;\n                case TYPES.FLOOR:\n                    viewable_container.get_overlay().reset_hover();\n                    break;\n                case TYPES.INTERACTABLE:\n                    if(viewable_container.is_overlay_hidden()) {\n                        hovered_cube_name = object_name;\n                    } else {\n                        hovered_cube_name = \"\";\n                    }\n                default:\n                    break;\n            }\n        } else {\n            viewable_container.get_overlay().reset_hover();\n            hovered_cube_name = \"\";\n        }\n    }\n}\n\nfunction handle_mouse_up(e) {\n    if(construction_acknowledged) {\n        if(grabbed_object) {\n            release_object(grabbed_object, background_container);\n            grabbed_object = null;\n        }\n        viewable_container.handle_mouse_up(get_intersect_list(e, viewable_container.get_camera(), scene));\n        if (e.button === 0) {\n            viewable_container.detect_rotation = false;\n            left_mouse_down = false;\n        }\n        if (e.button === 2) {\n            viewable_container.detect_rotation = false;\n            right_mouse_down = false;\n        }\n    }\n}\n\nfunction handle_mouse_down(e) {\n    if(construction_acknowledged) {\n        if(e.button === 0) {\n            left_mouse_down = true;\n        }\n        if(e.button === 2) {\n            right_mouse_down = true;\n            // If we're holding an object and right click is pressed, release it\n            if(grabbed_object) {\n                release_object(grabbed_object);\n                grabbed_object = null;\n            }\n        }\n        if(left_mouse_down && right_mouse_down && viewable_container.is_overlay_hidden()) {\n            viewable_container.detect_rotation = true;\n        } else if(viewable_container.is_overlay_hidden()) {\n            const found_intersections = get_intersect_list(e, viewable_container.get_camera(), scene);\n            found_intersections.forEach(i => {\n                switch(extract_type(i.object)) {\n                    case TYPES.INTERACTABLE:\n                        if(left_mouse_down) {\n                            grabbed_object = i.object;\n                            grab_object(grabbed_object, viewable_container.get_camera());\n                        } else {\n                            shove_object(i.object, viewable_container.get_camera());\n                        }\n                        break;\n                    default:\n                        break;\n                }\n            });\n        }\n    }\n}\n\nfunction handle_context_menu(e) {\n    e.preventDefault();\n}\n\nfunction handle_wheel(e) {\n    if(construction_acknowledged) {\n        if(grabbed_object) {\n            if(e.deltaY < 0) {\n                background_container.break_secondary_chains();\n                zoom_object_in(grabbed_object);\n            } else {\n                background_container.break_secondary_chains();\n                zoom_object_out(grabbed_object);\n            }\n            zoom_event = true;\n            resize_move = true;\n        }\n    }\n}\n\n// Change the init call to handle the promise\ninit().catch(console.error);"],"names":["Easing","amount","s","power","now","Group","_this","tweenId","tween","time","preserve","tweenIds","i","autoStart","Interpolation","v","k","m","f","fn","b","n","pw","bn","p0","p1","fc","a","p2","p3","t","v0","v1","t2","t3","Sequence","mainGroup","Tween","_object","_group","target","duration","dynamic","overrideStartingValues","property","tmp","prop","_valuesStart","_valuesEnd","_valuesStartRepeat","startValue","startValueIsArray","propType","isInterpolationList","endValues","temp","l","value","nestedObject","numChainedTweens","group","times","yoyo","easingFunction","interpolationFunction","tweens","_i","callback","_a","endTime","elapsedTime","durationAndDelay","totalTime","calculateElapsedPortion","timesRepeated","timeIntoCurrentRepeat","portion","elapsed","completeCount","start","end","startIsArray","endIsArray","endValue","TWEEN","update","FLAGS","Pass","_camera","OrthographicCamera","FullscreenTriangleGeometry","BufferGeometry","Float32BufferAttribute","_geometry","FullScreenQuad","material","Mesh","renderer","toTrianglesDrawMode","geometry","drawMode","TrianglesDrawMode","TriangleFanDrawMode","TriangleStripDrawMode","index","indices","position","numberOfTriangles","newIndices","newGeometry","GLTFLoader","Loader","manager","parser","GLTFMaterialsClearcoatExtension","GLTFMaterialsDispersionExtension","GLTFTextureBasisUExtension","GLTFTextureWebPExtension","GLTFTextureAVIFExtension","GLTFMaterialsSheenExtension","GLTFMaterialsTransmissionExtension","GLTFMaterialsVolumeExtension","GLTFMaterialsIorExtension","GLTFMaterialsEmissiveStrengthExtension","GLTFMaterialsSpecularExtension","GLTFMaterialsIridescenceExtension","GLTFMaterialsAnisotropyExtension","GLTFMaterialsBumpExtension","GLTFLightsExtension","GLTFMeshoptCompression","GLTFMeshGpuInstancing","url","onLoad","onProgress","onError","scope","resourcePath","relativeUrl","LoaderUtils","_onError","e","loader","FileLoader","data","gltf","dracoLoader","ktx2Loader","meshoptDecoder","path","json","extensions","plugins","textDecoder","BINARY_EXTENSION_HEADER_MAGIC","EXTENSIONS","GLTFBinaryExtension","error","GLTFParser","plugin","extensionName","extensionsRequired","GLTFMaterialsUnlitExtension","GLTFDracoMeshCompressionExtension","GLTFTextureTransformExtension","GLTFMeshQuantizationExtension","resolve","reject","GLTFRegistry","objects","key","object","nodeDefs","nodeIndex","nodeLength","nodeDef","lightIndex","cacheKey","dependency","lightDef","lightNode","color","Color","LinearSRGBColorSpace","range","DirectionalLight","PointLight","SpotLight","assignExtrasToUserData","type","self","light","MeshBasicMaterial","materialParams","materialDef","pending","metallicRoughness","array","SRGBColorSpace","materialIndex","emissiveStrength","MeshPhysicalMaterial","extension","scale","Vector2","colorFactor","colorArray","textureIndex","textureDef","name","source","handler","isSupported","image","bufferView","extensionDef","buffer","decoder","res","byteOffset","byteLength","count","stride","result","meshDef","primitive","WEBGL_CONSTANTS","attributesDef","attributes","accessor","results","nodeObject","meshes","instancedMeshes","mesh","Matrix4","p","Vector3","q","Quaternion","instancedMesh","InstancedMesh","attributeName","attr","InstancedBufferAttribute","Object3D","BINARY_EXTENSION_HEADER_LENGTH","BINARY_EXTENSION_CHUNK_TYPES","headerView","chunkContentsLength","chunkView","chunkIndex","chunkLength","chunkType","contentArray","bufferViewIndex","gltfAttributeMap","threeAttributeMap","attributeNormalizedMap","attributeTypeMap","threeAttributeName","ATTRIBUTES","accessorDef","componentType","WEBGL_COMPONENT_TYPES","attribute","normalized","texture","transform","GLTFCubicSplineInterpolant","Interpolant","parameterPositions","sampleValues","sampleSize","resultBuffer","values","valueSize","offset","i1","t0","t1","stride2","stride3","td","pp","ppp","offset1","offset0","s2","s3","s0","s1","m0","m1","_q","GLTFCubicSplineQuaternionInterpolant","WEBGL_FILTERS","NearestFilter","LinearFilter","NearestMipmapNearestFilter","LinearMipmapNearestFilter","NearestMipmapLinearFilter","LinearMipmapLinearFilter","WEBGL_WRAPPINGS","ClampToEdgeWrapping","MirroredRepeatWrapping","RepeatWrapping","WEBGL_TYPE_SIZES","PATH_PROPERTIES","INTERPOLATION","InterpolateLinear","InterpolateDiscrete","ALPHA_MODES","createDefaultMaterial","cache","MeshStandardMaterial","FrontSide","addUnknownExtensionsToUserData","knownExtensions","objectDef","gltfDef","addMorphTargets","targets","hasMorphPosition","hasMorphNormal","hasMorphColor","il","pendingPositionAccessors","pendingNormalAccessors","pendingColorAccessors","pendingAccessor","accessors","morphPositions","morphNormals","morphColors","updateMorphTargets","targetNames","createPrimitiveKey","primitiveDef","geometryKey","dracoExtension","createAttributesKey","attributesKey","keys","getNormalizedComponentScale","constructor","getImageURIMimeType","uri","_identityMatrix","options","isSafari","safariVersion","isFirefox","firefoxVersion","userAgent","safariMatch","TextureLoader","ImageBitmapLoader","ext","dependencies","scene","skinDefs","meshDefs","skinIndex","skinLength","joints","ref","updateMappings","original","clone","mappings","child","func","defs","def","bufferIndex","bufferDef","bufferViewDef","accessorIndex","itemSize","TypedArray","BufferAttribute","pendingBufferViews","bufferViews","elementBytes","itemBytes","byteStride","bufferAttribute","ibSlice","ibCacheKey","ib","InterleavedBuffer","InterleavedBufferAttribute","itemSizeIndices","TypedArrayIndices","byteOffsetIndices","byteOffsetValues","sparseIndices","sparseValues","sourceIndex","sourceDef","promise","sampler","URL","sourceURI","isObjectURL","blob","imageBitmap","Texture","mapName","mapDef","colorSpace","gltfReference","useDerivativeTangents","useVertexColors","useFlatShading","pointsMaterial","PointsMaterial","Material","lineMaterial","LineBasicMaterial","cachedMaterial","materialType","materialExtensions","kmuExtension","DoubleSide","alphaMode","emissiveFactor","originalName","sanitizedName","PropertyBinding","primitives","createDracoPrimitive","addPrimitiveAttributes","cached","geometryPromise","meshIndex","materials","geometries","SkinnedMesh","LineSegments","Line","LineLoop","Points","cameraIndex","camera","cameraDef","params","PerspectiveCamera","MathUtils","skinDef","inverseBindMatrices","jointNodes","bones","boneInverses","jointNode","mat","Skeleton","animationIndex","animationDef","animationName","pendingNodes","pendingInputAccessors","pendingOutputAccessors","pendingSamplers","pendingTargets","channel","input","output","nodes","inputAccessors","outputAccessors","samplers","tracks","node","inputAccessor","outputAccessor","createdTracks","AnimationClip","o","nodePending","childPending","childrenDef","skeletonPending","children","skeleton","nodeName","meshPromise","Bone","matrix","sceneIndex","sceneDef","nodeIds","reduceAssociations","reducedAssociations","targetName","TypedKeyframeTrack","NumberKeyframeTrack","QuaternionKeyframeTrack","VectorKeyframeTrack","interpolation","outputArray","j","jl","track","scaled","interpolantType","computeBounds","box","Box3","min","max","boxScale","maxDisplacement","vector","sphere","Sphere","assignAttributeAccessor","gltfAttributeName","ColorManagement","CopyShader","ShaderPass","shader","textureID","ShaderMaterial","UniformsUtils","writeBuffer","readBuffer","MaskPass","context","state","writeValue","clearValue","ClearMaskPass","EffectComposer","renderTarget","size","WebGLRenderTarget","HalfFloatType","NoBlending","Clock","pass","passIndex","deltaTime","currentRenderTarget","maskActive","stencil","width","height","effectiveWidth","effectiveHeight","pixelRatio","OutputShader","OutputPass","RawShaderMaterial","SRGBTransfer","LinearToneMapping","ReinhardToneMapping","CineonToneMapping","ACESFilmicToneMapping","AgXToneMapping","NeutralToneMapping","RenderPass","overrideMaterial","clearColor","clearAlpha","oldAutoClear","oldClearAlpha","oldOverrideMaterial","LuminosityHighPassShader","UnrealBloomPass","resolution","strength","radius","threshold","resx","resy","renderTargetHorizontal","renderTargetVertical","highPassShader","kernelSizeArray","bloomFactors","copyShader","AdditiveBlending","inputRenderTarget","kernelRadius","coefficients","nMips","CSS2DObject","element","recursive","_vector","_viewMatrix","_viewProjectionMatrix","_b","CSS2DRenderer","parameters","_width","_height","_widthHalf","_heightHalf","domElement","renderObject","zOrder","hideObject","visible","objectData","getDistanceToSquared","object1","object2","filterAndFlatten","sorted","distanceA","distanceB","zMax","AppRenderer","incoming_parent","incoming_camera","__publicField","THREE.WebGLRenderer","THREE.VSMShadowMap","output_pass","render_scene","bloom_pass","THREE.Vector2","incoming_event_name","handler_method","bloomPass","incoming_function","TYPES","NAMES","ASSET_TYPE","ASSET_CONFIGS","THREE.BoxGeometry","THREE.MeshStandardMaterial","_AssetManager","asset_type","asset_config","loading_promise","parent","world","position_offset","THREE.Vector3","body","RAPIER.RigidBodyDesc","THREE.Mesh","collider","RAPIER.ColliderDesc","created_collider","collision_meshes","collision_mesh","originalVertices","scaledVertices","meshPosition","relativePosition","bounding_box","dimensions","half_width","half_height","half_depth","instance_id","body_pair","incoming_mesh","incoming_body","incoming_pair","rotation","_c","THREE.MeshBasicMaterial","THREE.DoubleSide","current","has_emissive","check_material","object_name","found_and_verified","_body","requested_category","found","mesh_category","category","CATEGORIES","cat","createEmissionMaterial","originalMaterial","meshesProcessed","totalMeshes","deactivateMesh","targetMesh","tweenMaterial","restoredMaterial","type_prefix","deactivation_count","_","AssetManager","TEXTURE_LOADER","THREE.TextureLoader","PAN_SPEED","ROTATE_SPEED","FOCUS_ROTATION","HIDE_WIDTH","HIDE_HEIGHT","extract_type","incoming_object","raycaster","THREE.Raycaster","mouse_location","get_ndc_from_event","get_intersect_list","incoming_scene","ndc","NORTH","SOUTH","EAST","WEST","VALID_DIRECTIONS","get_screen_size","screen_size","get_associated_position","incoming_direction","LINKS","incoming_string","BackgroundFloor","incoming_world","floor_geometry","floor_material","floor_body","floor_shape","clamp","TITLE","TITLE_HEIGHT","TITLE_Y","TITLE_X","TITLE_THICKNESS","TitleBlock","title_geometry","title_material","is_overlay_hidden","tween_map","current_pos","title_y","new_tween","final_pos","WIDTH_OFFSET","HEIGHT_OFFSET","PLACEHOLDER_PATH","IFRAME","DIV","TextFrame","incoming_width","incoming_height","fov","height_at_distance","pixels_per_unit","TextContainer","THREE.Object3D","create_background","incoming_category","incoming_box","box_geometry","box_material","text_box_background","create_text_frame","new_frame","text_box","THREE.Euler","position_one_offset","position_two_offset","diploma","_d","incoming_name","is_column_left","found_index","new_name","currentCategory","currentFrame","visibilityEvent","frame","selected_text_box","move_direction","existing_focus_box","move_position","determined_speed","new_text_geometry","c","inner_c","incoming_simple_name","matched_frame","incoming_object_name","incoming_layer","target_y","LabelContainer","button_container","button_texture","THREE.SRGBColorSpace","button_option","container_column_x","x_position","y_position","y_rotation","intersected_object","in_tween","final_rotation","object_to_reset","existing_tween","label_name","button_name","LINK_CONTAINER","LinkContainer","link","circle_geometry","THREE.CircleGeometry","circle_texture","link_button","new_link","found_url","link_name","HideButton","hide_button_width","hide_button_height","hide_button_geometry","hide_button_material","hide_x","ARTIST_BLOCK","ArtistBlock","artist_geometry","artist_material","initial_width","current_width","max_x","desired_x","PARTICLE_COUNT","COLORS","PARTICLE_SIZE","GRAVITY","DRAG","LEFT_BURST_ANGLE","RIGHT_BURST_ANGLE","SPREAD_ANGLE","OverlayContainer","cam_pos","overlay_pos","forward","burst_position","base_angle","xOffset","THREE.PlaneGeometry","particle","offset_position","spread","angle","direction","camera_right","camera_up","speed","upward_force","local_velocity","simple_name","dummy","CameraManager","distance","delta_x","delta_y","delta","container","phi_rad","THREE.MathUtils","theta_rad","UI_Z_DIST","ViewableContainer","THREE.PerspectiveCamera","incoming_url","found_intersections","SPOTLIGHT_HEIGHT","SPOTLIGHT_COLOR","HEMISPHERE_SKY_COLOR","HEMISPHERE_GROUND_COLOR","BackgroundLighting","spotlight_one","THREE.SpotLight","spotlight_two","hemisphere_light","THREE.HemisphereLight","THROW_MULTIPLIER","SHOVE_FORCE","ZOOM_AMOUNT","current_mouse_pos","initial_grab_distance","last_position","current_velocity","last_time","shove_object","incoming_source","camera_position","cube_position","update_mouse_position","translate_object","ray_start","ray_end","ray_dir","new_position","current_time","delta_time","current_rot","zoom_object_in","zoom_object_out","grab_object","asset_manager","camera_pos","object_pos","RAPIER.RigidBodyType","release_object","IMAGE_PATH","MENU_CONFIG","JOINT_ANCHORS","DEFAULT_SPEED","ControlMenu","primary_container","incoming_speed","THREE.CanvasTexture","initialRotation","THREE.Quaternion","sign_joint","RAPIER.JointData","currentTime","beamPos","beamVel","signPos","signVel","euler","currentPos","ScrollMenu","incoming_container","spawn_position","halfAngle","anchor_body","previous_body","chain_body","created_joint","joint_desc","sign_image","sign_canvas","sign_texture","sign_material","sign_geometry","sign_mesh","sign_spawn_y","sign_body","sign_collider","finalJointDesc","joint","THREE.CylinderGeometry","bodyPair","sign","signBodyPair","rotationMatrix","THREE.Matrix4","linkPos","BackgroundContainer","asset_loader","cube_promises","grabbed_object","viewable_container","trigger_secondary","err","checkSignReady","BACKGROUND_IMAGE","resize_move","zoom_event","last_pixel_ratio","gravity","clock","app_renderer","background_container","hovered_cube_name","left_mouse_down","right_mouse_down","construction_acknowledged","init","RAPIER.init","response","html","modal","acknowledgeBtn","THREE.Scene","handle_resize","handle_mouse_move","handle_mouse_down","handle_mouse_up","handle_context_menu","handle_wheel","RAPIER.Vector3","RAPIER.World","THREE.Clock","animate","updateTween","current_pixel_ratio"],"mappings":"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","x_google_ignoreList":[0,2,3,4,5,6,7,8,9,10,11,12,13,14,24]}